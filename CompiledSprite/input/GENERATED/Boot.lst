/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : .\input\GENERATED\Boot.ASM
 * Fichier destination : .\input\GENERATED\TMP.BIN
 * Contenu :
 *     Main     0:BOOT.ASM     3436
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
     14
     15                  A000     boot_dernier_bloc equ $A000
     16
     17        6200                       org   $6200
     18
     19                           *****************************************>>
     20                           * Animation de la palette: fondu vers une>>
     21                           *****************************************>>
     22                           * Ecriture en $E7DB de l'adresse ou sera >>
     23                           *
     24                           * les adresses vont de deux en deux car i>>
     25                           * couleur: 0, adresse: 00
     26                           * couleur: 1, adresse: 02
     27                           * couleur: 2, adresse: 04
     28                           * ...
     29                           *
     30                           * Deux ecritures en $E7DA (auto-increment>>
     31                           *                          positionnee en>>
     32                           *
     33                           *                             V V V V    >>
     34                           * Premiere adresse        fondamentale V >>
     35                           *
     36                           * Deuxieme adresse            X X X M    >>
     37                           * auto-incrementee        bit de marquage>>
     38                           *                       (incrustation vid>>
     39                           *
     40                           * Attention: les instructions suivantes e>>
     41                           * ASL, ASR, CLR, COM, DEL, INC, LSL, LSR,>>
     42                           * un seul appel sur $E7DA va lire $E7DA p>>
     43                           * Sur $E7DA il faut donc utiliser l'instr>>
     44                           *****************************************>>
     45
     46        6200               PalInit
     47  3     6200 8E   62DB             ldx   #pal_len                 * >>
     48  4     6203 108E 62CF             ldy   #pal_from                * >>
     49        6207               PalRun
     50  4+0   6207 A6   A4               lda   ,y                         >>
     51  5     6209 B4   62E2             anda  pal_mask                 * >>
     52  2     620C C6   FF               ldb   #$FF                     * >>
     53  5     620E F4   62E2             andb  pal_mask                 * >>
     54  5     6211 F7   6279             stb   pal_buffer               * >>
     55  2     6214 C6   11               ldb   #$11                     * >>
     56  5     6216 F4   62E2             andb  pal_mask                 * >>
     57  4+5   6219 E7   8D 005D          stb   pal_buffer+1,pcr         * >>
     58  5     621D B1   6279             cmpa  pal_buffer               * >>
     59  3     6220 27   10               beq   PalVRSuivante            * >>
     60  3     6222 22   07               bhi   PalVRDec                 * >>
     61  4+0   6224 A6   A4               lda   ,y                       * >>
     62  5     6226 BB   627A             adda  pal_buffer+1             * >>
     63  3     6229 20   05               bra   PalVRSave                * >>
     64        622B               PalVRDec
     65  4+0   622B A6   A4               lda   ,y                       * >>
     66  5     622D B0   627A             suba  pal_buffer+1             * >>
     67        6230               PalVRSave
     68  4+0   6230 A7   A4               sta   ,y                       * >>
     69        6232               PalVRSuivante
     70  7     6232 73   62E2             com   pal_mask                 * >>
     71  3     6235 2B   D0               bmi   PalRun                   * >>
     72                            
     73        6237               SetPalBleu
     74  4+1   6237 E6   21               ldb   1,y                        >>
     75  2     6239 C1   0F               cmpb  #$0F                     * >>
     76  3     623B 27   08               beq   SetPalNext               * >>
     77  3     623D 22   03               bhi   SetPalBleudec            * >>
     78  2     623F 5C                    incb                           * >>
     79  3     6240 20   01               bra   SetPalSaveBleu           * >>
     80        6242               SetPalBleudec
     81  2     6242 5A                    decb                           * >>
     82        6243               SetPalSaveBleu
     83  4+1   6243 E7   21               stb   1,y                      * >>
     84                            
     85        6245               SetPalNext
     86  5     6245 B6   627F             lda   pal_idx                  * >>
     87  5     6248 B7   E7DB             sta   $E7DB                    * >>
     88  2     624B 8B   02               adda  #$02                     * >>
     89  5     624D B7   627F             sta   pal_idx                  * >>
     90  4+0   6250 A6   A4               lda   ,y                       * >>
     91  5     6252 B7   E7DA             sta   $E7DA                    * >>
     92  5     6255 F7   E7DA             stb   $E7DA                    * >>
     93  5     6258 B6   627F             lda   pal_idx                  * >>
     94  4+0   625B A1   84               cmpa  ,x                       * >>
     95  3     625D 26   E6               bne   SetPalNext               * >>
     96  4+1   625F 31   22               leay  2,y                      * >>
     97  4+1   6261 30   01               leax  1,x                      * >>
     98  4     6263 8C   62E1             cmpx  #end_pal_len             * >>
     99  3     6266 26   9F               bne   PalRun                   * >>
    100                            
    101        6268               Vsync_1
    102  7     6268 7D   E7E7             tst   $E7E7                    * >>
    103  3     626B 2A   FB               bpl   Vsync_1                  * >>
    104        626D               Vsync_2
    105  7     626D 7D   E7E7             tst   $E7E7                    * >>
    106  3     6270 2B   FB               bmi   Vsync_2                  * >>
    107                            
    108  7     6272 7A   62E1             dec   pal_cycles               * >>
    109  3     6275 26   89               bne   PalInit                  * >>
    110  3     6277 20   08               bra   InitVideo                * >>
    111                            
    112        6279               pal_buffer
    113        6279 42                    fcb   $42                      * >>
    114        627A 41                    fcb   $41                      * >>
    115        627B 53                    fcb   $53                      * >>
    116        627C 49                    fcb   $49                      * >>
    117        627D 43                    fcb   $43                      * >>
    118        627E 32                    fcb   $32                      * >>
    119                            
    120        627F               pal_idx
    121        627F 00                    fcb   $00                      * >>
    122        6280 00                    fcb   $00                      * >>
    123                            
    124                           *---------------------------------------->>
    125                           * A partir de ce point le code doit comme>>
    126                           *---------------------------------------->>
    127
    128                           *****************************************>>
    129                           * Initialisation du mode video
    130                           *****************************************>>
    131        6281               InitVideo
    132  2     6281 1A   50               orcc  #$50                     * >>
    133  4     6283 10CE 9FFF             lds   #$9FFF                   * >>
    134  2     6287 86   7B               lda   #$7B                     * >>
    135  5     6289 B7   E7DC             sta   $E7DC
----------------
221 cycle(s)
140 byte(s)
----------------
    137                           *****************************************>>
    138                           * Initialisation de la commutation de pag>>
    139                           *****************************************>>
    140  5     628C F6   6081             ldb   $6081                    * >>
    141  2     628F CA   10               orb   #$10                     * >>
    142  5     6291 F7   6081             stb   $6081                    * >>
    143  5     6294 F7   E7E7             stb   $E7E7                    * >>
    144  2     6297 86   04               lda   #$04
    145  5     6299 B7   E7E5             sta   $E7E5                    * >>
----------------
24 cycle(s)
16 byte(s)
----------------
    147                           *****************************************>>
    148                           * Lecture des donnees depuis la disquette>>
    149                           *****************************************>>
    150        629C               DKLecture
    151                  60               setdp $60
    152  2     629C 86   60               lda   #$60
    153  6     629E 1F   8B               tfr   a,dp                     * >>
    154                            
    155  3     62A0 CC   0000             ldd   #$0000
    156  4     62A3 97   49               sta   <$6049                   * >>
    157  5     62A5 DD   4A               std   <$604A                   * >>
    158  2     62A7 86   02               lda   #$02
    159  4     62A9 97   4C               sta   <$604C                   * >>
    160  4     62AB 97   48               sta   <$6048                   * >>
    161  2     62AD 86   A0               lda   #$A0                     * >>
    162  5     62AF DD   4F               std   <$604F
    163        62B1               DKCO
    164  8     62B1 BD   E82A             jsr   $E82A                    * >>
    165  6     62B4 0C   4C               inc   <$604C                   * >>
    166  4     62B6 96   4C               lda   <$604C                   * >>
    167  2     62B8 81   10               cmpa  #$10                     * >>
    168  3     62BA 23   06               bls   DKContinue               * >>
    169  2     62BC 86   01               lda   #$01                     * >>
    170  4     62BE 97   4C               sta   <$604C                   * >>
    171  6     62C0 0C   4B               inc   <$604B                   * >>
    172        62C2               DKContinue
    173  6     62C2 0C   4F               inc   <$604F                   * >>
    174  5     62C4 DC   4F               ldd   <$604F                   * >>
    175        62C6               dk_dernier_bloc
    176  5     62C6 1083 A000             cmpd  #boot_dernier_bloc       * >>
    177  3     62CA 23   E5               bls   DKCO                     * >>
    178  4     62CC 7E   A000             jmp   $A000
----------------
95 cycle(s)
51 byte(s)
----------------
    180                           * donnees pour le fondu de palette
    181                           *****************************************>>
    182
    183        62CF               pal_from
    184        62CF 0000                  fdb   $0000                    * >>
    185        62D1 F00F                  fdb   $F00F                    * >>
    186        62D3 FF0F                  fdb   $FF0F                    * >>
    187        62D5 7707                  fdb   $7707                    * >>
    188        62D7 AA03                  fdb   $AA03                    * >>
    189        62D9 330A                  fdb   $330A                    * >>
    190                            
    191        62DB               pal_len
    192        62DB 0C                    fcb   $0C                      * >>
    193        62DC 0E                    fcb   $0E                      * >>
    194        62DD 10                    fcb   $10                      * >>
    195        62DE 16                    fcb   $16                      * >>
    196        62DF 18                    fcb   $18                      * >>
    197        62E0 20                    fcb   $20                      * >>
    198        62E1               end_pal_len
    199                            
    200        62E1               pal_cycles
    201        62E1 0F                    fcb   $0F                      * >>
    202                            
    203        62E2               pal_mask
    204        62E2 0F                    fcb   $0F                      * >>

000000 Total Errors

000024 Total Symbols
     1x          Equ   A000 boot_dernier_bloc
     1x          Label 62B1 DKCO
     1x          Label 62C2 DKContinue
     0x          Label 629C DKLecture
     0x          Label 62C6 dk_dernier_bloc
     1x          Label 62E1 end_pal_len
     1x          Label 6281 InitVideo
     1x          Label 6200 PalInit
     2x          Label 6207 PalRun
     1x          Label 622B PalVRDec
     1x          Label 6230 PalVRSave
     1x          Label 6232 PalVRSuivante
     5x          Label 6279 pal_buffer
     1x          Label 62E1 pal_cycles
     1x          Label 62CF pal_from
     3x          Label 627F pal_idx
     1x          Label 62DB pal_len
     4x          Label 62E2 pal_mask
     0x          Label 6237 SetPalBleu
     1x          Label 6242 SetPalBleudec
     2x          Label 6245 SetPalNext
     1x          Label 6243 SetPalSaveBleu
     1x          Label 6268 Vsync_1
     1x          Label 626D Vsync_2

