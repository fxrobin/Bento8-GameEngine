÷ORGñ$8000*****************************************ñConstantesñetñvariables****************************************DEBUTECRANAñEQUñ$0014÷*ñtestñpourFINECRANAóEQUñ$1F40÷*ñfinñdeñlaDEBUTECRANBñEQUñ$2014÷*ñtestñpourFINECRANBóEQUñ$3F40÷*ñfinñdeñlaJOY_BDñEQUñ$05÷*ñBasñDroiteJOY_HDñEQUñ$06÷*ñHautñDroiteJOY_DòEQUñ$07÷*ñDroiteJOY_BGñEQUñ$09÷*ñBasñGaucheJOY_HGñEQUñ$0A÷*ñHautñGaucheJOY_GòEQUñ$0B÷*ñGaucheJOY_BòEQUñ$0D÷*ñBasJOY_HòEQUñ$0E÷*ñHautJOY_CòEQUñ$0F÷*ñCentreSSAVEñFDBñ$0000HERO_IDLE-LFDBñ$A000HERO_IDLE-R1HERO_JOG-L10HERO_JOG-R10HERO_WALK-L12HERO_WALK-R12HERO_SKID-L9HERO_SKID-R9HERO_SKIDTURN-L3HERO_SKIDTURN-R3*****************************************ñDebutñduñprogramme****************************************÷ORCCñ#$50õ*ñañdocumenterñ(int÷LDAñ#$7Bö*ñpassageñenñmodeñ1÷STAñ$E7DC*****************************************ñInitialisationñdeñlañpaletteñdeñcouleu****************************************÷LDYñ#TABPALETTE÷CLRASETPALETTE÷PSHSñA÷ASLA÷STAñ$E7DB÷LDDñ,Y++÷STBñ$E7DA÷STAñ$E7DA÷PULSñA÷INCA÷CMPYñ#FINTABPALETTE÷BNEôSETPALETTE*****************************************ñInitialisationñdeñlañroutineñdeñcommut****************************************÷LDBñ$6081ñ*ñAñdocumenter÷ORBñ#$10ò*ñmettreñleñbitñd4ñañ1÷STBñ$6081÷STBñ$E7E7÷JSRñSCRCñ*ñpageñ2ñenñRAMñCartouch*---------------------------------------*ñInitialisationñdesñdeuxñpagesñvideosña*---------------------------------------÷LDBñ#$03ò*ñOnñmonteñlañpageñ3÷STBñ$E7E5ñ*ñenñRAMñDonneesñ(A000-÷JSRñDRAW_RAM_DATA_TO_CART_160x200÷JSRñDRAW_TEST1X100000÷JSRñSCRC÷JSRñDRAW_RAM_DATA_TO_CART_160x200÷JSRñDRAW_TEST1X100000÷JSRñSCRC*---------------------------------------*ñBoucleñprincipale*---------------------------------------MAIN÷*ñEffacementñetñaffichageñdesñspr÷JSRñERASE_TEST1X100000ñ*ñTODOñbou÷JSRñDRAW_TEST1X100000ñ*ñTODOñboul÷*ñGestionñdesñdeplacements÷JSRñJOY_READ÷JSRñHero_Move÷JSRñCompute_Position÷JSRñSCRCø*ñchangementñdeñp÷BRAñMAIN*****************************************ñChangementñdeñpageñESPACEñECRANñ(affic*ö$E7DDñdetermineñlañpageñaffichee*öD7=0ñD6=0ñD5=0ñD4=0ñ(#$0_)ñ:ñpage*öD7=0ñD6=1ñD5=0ñD4=0ñ(#$4_)ñ:ñpage*öD7=1ñD6=0ñD5=0ñD4=0ñ(#$8_)ñ:ñpage*öD7=1ñD6=1ñD5=0ñD4=0ñ(#$C_)ñ:ñpage*óD3ñD2ñD1ñD0ò(#$_0ñañ#$_F)ñ:ñcouleur*óRemarqueñ:ñD5ñetñD4ñutilisableñuniqu**ñChangementñdeñpageñESPACEñCARTOUCHEñ(e*ö$E7E6ñdetermineñlañpageñaffichee*óD5ñ:ñ1ñ=ñespaceñcartoucheñrecouvert*óD4ñ:ñ0ñ=ñCAS1Nñvalideñ:ñbanquesñ0-15*öD5=1ñD4=0ñD3=0ñD2=0ñD1=0ñD0=0ñ(#$*ó...*öD5=1ñD4=0ñD3=1ñD2=1ñD1=1ñD0=1ñ(#$*öD5=1ñD4=1ñD3=0ñD2=0ñD1=0ñD0=0ñ(#$*ó...*öD5=1ñD4=1ñD3=1ñD2=1ñD1=1ñD0=1ñ(#$****************************************SCRC÷JSRñVSYNC÷CHANGEMENTñPAGE÷LDBñSCRC0+1ó*ñchargeñlañvaleur÷ANDBñ#$80õ*ñpermuteñ#$00ñouñ#÷ORBñ#$0Fö*ñrechargerñlañcoul÷STBñ$E7DDõ*ñchangementñpageñd÷COMñSCRC0+1ó*ñmodificationñduñcSCRC0÷LDBñ#$00÷ANDBñ#$02õ*ñpermuteñ#$60ñouñ#÷ORBñ#$60ö*ñespaceñcartouche÷STBñ$E7E6õ*ñchangementñpageñd÷RTSÿó*ñE7E6ñD5=1ÿý*ñCAS1Nñ:ñba*****************************************ñAttenteñVBL****************************************VSYNCVSYNC_1÷TSTô$E7E7÷BPLôVSYNC_1VSYNC_2÷TSTô$E7E7÷BMIôVSYNC_2÷RTS*---------------------------------------*ñGetñjoystickñparameters*---------------------------------------JOY_READ÷ldxô#$e7cf÷ldyô#$e7cd÷lddô#$400f÷andbó>$e7ccõ*ñReadñposition÷stbôJOY_DIR_STATUS÷andaó,yù*ñReadñbutton÷eoraó#$40÷staôJOY_BTN_STATUS÷RTSJOY_DIR_STATUS÷FCBñ$00ñ*ñPositionñPadJOY_BTN_STATUS÷FCBñ$00ñ*ñ40ñBoutonñAñenfonce*---------------------------------------*ñSubroutineñtoömakeñheroñwalk/run*---------------------------------------Hero_Move÷LDAñJOY_DIR_STATUS÷CMPAñ#JOY_G÷BNEñHero_NotLeft÷BRAñHero_MoveLeftHero_NotLeftÿô*ñXREF:ñH÷CMPAñ#JOY_D÷BNEñHero_NotLeftOrRight÷LBRAñHero_MoveRightHero_NotLeftOrRightü*ñXREF:ñH÷LDDñTEST1X10_G_SPEED÷CMPDñ#$0000÷BLTñHero_NotLeftOrRight_00ñ*ñseñd÷SUBDñTEST1X10_FRICTIONõ*ñseñd÷BCCñHero_NotLeftOrRight_01ñ*ñsiño÷LDDñ#$0000÷STDñTEST1X10_G_SPEED÷LDAñ#$01ÿó*ñCharg÷STAñTEST1X10_ANIMATION÷LBRAñHero_MoveUpdatePosHero_NotLeftOrRight_01÷CMPDñ#TEST1X10_JOG_SPD_LIMIT÷BGEñHero_NotLeftOrRight_02÷STDñTEST1X10_G_SPEED÷LDAñ#$03ÿó*ñCharg÷STAñTEST1X10_ANIMATION÷BRAñHero_NotLeftOrRight_03Hero_NotLeftOrRight_02÷STDñTEST1X10_G_SPEEDHero_NotLeftOrRight_03÷LBRAñHero_MoveUpdatePosHero_NotLeftOrRight_00÷ADDDñTEST1X10_FRICTIONõ*ñseñd÷BCCñHero_NotLeftOrRight_11ñ*ñsiño÷LDDñ#$0000÷STDñTEST1X10_G_SPEED÷LDAñ#$02ÿó*ñCharg÷STAñTEST1X10_ANIMATION÷LBRAñHero_MoveUpdatePosHero_NotLeftOrRight_11÷CMPDñ#TEST1X10_JOG_SPD_LIMIT÷BLEñHero_NotLeftOrRight_12÷STDñTEST1X10_G_SPEED÷LDAñ#$04ÿó*ñCharg÷STAñTEST1X10_ANIMATION÷BRAñHero_NotLeftOrRight_13Hero_NotLeftOrRight_12÷STDñTEST1X10_G_SPEEDHero_NotLeftOrRight_13÷LBRAñHero_MoveUpdatePosHero_MoveLeftÿ÷*ñXRE÷LDDñTEST1X10_G_SPEEDø*ñCha÷CMPDñ#$0000ÿò*ñTes÷BLEñHero_MoveLeft_00ø*ñBRA÷SUBDñTEST1X10_DECELERATIONò*ñori÷BCCñHero_MoveLeft_03ø*ñBRA÷LDDñ#$0000÷SUBDñTEST1X10_DECELERATIONò*ñsiHero_MoveLeft_03÷STDñTEST1X10_G_SPEEDø*ñOn÷LBRAñHero_MoveUpdatePosHero_MoveLeft_00*öCMPDñ#$0000*öBNEñHero_MoveLeft_02ø*ñBRA*öLDDñ#$FEFF*Hero_MoveLeft_02÷CMPDñTEST1X10_NEG_TOP_SPEEDñ*ñCom÷BEQñHero_MoveUpdatePosö*ñvit÷SUBDñTEST1X10_ACCELERATIONò*ñacc÷CMPDñTEST1X10_NEG_TOP_SPEEDñ*ñCom÷BGTñHero_MoveLeft_01ø*ñBRA÷LDAñ#$06ÿõ*ñCha÷STAñTEST1X10_ANIMATIONö*ñSau÷LDDñTEST1X10_NEG_TOP_SPEEDò*ñLim÷STDñTEST1X10_G_SPEEDø*ñEnr÷LBRAñHero_MoveUpdatePosõ*ñMisHero_MoveLeft_01÷STDñTEST1X10_G_SPEEDø*ñEnr÷LDAñ#$04ÿõ*ñCha÷STAñTEST1X10_ANIMATIONö*ñSau÷LBRAñHero_MoveUpdatePosHero_MoveRightÿó*ñXREF:÷LDDñTEST1X10_G_SPEEDø*ñCha÷CMPDñ#$0000ÿò*ñTes÷BGEñHero_MoveRight_00÷*ñBRA÷ADDDñTEST1X10_DECELERATIONò*ñori÷BCCñHero_MoveRight_03÷*ñBRA÷LDDñTEST1X10_DECELERATIONó*ñsiHero_MoveRight_03÷STDñTEST1X10_G_SPEEDø*ñOn÷LBRAñHero_MoveUpdatePosHero_MoveRight_00ÿó*ñOri*öCMPDñ#$0000*öBNEñHero_MoveRight_02÷*ñBRA*öLDDñ#$0100*Hero_MoveRight_02÷CMPDñTEST1X10_TOP_SPEED÷BEQñHero_MoveUpdatePosö*ñvit÷ADDDñTEST1X10_ACCELERATIONò*ñacc÷CMPDñTEST1X10_TOP_SPEED÷BLTñHero_MoveRight_01÷*ñBRA÷LDAñ#$05ÿõ*ñCha÷STAñTEST1X10_ANIMATION÷LDDñTEST1X10_TOP_SPEED÷STDñTEST1X10_G_SPEEDø*ñEnr÷LBRAñHero_MoveUpdatePosHero_MoveRight_01÷STDñTEST1X10_G_SPEEDø*ñEnr÷LDAñ#$03ÿõ*ñCha÷STAñTEST1X10_ANIMATIONHero_MoveUpdatePos÷LDDñTEST1X10_G_SPEEDø*ñCha÷STDñTEST1X10_X_SPEEDø*ñSto÷CMPDñ#$0000ÿò*ñTes÷BLTñHero_MoveUpdatePos_00ó*ñBRA÷TFRñA,Bÿö*ñDiv÷ADDBñTEST1X10_X_POS÷BRAñHero_MoveUpdatePos_01Hero_MoveUpdatePos_V00÷FCBñ$00Hero_MoveUpdatePos_00÷LDDñ#$0000÷SUBDñTEST1X10_X_SPEED÷TFRñA,Bÿö*ñDiv÷STBñHero_MoveUpdatePos_V00÷LDBñTEST1X10_X_POS÷SUBBñHero_MoveUpdatePos_V00ñ*ñAjoHero_MoveUpdatePos_01*öCMPBñ#$50*öBLEñHero_MoveUpdatePos_02ó*ñBut*öLDBñ#$50*Hero_MoveUpdatePos_02*ôCMPBñ#$0C*öBGEñHero_MoveUpdatePos_03ó*ñBut*öLDBñ#$0CHero_MoveUpdatePos_03÷STBñTEST1X10_X_POS÷LDDñ#$0000ÿó*ñTOD÷STDñTEST1X10_Y_SPEED÷TFRñA,Bÿö*ñdiv÷ADDBñTEST1X10_Y_POS÷STBñTEST1X10_Y_POS÷RTS*ñTODOñ:ñBrakingñAnimation*ñSonicñentersñhisñbrakingñanimationñwhe*ñInñSonicñ1ñandñSonicñCD,ñheñthenñstays*ñInñtheñotherñ3ñgames,ñSonicñreturnsñtoCompute_Position÷LDAñTEST1X10_X_POS÷LSRA÷BCSñCompute_Position_01÷STAñCompute_Position_02+1÷LDAñ#$28÷LDBñTEST1X10_Y_POS÷DECB÷MUL÷ADDDñCompute_Position_02÷STDñPOS_TEST1X100000÷ADDDñ#$2000÷STDñPOS_TEST1X100000+2÷RTSCompute_Position_01÷STAñCompute_Position_02+1÷LDAñ#$28÷LDBñTEST1X10_Y_POS÷DECB÷MUL÷ADDDñCompute_Position_02÷ADDDñ#$2000÷STDñPOS_TEST1X100000÷SUBDñ#$1FFF÷STDñPOS_TEST1X100000+2÷RTSCompute_Position_02÷FDBñ$0000*****************************************ñAffichageñdeñlñarriereñplanñxxxñcycles****************************************DRAW_RAM_DATA_TO_CART_160x200÷PSHSñU,DPü*ñsauvegarde÷STSñ>SSAVE÷LDSñ#FINECRANA÷*ñinitñpoint÷LDUñ#$A000DRAW_RAM_DATA_TO_CART_160x200A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷CMPSñ#DEBUTECRANA÷BNEñDRAW_RAM_DATA_TO_CART_160x200÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñB,DP,X,Y÷PSHSñY,X,DP,B÷LDSñ#FINECRANB÷*ñinitñpoint÷LDUñ#$C000DRAW_RAM_DATA_TO_CART_160x200B÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷CMPSñ#DEBUTECRANB÷BNEñDRAW_RAM_DATA_TO_CART_160x200÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñA,B,DP,X,Y÷PSHSñY,X,DP,B,A÷PULUñB,DP,X,Y÷PSHSñY,X,DP,B÷LDSò>SSAVEú*ñrechargeme÷PULSñU,DP÷RTSTABPALETTE÷FDBñ$0111õ*ñindex:0òR:51òV:÷FDBñ$0143õ*ñindex:1òR:108ñV:÷FDBñ$0113õ*ñindex:2òR:107ñV:÷FDBñ$0484õ*ñindex:3òR:132ñV:÷FDBñ$0112õ*ñindex:4òR:92òV:÷FDBñ$0247õ*ñindex:5òR:180ñV:÷FDBñ$0233õ*ñindex:6òR:116ñV:÷FDBñ$0177õ*ñindex:7òR:172ñV:÷FDBñ$0111õ*ñindex:8òR:60òV:÷FDBñ$0016õ*ñindex:9òR:164ñV:÷FDBñ$0698õ*ñindex:10ñR:187ñV:÷FDBñ$0344õ*ñindex:11ñR:132ñV:÷FDBñ$0221õ*ñindex:12ñR:68òV:÷FDBñ$0452õ*ñindex:13ñR:92òV:÷FDBñ$0356õ*ñindex:14ñR:164ñV:÷FDBñ$0125õ*ñindex:15ñR:140ñV:FINTABPALETTE*****************************************ñAfficheñunñcomputedñspriteñenñxxxñcycl****************************************TEST1X10_WALK_SPD_LIMITñEQUñ$0400TEST1X10_JOG_SPD_LIMITòEQUñ$0600TEST1X10_X_POS÷FCBñ$50ø*ñpositionñhorizonTEST1X10_Y_POS÷FCBñ$C8ø*ñpositionñverticaTEST1X10_G_SPEED÷FDBñ$0000ø*ñvitesseñauñsolTEST1X10_X_SPEED÷FDBñ$0000ø*ñvitesseñhorizoTEST1X10_Y_SPEED÷FDBñ$0000ø*ñvitesseñverticTEST1X10_TOP_SPEED÷FDBñ$0600ø*ñvitesseñmaximuTEST1X10_NEG_TOP_SPEED÷FDBñ$FA00ø*ñvitesseñmaximuTEST1X10_ACCELERATION÷FDBñ$000Cø*ñconstanteñacceTEST1X10_DECELERATION÷FDBñ$0080ø*ñconstanteñdeceTEST1X10_FRICTION÷FDBñ$000Cø*ñconstanteñdeñfTEST1X10_ANIMATION÷FCBñ$00ú*ñAnimationñcour÷INCLUDñANIM00