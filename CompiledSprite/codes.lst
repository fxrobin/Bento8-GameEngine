/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : ./input/CODE/MAIN.ASS
 * Fichier destination : TMP.BIN
 * Contenu :
 *     Main     0:MAIN.ASM     20317
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
     12        6300                      ORG $6300
     13
     14                           *****************************************>>
     15                           * Constantes et variables
     16                           *****************************************>>
     17
     18                  6205     DK_lecture               EQU $6205 * rout>>
     19                  620A     DK_piste                 EQU $620A * 2B n>>
     20                  620F     DK_secteur               EQU $620F * 1B n>>
     21                  6213     DK_destination           EQU $6213 * 2B d>>
     22                  622C     DK_dernier_bloc_a_ecrire EQU $622C * 2B f>>
     23
     24                  0014     DEBUTECRANA EQU $0014 * test pour fin sta>>
     25                  1F40     FINECRANA   EQU $1F40 * fin de la RAM A v>>
     26                  2014     DEBUTECRANB EQU $2014 * test pour fin sta>>
     27                  3F40     FINECRANB   EQU $3F40 * fin de la RAM B v>>
     28
     29                  0005     JOY_BD EQU $05 * Bas Droite
     30                  0006     JOY_HD EQU $06 * Haut Droite
     31                  0007     JOY_D  EQU $07 * Droite
     32                  0009     JOY_BG EQU $09 * Bas Gauche
     33                  000A     JOY_HG EQU $0A * Haut Gauche
     34                  000B     JOY_G  EQU $0B * Gauche
     35                  000D     JOY_B  EQU $0D * Bas
     36                  000E     JOY_H  EQU $0E * Haut
     37                  000F     JOY_C  EQU $0F * Centre
     38
     39                  9F00     HERO_POS EQU $9F00 * HERO Position
     40
     41                           *****************************************>>
     42                           * Debut du programme
     43                           *****************************************>>
     44        6300               BEGIN
     45  2     6300 1A   50              ORCC #$50     * a documenter (inte>>
     46
     47  3     6302 CC   1F40            LDD #FINECRANA
     48  6     6305 FD   9F00            STD HERO_POS
     49  3     6308 CC   3F40            LDD #FINECRANB
     50  6     630B FD   9F02            STD HERO_POS+2
     51
     52                           *****************************************>>
     53                           * Chargement des pages memoire
     54                           *****************************************>>
     55                                  * Chargement de la page 4 depuis l>>
     56                                  **********************************>>
     57  2     630E C6   04              LDB #$04                       * O>>
     58  5     6310 F7   E7E5            STB $E7E5                      * e>>
     59                            
     60  3     6313 CC   0004            LDD #$0004
     61  6     6316 FD   620A            STD DK_piste
     62  2     6319 86   01              LDA #$01
     63  5     631B B7   620F            STA DK_secteur
     64  3     631E CC   A000            LDD #$A000
     65  6     6321 FD   6213            STD DK_destination
     66  3     6324 CC   DF00            LDD #$DF00
     67  6     6327 FD   622C            STD DK_dernier_bloc_a_ecrire
     68  8     632A BD   6205            JSR DK_lecture
     69                            
     70                                  * Copie de la page 4 en page 5
     71                                  ******************************
     72  2     632D C6   65              LDB #$65                       * O>>
     73  5     632F F7   E7E6            STB $E7E6                      * e>>
     74
     75  3     6332 CE   A000         LDU #$A000                     * Sour>>
     76  4     6335 108E 4040         LDY #$4000+64                  * Dest>>
     77  7     6339 10BF 64E8            STY MEM_COPY_DATA_TO_CART_E+2
     78  4     633D 108E 2040         LDY #$2000+64                  * Dest>>
     79  8     6341 BD   6400         JSR MEM_COPY_DATA_TO_CART      * Copi>>
     80                            
     81  3     6344 CE   C000         LDU #$C000                     * Sour>>
     82  4     6347 108E 2040         LDY #$2000+64                  * Dest>>
     83  7     634B 10BF 64E8            STY MEM_COPY_DATA_TO_CART_E+2
     84  4     634F 108E 0040         LDY #$0000+64                  * Dest>>
     85  8     6353 BD   6400         JSR MEM_COPY_DATA_TO_CART      * Copi>>
     86                            
     87                           *****************************************>>
     88                           * Initialisation de la routine de commuta>>
     89                           *****************************************>>
     90        6356               INIT_VID
     91  5     6356 F6   6081            LDB $6081 * A documenter
     92  2     6359 CA   10              ORB #$10  * mettre le bit d4 a 1
     93  5     635B F7   6081            STB $6081
     94  5     635E F7   E7E7            STB $E7E7
     95  8     6361 BD   63D0            JSR SCRC     * page 2 en RAM Carto>>
     96  8     6364 BD   64F3            JSR CLR_CART * effacement page 2
     97  8     6367 BD   63D0            JSR SCRC     * page 0 en RAM Carto>>
     98  8     636A BD   64F3            JSR CLR_CART * effacement page 0
     99  8     636D BD   63D0            JSR SCRC     * page 2 en RAM Carto>>
    100
    101                           *****************************************>>
    102                           * Initialisation du mode video
    103                           *****************************************>>
    104  2     6370 86   7B              LDA #$7B      * passage en mode 16>>
    105  5     6372 B7   E7DC            STA $E7DC
    106
    107                           *****************************************>>
    108                           * Initialisation de la palette de couleur>>
    109                           *****************************************>>
    110  4     6375 108E 652F            LDY #TABPALETTE
    111  2     6379 4F                   CLRA
    112        637A               SETPALETTE
    113  5+1   637A 34   02              PSHS A
    114  2     637C 48                   ASLA
    115  5     637D B7   E7DB            STA $E7DB
    116  5+3   6380 EC   A1              LDD ,Y++
    117  5     6382 F7   E7DA            STB $E7DA
    118  5     6385 B7   E7DA            STA $E7DA
    119  5+1   6388 35   02              PULS A
    120  2     638A 4C                   INCA
    121  5     638B 108C 654F            CMPY #FINTABPALETTE
    122  3     638F 26   E9              BNE    SETPALETTE
    123
    124                           *****************************************>>
    125                           * Initialisation des sprites
    126                           *****************************************>>
    127  3     6391 8E   6744            LDX #HERO_IDLE_R
    128  8     6394 BD   66DE            JSR HERO_ANIMATION_LOAD
    129
    130                           *****************************************>>
    131                           * Boucle principale
    132                           *****************************************>>
    133                                  * Init routine effacement sprite
    134  5     6397 F6   6768            LDB HERO_ANIMATION_PAG            >>
    135  5     639A F7   E7E5            STB $E7E5                         >>
    136  7+3   639D AD   9F 676B         JSR [HERO_ANIMATION_DRW]          >>
    137  8     63A1 BD   63D0            JSR SCRC
    138  5     63A4 F6   6768            LDB HERO_ANIMATION_PAG            >>
    139  5     63A7 F7   E7E5            STB $E7E5                         >>
    140  7+3   63AA AD   9F 676B         JSR [HERO_ANIMATION_DRW]          >>
    141  8     63AE BD   63D0            JSR SCRC
    142                            
    143        63B1               MAIN
    144                                  * Effacement et affichage des spri>>
    145  5     63B1 F6   6768            LDB HERO_ANIMATION_PAG            >>
    146  5     63B4 F7   E7E5            STB $E7E5                         >>
    147  7+3   63B7 AD   9F 6769         JSR [HERO_ANIMATION_DEL]          >>
    148  7+3   63BB AD   9F 676B         JSR [HERO_ANIMATION_DRW]          >>
    149
    150                                  * Gestion des deplacements
    151  8     63BF BD   654F            JSR JOY_READ
    152  8     63C2 BD   6569            JSR Hero_Move
    153  8     63C5 BD   66A5            JSR Compute_Position
    154                            
    155  8     63C8 BD   6734            JSR HERO_ANIMATION_NEXT
    156
    157  8     63CB BD   63D0            JSR SCRC                          >>
    158  3     63CE 20   E1              BRA MAIN
    159
    160                           *****************************************>>
    161                           * Changement de page ESPACE ECRAN (affich>>
    162                           *      $E7DD determine la page affichee d>>
    163                           *      D7=0 D6=0 D5=0 D4=0 (#$0_) : page >>
    164                           *      D7=0 D6=1 D5=0 D4=0 (#$4_) : page >>
    165                           *      D7=1 D6=0 D5=0 D4=0 (#$8_) : page >>
    166                           *      D7=1 D6=1 D5=0 D4=0 (#$C_) : page >>
    167                           *   D3 D2 D1 D0  (#$_0 a #$_F) : couleur >>
    168                           *   Remarque : D5 et D4 utilisable unique>>
    169                           *
    170                           * Changement de page ESPACE CARTOUCHE (ec>>
    171                           *      $E7E6 determine la page affichee d>>
    172                           *   D5 : 1 = espace cartouche recouvert p>>
    173                           *   D4 : 0 = CAS1N valide : banques 0-15 >>
    174                           *      D5=1 D4=0 D3=0 D2=0 D1=0 D0=0 (#$6>>
    175                           *   ...
    176                           *      D5=1 D4=0 D3=1 D2=1 D1=1 D0=1 (#$6>>
    177                           *      D5=1 D4=1 D3=0 D2=0 D1=0 D0=0 (#$7>>
    178                           *   ...
    179                           *      D5=1 D4=1 D3=1 D2=1 D1=1 D0=1 (#$7>>
    180                           *****************************************>>
    181        63D0               SCRC
    182  8     63D0 BD   63F5            JSR VSYNC
    183
    184  5     63D3 F6   63EC            LDB SCRC0+1
    185  2     63D6 C4   01              ANDB #$01
    186  5     63D8 FB   6768            ADDB HERO_ANIMATION_PAG
    187  5     63DB F7   6768            STB HERO_ANIMATION_PAG
    188                            
    189  5     63DE F6   63EC            LDB SCRC0+1   * charge la valeur d>>
    190  2     63E1 C4   80              ANDB #$80     * permute #$00 ou #$>>
    191  2     63E3 CA   00              ORB #$00      * recharger la coule>>
    192  5     63E5 F7   E7DD            STB $E7DD     * changement page da>>
    193  7     63E8 73   63EC            COM SCRC0+1   * modification du co>>
    194        63EB               SCRC0
    195  2     63EB C6   00              LDB #$00
    196  2     63ED C4   02              ANDB #$02     * permute #$60 ou #$>>
    197  2     63EF CA   60              ORB #$60      * espace cartouche r>>
    198  5     63F1 F7   E7E6            STB $E7E6     * changement page da>>
    199  5     63F4 39                   RTS                  * E7E6 D5=1 p>>
    200                                                       * CAS1N : ban>>
    201
    202                           *****************************************>>
    203                           * Attente VBL
    204                           *****************************************>>
    205        63F5               VSYNC
    206        63F5               VSYNC_1
    207  7     63F5 7D   E7E7            TST    $E7E7
    208  3     63F8 2A   FB              BPL    VSYNC_1
    209        63FA               VSYNC_2
    210  7     63FA 7D   E7E7            TST    $E7E7
    211  3     63FD 2B   FB              BMI    VSYNC_2
    212  5     63FF 39                   RTS
    213
    214                           *****************************************>>
    215                           * Copie Memoire de la zone donnee vers ca>>
    216                           * Cycles en fonction de l'implementation
    217                           * 256 octets (-128 a 127) x 64  boucles (>>
    218                           * 128 octets (-64  a 63)  x 128 boucles (>>
    219                           * 32  octets (-16  a 15)  x 512 boucles (>>
    220                           *****************************************>>
    221                           *MEM_COPY_DATA_TO_CART
    222                           *   PULS X,U
    223                           *   STX       -128,Y
    224                           *   STU       -126,Y
    225                           *   PULS      D,X,U
    226                           *   STD       -124,Y
    227                           *   STX       -122,Y
    228                           *   STU       -120,Y
    229                           *   PULS      D,X,U
    230                           *   STD       -118,Y
    231                           *   STX       -116,Y
    232                           *   STU       -114,Y
    233                           *   PULS      D,X,U
    234                           *   STD       -112,Y
    235                           *   STX       -110,Y
    236                           *   STU       -108,Y
    237                           *   PULS      D,X,U
    238                           *   STD       -106,Y
    239                           *   STX       -104,Y
    240                           *   STU       -102,Y
    241                           *   PULS      D,X,U
    242                           *   STD       -100,Y
    243                           *   STX       -98,Y
    244                           *   STU       -96,Y
    245                           *   PULS      D,X,U
    246                           *   STD       -94,Y
    247                           *   STX       -92,Y
    248                           *   STU       -90,Y
    249                           *   PULS      D,X,U
    250                           *   STD       -88,Y
    251                           *   STX       -86,Y
    252                           *   STU       -84,Y
    253                           *   PULS      D,X,U
    254                           *   STD       -82,Y
    255                           *   STX       -80,Y
    256                           *   STU       -78,Y
    257                           *   PULS      D,X,U
    258                           *   STD       -76,Y
    259                           *   STX       -74,Y
    260                           *   STU       -72,Y
    261                           *   PULS      D,X,U
    262                           *   STD       -70,Y
    263                           *   STX       -68,Y
    264                           *   STU       -66,Y
    265                           *   PULS      D,X,U
    266                           *   STD       -64,Y
    267                           *   STX       -62,Y
    268                           *   STU       -60,Y
    269                           *   PULS      D,X,U
    270                           *   STD       -58,Y
    271                           *   STX       -56,Y
    272                           *   STU       -54,Y
    273                           *   PULS      D,X,U
    274                           *   STD       -52,Y
    275                           *   STX       -50,Y
    276                           *   STU       -48,Y
    277                           *   PULS      D,X,U
    278                           *   STD       -46,Y
    279                           *   STX       -44,Y
    280                           *   STU       -42,Y
    281                           *   PULS      D,X,U
    282                           *   STD       -40,Y
    283                           *   STX       -38,Y
    284                           *   STU       -36,Y
    285                           *   PULS      D,X,U
    286                           *   STD       -34,Y
    287                           *   STX       -32,Y
    288                           *   STU       -30,Y
    289                           *   PULS      D,X,U
    290                           *   STD       -28,Y
    291                           *   STX       -26,Y
    292                           *   STU       -24,Y
    293                           *   PULS      D,X,U
    294                           *   STD       -22,Y
    295                           *   STX       -20,Y
    296                           *   STU       -18,Y
    297                           *   PULS      D,X,U
    298                           *   STD       -16,Y
    299                           *   STX       -14,Y
    300                           *   STU       -12,Y
    301                           *   PULS      D,X,U
    302                           *   STD       -10,Y
    303                           *   STX       -8,Y
    304                           *   STU       -6,Y
    305                           *   PULS      D,X,U
    306                           *   STD       -4,Y
    307                           *   STX       -2,Y
    308                           *   STU       ,Y
    309                           *   PULS      D,X,U
    310                           *   STD       2,Y
    311                           *   STX       4,Y
    312                           *   STU       6,Y
    313                           *   PULS      D,X,U
    314                           *   STD       8,Y
    315                           *   STX       10,Y
    316                           *   STU       12,Y
    317                           *   PULS      D,X,U
    318                           *   STD       14,Y
    319                           *   STX       16,Y
    320                           *   STU       18,Y
    321                           *   PULS      D,X,U
    322                           *   STD       20,Y
    323                           *   STX       22,Y
    324                           *   STU       24,Y
    325                           *   PULS      D,X,U
    326                           *   STD       26,Y
    327                           *   STX       28,Y
    328                           *   STU       30,Y
    329                           *   PULS      D,X,U
    330                           *   STD       32,Y
    331                           *   STX       34,Y
    332                           *   STU       36,Y
    333                           *   PULS      D,X,U
    334                           *   STD       38,Y
    335                           *   STX       40,Y
    336                           *   STU       42,Y
    337                           *   PULS      D,X,U
    338                           *   STD       44,Y
    339                           *   STX       46,Y
    340                           *   STU       48,Y
    341                           *   PULS      D,X,U
    342                           *   STD       50,Y
    343                           *   STX       52,Y
    344                           *   STU       54,Y
    345                           *   PULS      D,X,U
    346                           *   STD       56,Y
    347                           *   STX       58,Y
    348                           *   STU       60,Y
    349                           *   PULS      D,X,U
    350                           *   STD       62,Y
    351                           *   STX       64,Y
    352                           *   STU       66,Y
    353                           *   PULS      D,X,U
    354                           *   STD       68,Y
    355                           *   STX       70,Y
    356                           *   STU       72,Y
    357                           *   PULS      D,X,U
    358                           *   STD       74,Y
    359                           *   STX       76,Y
    360                           *   STU       78,Y
    361                           *   PULS      D,X,U
    362                           *   STD       80,Y
    363                           *   STX       82,Y
    364                           *   STU       84,Y
    365                           *   PULS      D,X,U
    366                           *   STD       86,Y
    367                           *   STX       88,Y
    368                           *   STU       90,Y
    369                           *   PULS      D,X,U
    370                           *   STD       92,Y
    371                           *   STX       94,Y
    372                           *   STU       96,Y
    373                           *   PULS      D,X,U
    374                           *   STD       98,Y
    375                           *   STX       100,Y
    376                           *   STU       102,Y
    377                           *   PULS      D,X,U
    378                           *   STD       104,Y
    379                           *   STX       106,Y
    380                           *   STU       108,Y
    381                           *   PULS      D,X,U
    382                           *   STD       110,Y
    383                           *   STX       112,Y
    384                           *   STU       114,Y
    385                           *   PULS      D,X,U
    386                           *   STD       116,Y
    387                           *   STX       118,Y
    388                           *   STU       120,Y
    389                           *   PULS      D,X,U
    390                           *   STD       122,Y
    391                           *   STX       124,Y
    392                           *   STU       126,Y
    393                           *   LEAY 256,Y
    394                           *MEM_COPY_DATA_TO_CART_E
    395                           *   CMPY    #$0180
    396                           *   LBNE     MEM_COPY_DATA_TO_CART
    397                           *MEM_COPY_DATA_TO_CART_S
    398                           *   LDS     #$0000    * Rechargement du p>>
    399                           *   RTS
    400                            
    401        6400               MEM_COPY_DATA_TO_CART
    402  7     6400 10FF 64F0        STS MEM_COPY_DATA_TO_CART_S+2  * sauve>>
    403  6     6404 1F   34          TFR U,S
    404        6406               MEM_COPY_DATA_TO_CART_LOOP
    405  5+6   6406 35   56          PULS       D,X,U
    406  5+1   6408 ED   A8 C0       STD -64,Y
    407  5+1   640B AF   A8 C2       STX -62,Y
    408  5+1   640E EF   A8 C4       STU -60,Y
    409  5+6   6411 35   56          PULS       D,X,U
    410  5+1   6413 ED   A8 C6       STD -58,Y
    411  5+1   6416 AF   A8 C8       STX -56,Y
    412  5+1   6419 EF   A8 CA       STU -54,Y
    413  5+6   641C 35   56          PULS       D,X,U
    414  5+1   641E ED   A8 CC       STD -52,Y
    415  5+1   6421 AF   A8 CE       STX -50,Y
    416  5+1   6424 EF   A8 D0       STU -48,Y
    417  5+6   6427 35   56          PULS       D,X,U
    418  5+1   6429 ED   A8 D2       STD -46,Y
    419  5+1   642C AF   A8 D4       STX -44,Y
    420  5+1   642F EF   A8 D6       STU -42,Y
    421  5+6   6432 35   56          PULS       D,X,U
    422  5+1   6434 ED   A8 D8       STD -40,Y
    423  5+1   6437 AF   A8 DA       STX -38,Y
    424  5+1   643A EF   A8 DC       STU -36,Y
    425  5+6   643D 35   56          PULS       D,X,U
    426  5+1   643F ED   A8 DE       STD -34,Y
    427  5+1   6442 AF   A8 E0       STX -32,Y
    428  5+1   6445 EF   A8 E2       STU -30,Y
    429  5+6   6448 35   56          PULS       D,X,U
    430  5+1   644A ED   A8 E4       STD -28,Y
    431  5+1   644D AF   A8 E6       STX -26,Y
    432  5+1   6450 EF   A8 E8       STU -24,Y
    433  5+6   6453 35   56          PULS       D,X,U
    434  5+1   6455 ED   A8 EA       STD -22,Y
    435  5+1   6458 AF   A8 EC       STX -20,Y
    436  5+1   645B EF   A8 EE       STU -18,Y
    437  5+6   645E 35   56          PULS       D,X,U
    438  5+1   6460 ED   30          STD -16,Y
    439  5+1   6462 AF   32          STX -14,Y
    440  5+1   6464 EF   34          STU -12,Y
    441  5+6   6466 35   56          PULS       D,X,U
    442  5+1   6468 ED   36          STD -10,Y
    443  5+1   646A AF   38          STX -8,Y
    444  5+1   646C EF   3A          STU -6,Y
    445  5+6   646E 35   56          PULS       D,X,U
    446  5+1   6470 ED   3C          STD -4,Y
    447  5+1   6472 AF   3E          STX -2,Y
    448  5+0   6474 EF   A4          STU ,Y
    449  5+6   6476 35   56          PULS       D,X,U
    450  5+1   6478 ED   22          STD 2,Y
    451  5+1   647A AF   24          STX 4,Y
    452  5+1   647C EF   26          STU 6,Y
    453  5+6   647E 35   56          PULS       D,X,U
    454  5+1   6480 ED   28          STD 8,Y
    455  5+1   6482 AF   2A          STX 10,Y
    456  5+1   6484 EF   2C          STU 12,Y
    457  5+6   6486 35   56          PULS       D,X,U
    458  5+1   6488 ED   2E          STD 14,Y
    459  5+1   648A AF   A8 10       STX 16,Y
    460  5+1   648D EF   A8 12       STU 18,Y
    461  5+6   6490 35   56          PULS       D,X,U
    462  5+1   6492 ED   A8 14       STD 20,Y
    463  5+1   6495 AF   A8 16       STX 22,Y
    464  5+1   6498 EF   A8 18       STU 24,Y
    465  5+6   649B 35   56          PULS       D,X,U
    466  5+1   649D ED   A8 1A       STD 26,Y
    467  5+1   64A0 AF   A8 1C       STX 28,Y
    468  5+1   64A3 EF   A8 1E       STU 30,Y
    469  5+6   64A6 35   56          PULS       D,X,U
    470  5+1   64A8 ED   A8 20       STD 32,Y
    471  5+1   64AB AF   A8 22       STX 34,Y
    472  5+1   64AE EF   A8 24       STU 36,Y
    473  5+6   64B1 35   56          PULS       D,X,U
    474  5+1   64B3 ED   A8 26       STD 38,Y
    475  5+1   64B6 AF   A8 28       STX 40,Y
    476  5+1   64B9 EF   A8 2A       STU 42,Y
    477  5+6   64BC 35   56          PULS       D,X,U
    478  5+1   64BE ED   A8 2C       STD 44,Y
    479  5+1   64C1 AF   A8 2E       STX 46,Y
    480  5+1   64C4 EF   A8 30       STU 48,Y
    481  5+6   64C7 35   56          PULS       D,X,U
    482  5+1   64C9 ED   A8 32       STD 50,Y
    483  5+1   64CC AF   A8 34       STX 52,Y
    484  5+1   64CF EF   A8 36       STU 54,Y
    485  5+6   64D2 35   56          PULS       D,X,U
    486  5+1   64D4 ED   A8 38       STD 56,Y
    487  5+1   64D7 AF   A8 3A       STX 58,Y
    488  5+1   64DA EF   A8 3C       STU 60,Y
    489  5+2   64DD 35   06          PULS       D
    490  5+1   64DF ED   A8 3E       STD 62,Y
    491  4+4   64E2 31   A9 0080     LEAY 128,Y
    492        64E6               MEM_COPY_DATA_TO_CART_E
    493  5     64E6 108C 00C0        CMPY    #$00C0
    494  6     64EA 1026 FF18        LBNE    MEM_COPY_DATA_TO_CART_LOOP
    495        64EE               MEM_COPY_DATA_TO_CART_S
    496  4     64EE 10CE 0000        LDS     #$0000    * Rechargement du po>>
    497  5     64F2 39               RTS
    498
    499                           *MEM_COPY_DATA_TO_CART
    500                           *   PULS    D,X,U
    501                           *   STD     -16,Y
    502                           *   STX     -14,Y
    503                           *   STU     -12,Y
    504                           *   PULS    D,X,U
    505                           *   STD     -10,Y
    506                           *   STX     -8,Y
    507                           *   STU     -6,Y
    508                           *   PULS    D,X,U
    509                           *   STD     -4,Y
    510                           *   STX     -2,Y
    511                           *   STU     ,Y
    512                           *   PULS    D,X,U
    513                           *   STD     2,Y
    514                           *   STX     4,Y
    515                           *   STU     6,Y
    516                           *   PULS    D,X
    517                           *   STD     8,Y
    518                           *   STX     10,Y
    519                           *   PULS    D,X
    520                           *   STD     12,Y
    521                           *   STX     14,Y
    522                           *   LEAY    32,Y
    523                           *MEM_COPY_DATA_TO_CART_E
    524                           *   CMPY    #$0030
    525                           *   BNE     MEM_COPY_DATA_TO_CART
    526                           *MEM_COPY_DATA_TO_CART_S
    527                           *   LDS     #$0000    * Rechargement du p>>
    528                           *   RTS
    529                           *****************************************>>
    530                           * Effacement memoire Cartouche (27000 cy)>>
    531                           *****************************************>>
    532        64F3               CLR_CART
    533  5+3   64F3 34   48           PSHS U,DP
    534  7     64F5 10FF 652A         STS CLR_CART_3+2
    535  4     64F9 10CE 4000         LDS #$4000
    536  3     64FD CE   0000         LDU #$0000
    537  4     6500 108E 0000         LDY #$0000
    538  3     6504 8E   0000         LDX #$0000
    539  3     6507 CC   0000         LDD #$0000
    540  6     650A 1F   8B           TFR A,DP
    541        650C               CLR_CART_2
    542  5+9   650C 34   7E           PSHS U,Y,X,DP,B,A
    543  5+9   650E 34   7E           PSHS U,Y,X,DP,B,A
    544  5+9   6510 34   7E           PSHS U,Y,X,DP,B,A
    545  5+9   6512 34   7E           PSHS U,Y,X,DP,B,A
    546  5+9   6514 34   7E           PSHS U,Y,X,DP,B,A
    547  5+9   6516 34   7E           PSHS U,Y,X,DP,B,A
    548  5+9   6518 34   7E           PSHS U,Y,X,DP,B,A
    549  5+9   651A 34   7E           PSHS U,Y,X,DP,B,A
    550  5+9   651C 34   7E           PSHS U,Y,X,DP,B,A
    551  5+9   651E 34   7E           PSHS U,Y,X,DP,B,A
    552  5     6520 118C 0004         CMPS #$0004
    553  3     6524 26   E6           BNE CLR_CART_2
    554  5+4   6526 34   60           PSHS U,Y
    555        6528               CLR_CART_3
    556  4     6528 10CE 0000         LDS #$0000
    557  5+3   652C 35   48           PULS DP,U
    558  5     652E 39                RTS
    559                            
    560                           *****************************************>>
    561                           * Affichage de l arriere plan 57900 cycle>>
    562                           *****************************************>>
    563                           *DRAW_RAM_DATA_TO_CART_160x200
    564                           *      PSHS U,DP            * sauvegarde >>
    565                           *      STS DRAW_RAM_DATA_TO_CART_160x200A>>
    566                           *
    567                           *      LDS #FINECRANA       * init pointe>>
    568                           *      LDU #$A000
    569                           *
    570                           *DRAW_RAM_DATA_TO_CART_160x200A
    571                           *      PULU A,B,DP,X,Y
    572                           *      PSHS Y,X,DP,B,A
    573                           *      PULU A,B,DP,X,Y
    574                           *      PSHS Y,X,DP,B,A
    575                           *      PULU A,B,DP,X,Y
    576                           *      PSHS Y,X,DP,B,A
    577                           *      PULU A,B,DP,X,Y
    578                           *      PSHS Y,X,DP,B,A
    579                           *      PULU A,B,DP,X,Y
    580                           *      PSHS Y,X,DP,B,A
    581                           *      PULU A,B,DP,X,Y
    582                           *      PSHS Y,X,DP,B,A
    583                           *      CMPS #DEBUTECRANA
    584                           *      BNE DRAW_RAM_DATA_TO_CART_160x200A>>
    585                           *      PULU A,B,DP,X,Y
    586                           *      PSHS Y,X,DP,B,A
    587                           *      PULU A,B,DP,X,Y
    588                           *      PSHS Y,X,DP,B,A
    589                           *      PULU B,DP,X,Y
    590                           *      PSHS Y,X,DP,B
    591                           *
    592                           *      LDS #FINECRANB       * init pointe>>
    593                           *      LDU #$C000
    594                           *
    595                           *DRAW_RAM_DATA_TO_CART_160x200B
    596                           *      PULU A,B,DP,X,Y
    597                           *      PSHS Y,X,DP,B,A
    598                           *      PULU A,B,DP,X,Y
    599                           *      PSHS Y,X,DP,B,A
    600                           *      PULU A,B,DP,X,Y
    601                           *      PSHS Y,X,DP,B,A
    602                           *      PULU A,B,DP,X,Y
    603                           *      PSHS Y,X,DP,B,A
    604                           *      PULU A,B,DP,X,Y
    605                           *      PSHS Y,X,DP,B,A
    606                           *      PULU A,B,DP,X,Y
    607                           *      PSHS Y,X,DP,B,A
    608                           *      CMPS #DEBUTECRANB
    609                           *      BNE DRAW_RAM_DATA_TO_CART_160x200B>>
    610                           *      PULU A,B,DP,X,Y
    611                           *      PSHS Y,X,DP,B,A
    612                           *      PULU A,B,DP,X,Y
    613                           *      PSHS Y,X,DP,B,A
    614                           *      PULU B,DP,X,Y
    615                           *      PSHS Y,X,DP,B
    616                           *DRAW_RAM_DATA_TO_CART_160x200A_E
    617                           *      LDS  #$0000 * rechargement des reg>>
    618                           *      PULS U,DP
    619                           *      RTS
    620
    621                           *****************************************>>
    622                           * Palette de 16 couleurs
    623                           *****************************************>>
    624        652F               TABPALETTE
    625        652F 0CCD                 FDB $0ccd     * index:0  R:244 V:2>>
    626        6531 0BA4                 FDB $0ba4     * index:1  R:164 V:2>>
    627        6533 035D                 FDB $035d     * index:2  R:244 V:1>>
    628        6535 0D81                 FDB $0d81     * index:3  R:108 V:2>>
    629        6537 013B                 FDB $013b     * index:4  R:228 V:1>>
    630        6539 0541                 FDB $0541     * index:5  R:100 V:1>>
    631        653B 0D30                 FDB $0d30     * index:6  R:43  V:1>>
    632        653D 0017                 FDB $0017     * index:7  R:196 V:1>>
    633        653F 000B                 FDB $000b     * index:8  R:228 V:2>>
    634        6541 0D10                 FDB $0d10     * index:9  R:4   V:1>>
    635        6543 0110                 FDB $0110     * index:10 R:28  V:9>>
    636        6545 0003                 FDB $0003     * index:11 R:148 V:2>>
    637        6547 0700                 FDB $0700     * index:12 R:4   V:5>>
    638        6549 0200                 FDB $0200     * index:13 R:4   V:2>>
    639        654B 0000                 FDB $0000     * index:14 R:68  V:2>>
    640        654D 0000                 FDB $0000     * index:15 R:4   V:2>>
    641        654F               FINTABPALETTE
    642
    643                           *****************************************>>
    644                           * Get joystick parameters
    645                           *****************************************>>
    646        654F               JOY_READ
    647  3     654F 8E   E7CF            ldx    #$e7cf
    648  4     6552 108E E7CD            ldy    #$e7cd
    649  3     6556 CC   400F            ldd    #$400f
    650  5     6559 F4   E7CC            andb   >$e7cc     * Read position
    651  5     655C F7   6567            stb    JOY_DIR_STATUS
    652  4+0   655F A4   A4              anda   ,y         * Read button
    653  2     6561 88   40              eora   #$40
    654  5     6563 B7   6568            sta    JOY_BTN_STATUS
    655  5     6566 39                   RTS
    656        6567               JOY_DIR_STATUS
    657        6567 00                   FCB $00 * Position Pad
    658        6568               JOY_BTN_STATUS
    659        6568 00                   FCB $00 * 40 Bouton A enfonce
    660
    661                           *****************************************>>
    662                           * Subroutine to      make HERO walk/run
    663                           *****************************************>>
    664        6569               Hero_Move
    665  5     6569 B6   6567            LDA JOY_DIR_STATUS
    666  2     656C 81   0B              CMPA #JOY_G
    667  3     656E 26   02              BNE Hero_NotLeft
    668  3     6570 20   69              BRA Hero_MoveLeft
    669
    670        6572               Hero_NotLeft                   * XREF: He>>
    671  2     6572 81   07              CMPA #JOY_D
    672  3     6574 26   03              BNE Hero_NotLeftOrRight
    673  5     6576 16   00A6            LBRA Hero_MoveRight
    674
    675        6579               Hero_NotLeftOrRight            * XREF: He>>
    676  6     6579 FC   6750            LDD HERO_G_SPEED
    677  5     657C 1083 0000            CMPD #$0000
    678  3     6580 2D   2E              BLT Hero_NotLeftOrRight_00 * se de>>
    679  7     6582 B3   6762            SUBD HERO_FRICTION     * se deplac>>
    680  3     6585 24   12              BCC Hero_NotLeftOrRight_01 * si on>>
    681  3     6587 CC   0000            LDD #$0000
    682  6     658A FD   6750            STD HERO_G_SPEED
    683  6     658D FD   6754            STD HERO_X_SPS
    684  3     6590 8E   6744            LDX #HERO_IDLE_R        * Charge a>>
    685  6     6593 BF   6764            STX HERO_ANIMATION_ADR      * Sauv>>
    686  5     6596 16   00C4            LBRA Hero_MoveUpdatePos
    687        6599               Hero_NotLeftOrRight_01
    688  5     6599 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    689  3     659D 2C   0B              BGE Hero_NotLeftOrRight_02
    690  6     659F FD   6750            STD HERO_G_SPEED
    691  3     65A2 8E   6744            LDX #HERO_WALK_R        * Charge a>>
    692  6     65A5 BF   6764            STX HERO_ANIMATION_ADR      * Sauv>>
    693  3     65A8 20   03              BRA Hero_NotLeftOrRight_03
    694        65AA               Hero_NotLeftOrRight_02
    695  6     65AA FD   6750            STD HERO_G_SPEED
    696        65AD               Hero_NotLeftOrRight_03
    697  5     65AD 16   00AD            LBRA Hero_MoveUpdatePos
    698        65B0               Hero_NotLeftOrRight_00
    699  7     65B0 F3   6762            ADDD HERO_FRICTION     * se deplac>>
    700  3     65B3 24   0F              BCC Hero_NotLeftOrRight_11 * si on>>
    701  3     65B5 CC   0000            LDD #$0000
    702  6     65B8 FD   6750            STD HERO_G_SPEED
    703  3     65BB 8E   6744            LDX #HERO_IDLE_L        * Charge a>>
    704  6     65BE BF   6764            STX HERO_ANIMATION_ADR      * Sauv>>
    705  5     65C1 16   0099            LBRA Hero_MoveUpdatePos
    706        65C4               Hero_NotLeftOrRight_11
    707  5     65C4 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    708  3     65C8 2F   0B              BLE Hero_NotLeftOrRight_12
    709  6     65CA FD   6750            STD HERO_G_SPEED
    710  3     65CD 8E   6744            LDX #HERO_WALK_L        * Charge a>>
    711  6     65D0 BF   6764            STX HERO_ANIMATION_ADR      * Sauv>>
    712  3     65D3 20   03              BRA Hero_NotLeftOrRight_13
    713        65D5               Hero_NotLeftOrRight_12
    714  6     65D5 FD   6750            STD HERO_G_SPEED
    715        65D8               Hero_NotLeftOrRight_13
    716  5     65D8 16   0082            LBRA Hero_MoveUpdatePos
    717
    718        65DB               Hero_MoveLeft                      * XREF>>
    719  6     65DB FC   6750            LDD HERO_G_SPEED            * Char>>
    720  5     65DE 1083 0000            CMPD #$0000                 * Test>>
    721  3     65E2 2F   11              BLE Hero_MoveLeft_00        * BRAN>>
    722  7     65E4 B3   6760            SUBD HERO_DECELERATION      * orie>>
    723  3     65E7 24   06              BCC Hero_MoveLeft_03        * BRAN>>
    724  3     65E9 CC   0000            LDD #$0000
    725  7     65EC B3   6760            SUBD HERO_DECELERATION      * si l>>
    726        65EF               Hero_MoveLeft_03
    727  6     65EF FD   6750            STD HERO_G_SPEED            * On s>>
    728  5     65F2 16   0068            LBRA Hero_MoveUpdatePos           >>
    729        65F5               Hero_MoveLeft_00                         >>
    730                           *      CMPD #$0000                       >>
    731                           *      BNE Hero_MoveLeft_02        * BRAN>>
    732                           *      LDD #$FEFF                        >>
    733                           *Hero_MoveLeft_02
    734  8     65F5 10B3 675C            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    735  3     65F9 27   62              BEQ Hero_MoveUpdatePos      * vite>>
    736  7     65FB B3   675E            SUBD HERO_ACCELERATION      * acce>>
    737  8     65FE 10B3 675C            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    738  3     6602 2E   0F              BGT Hero_MoveLeft_01        * BRAN>>
    739  3     6604 8E   6744            LDX #HERO_RUN_L        * Charge an>>
    740  6     6607 BF   6764            STX HERO_ANIMATION_ADR      * Sauv>>
    741  6     660A FC   675C            LDD HERO_NEG_TOP_SPEED      * Limi>>
    742  6     660D FD   6750            STD HERO_G_SPEED            * Enre>>
    743  5     6610 16   004A            LBRA Hero_MoveUpdatePos     * Mise>>
    744        6613               Hero_MoveLeft_01
    745  6     6613 FD   6750            STD HERO_G_SPEED            * Enre>>
    746  3     6616 8E   6744            LDX #HERO_WALK_L        * Charge a>>
    747  6     6619 BF   6764            STX HERO_ANIMATION_ADR      * Sauv>>
    748  5     661C 16   003E            LBRA Hero_MoveUpdatePos
    749
    750        661F               Hero_MoveRight                  * XREF: H>>
    751  6     661F FC   6750            LDD HERO_G_SPEED        * Chargeme>>
    752  5     6622 1083 0000            CMPD #$0000                 * Test>>
    753  3     6626 2C   0E              BGE Hero_MoveRight_00       * BRAN>>
    754  7     6628 F3   6760            ADDD HERO_DECELERATION      * orie>>
    755  3     662B 24   03              BCC Hero_MoveRight_03       * BRAN>>
    756  6     662D FC   6760            LDD HERO_DECELERATION   * si la vi>>
    757        6630               Hero_MoveRight_03
    758  6     6630 FD   6750            STD HERO_G_SPEED        * On stock>>
    759  5     6633 16   0027            LBRA Hero_MoveUpdatePos           >>
    760        6636               Hero_MoveRight_00                  * Orie>>
    761                           *      CMPD #$0000                       >>
    762                           *      BNE Hero_MoveRight_02       * BRAN>>
    763                           *      LDD #$0100                        >>
    764                           *Hero_MoveRight_02
    765  8     6636 10B3 675A            CMPD HERO_TOP_SPEED         * Comp>>
    766  3     663A 27   21              BEQ Hero_MoveUpdatePos      * vite>>
    767  7     663C F3   675E            ADDD HERO_ACCELERATION      * acce>>
    768  8     663F 10B3 675A            CMPD HERO_TOP_SPEED         * Comp>>
    769  3     6643 2D   0F              BLT Hero_MoveRight_01       * BRAN>>
    770  3     6645 8E   6744            LDX #HERO_RUN_R                   >>
    771  6     6648 BF   6764            STX HERO_ANIMATION_ADR      * Sauv>>
    772  6     664B FC   675A            LDD HERO_TOP_SPEED          * Limi>>
    773  6     664E FD   6750            STD HERO_G_SPEED            * Enre>>
    774  5     6651 16   0009            LBRA Hero_MoveUpdatePos           >>
    775        6654               Hero_MoveRight_01
    776  6     6654 FD   6750            STD HERO_G_SPEED            * Enre>>
    777  3     6657 8E   6744            LDX #HERO_WALK_R        * Charge a>>
    778  6     665A BF   6764            STX HERO_ANIMATION_ADR      * Sauv>>
    779
    780        665D               Hero_MoveUpdatePos
    781  6     665D FC   6750            LDD HERO_G_SPEED            * Char>>
    782  6     6660 FD   6752            STD HERO_X_SPEED        * Stockage>>
    783  5     6663 1083 0000            CMPD #$0000                 * Test>>
    784  3     6667 2D   0E              BLT Hero_MoveUpdatePos_00   * BRAN>>
    785  7     6669 F3   6754            ADDD HERO_X_SPS         * Ajout du>>
    786  5     666C F7   6755            STB HERO_X_SPS+1            * sauv>>
    787  6     666F 1F   89              TFR A,B                     * Divi>>
    788  5     6671 FB   674E            ADDB HERO_X_POS                   >>
    789  3     6674 20   18              BRA Hero_MoveUpdatePos_01
    790        6676               Hero_MoveUpdatePos_V00
    791        6676 00                   FCB $00
    792        6677               Hero_MoveUpdatePos_00
    793  3     6677 CC   0000            LDD #$0000
    794  7     667A B3   6752            SUBD HERO_X_SPEED           * La v>>
    795  7     667D F3   6754            ADDD HERO_X_SPS         * Ajout du>>
    796  5     6680 F7   6755            STB HERO_X_SPS+1            * sauv>>
    797  6     6683 1F   89              TFR A,B                     * Divi>>
    798  5     6685 F7   6676            STB Hero_MoveUpdatePos_V00
    799  5     6688 F6   674E            LDB HERO_X_POS
    800  5     668B F0   6676            SUBB Hero_MoveUpdatePos_V00 * Ajou>>
    801        668E               Hero_MoveUpdatePos_01
    802                           *      CMPB #$50                         >>
    803                           *      BLE Hero_MoveUpdatePos_02   * Bute>>
    804                           *      LDB #$50                          >>
    805                           *Hero_MoveUpdatePos_02
    806                           *    CMPB #$0C                           >>
    807                           *      BGE Hero_MoveUpdatePos_03   * Bute>>
    808                           *      LDB #$0C                          >>
    809        668E               Hero_MoveUpdatePos_03
    810  5     668E F7   674E            STB HERO_X_POS
    811  2     6691 C6   00              LDB #$00
    812  5     6693 F7   6754            STB HERO_X_SPS                    >>
    813  3     6696 CC   0000            LDD #$0000                  * TODO>>
    814  6     6699 FD   6756            STD HERO_Y_SPEED
    815  6     669C 1F   89              TFR A,B                     * divi>>
    816  5     669E FB   674F            ADDB HERO_Y_POS
    817  5     66A1 F7   674F            STB HERO_Y_POS
    818  5     66A4 39                   RTS
    819
    820                           * TODO : Braking Animation
    821                           * Sonic enters his braking animation when>>
    822                           * In Sonic 1 and Sonic CD, he then stays >>
    823                           * In the other 3 games, Sonic returns to >>
    824
    825        66A5               Compute_Position
    826  5     66A5 B6   674E            LDA HERO_X_POS
    827  2     66A8 44                   LSRA
    828  3     66A9 25   17              BCS Compute_Position_01
    829  5     66AB B7   66DD            STA Compute_Position_02+1
    830  2     66AE 86   28              LDA #$28
    831  5     66B0 F6   674F            LDB HERO_Y_POS
    832  2     66B3 5A                   DECB
    833  11    66B4 3D                   MUL
    834  7     66B5 F3   66DC            ADDD Compute_Position_02
    835  6     66B8 FD   9F00            STD HERO_POS
    836  4     66BB C3   2000            ADDD #$2000
    837  6     66BE FD   9F02            STD HERO_POS+2
    838  5     66C1 39                   RTS
    839        66C2               Compute_Position_01
    840  5     66C2 B7   66DD            STA Compute_Position_02+1
    841  2     66C5 86   28              LDA #$28
    842  5     66C7 F6   674F            LDB HERO_Y_POS
    843  2     66CA 5A                   DECB
    844  11    66CB 3D                   MUL
    845  7     66CC F3   66DC            ADDD Compute_Position_02
    846  4     66CF C3   2000            ADDD #$2000
    847  6     66D2 FD   9F00            STD HERO_POS
    848  4     66D5 83   1FFF            SUBD #$1FFF
    849  6     66D8 FD   9F02            STD HERO_POS+2
    850  5     66DB 39                   RTS
    851        66DC               Compute_Position_02
    852        66DC 0000                 FDB $0000
    853
    854                           *****************************************>>
    855                           * HERO Animations
    856                           * ---------------
    857                           * Note: Speed abs +0, rel +8, rel cap +10>>
    858                           *
    859                           * Chargement nouvelle animation
    860                           *    nouvelle frame = 109 a 119
    861                           *
    862                           * Chargement frame suivante
    863                           *    frame identique = 15
    864                           * ou frame suivante  = 116 a 126
    865                           *
    866                           * Chargement frame suivante avec branchem>>
    867                           *    nouvelle frame = 165 a 175
    868                           * ou frame suivante = 172 a 182
    869                           *
    870                           * Chargement frame suivante avec retour s>>
    871                           *    nouvelle frame = 167 a 177
    872                           * ou frame suivante = 174 a 184
    873                           *****************************************>>
    874
    875        66DE               HERO_ANIMATION_LOAD                      >>
    876  6     66DE BF   6764            STX HERO_ANIMATION_ADR
    877  6     66E1 BF   6766            STX HERO_ANIMATION_RTN_ADR
    878  7     66E4 7F   676D            CLR HERO_ANIMATION_IMC            >>
    879        66E7               HERO_ANIMATION_LOAD_00
    880  5+1   66E7 EC   1E              LDD -2,X                          >>
    881  2     66E9 81   00              CMPA #$00                         >>
    882  3     66EB 27   07              BEQ HERO_ANIMATION_LOAD_01
    883  5     66ED F0   6750            SUBB HERO_G_SPEED                 >>
    884  3     66F0 24   02              BCC HERO_ANIMATION_LOAD_01
    885  2     66F2 C6   01              LDB #$01                          >>
    886        66F4               HERO_ANIMATION_LOAD_01
    887  5     66F4 F7   676F            STB HERO_ANIMATION_FRR            >>
    888  5     66F7 B6   676D            LDA HERO_ANIMATION_IMC
    889  2     66FA C6   05              LDB #$05
    890  11    66FC 3D                   MUL
    891  7     66FD F3   6764            ADDD HERO_ANIMATION_ADR
    892  6     6700 1F   02              TFR D,Y
    893  4+0   6702 E6   A4              LDB ,Y
    894  2     6704 C1   1F              CMPB #$1F                         >>
    895  3     6706 22   0E              BHI HERO_ANIMATION_LOAD_NOPAGE
    896  5     6708 F7   6768            STB HERO_ANIMATION_PAG            >>
    897  5+1   670B AE   21              LDX 1,Y
    898  6     670D BF   676B            STX HERO_ANIMATION_DRW
    899  5+1   6710 AE   23              LDX 3,Y
    900  6     6712 BF   6769            STX HERO_ANIMATION_DEL
    901  5     6715 39                   RTS
    902        6716               HERO_ANIMATION_LOAD_NOPAGE
    903  2     6716 C1   FF              CMPB #$FF
    904  3     6718 26   0C              BNE HERO_ANIMATION_LOAD_FE
    905  5+1   671A AE   23              LDX 3,Y
    906  6     671C BF   676D            STX HERO_ANIMATION_IMC            >>
    907  5+1   671F AE   21              LDX 1,Y
    908  6     6721 BF   6764            STX HERO_ANIMATION_ADR
    909  3     6724 20   C1              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    910        6726               HERO_ANIMATION_LOAD_FE
    911  6     6726 BE   6766            LDX HERO_ANIMATION_RTN_ADR  * RETU>>
    912  6     6729 BF   6764            STX HERO_ANIMATION_ADR
    913  5     672C F6   676E            LDB HERO_ANIMATION_RTN_IMC
    914  5     672F F7   676D            STB HERO_ANIMATION_IMC
    915  3     6732 20   B3              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    916
    917        6734               HERO_ANIMATION_NEXT
    918  7     6734 7A   676F            DEC HERO_ANIMATION_FRR
    919  3     6737 27   01              BEQ HERO_ANIMATION_NEXT_00  * BRAN>>
    920  5     6739 39                   RTS
    921        673A               HERO_ANIMATION_NEXT_00
    922  7     673A 7C   676D            INC HERO_ANIMATION_IMC
    923  6     673D BE   6764            LDX HERO_ANIMATION_ADR
    924  3     6740 20   A5              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    925                            
    926                           *   SAMPLE CODE ANIMATION
    927                           *      ---------------------
    928                           *      FDB $0018            * 00 Absolute>>
    929                           *HERO_IDLE_L
    930                           *      FCB $01                     * Page>>
    931                           *      FDB $A000            * Adresse drw>>
    932                           *      FDB $A000            * Adresse del>>
    933                           *
    934                           *      FCB $FF                     * FF S>>
    935                           *      FDB HERO_IDLE-C * adresse animatio>>
    936                           *      FDB $0301            * 03 image ci>>
    937                           *
    938                           *      FCB $FE                     * FE R>>
    939                           *
    940                           *      LDX #HERO_IDLE_R
    941                           *      JSR HERO_ANIMATION_LOAD
    942                           *
    943                           *      JSR HERO_ANIMATION_NEXT
    944
    945                           *<ANIMATION_TABLE>
    946                           * Limite a 128 images par animations
    947
    948        6742 0001                 FDB $0001
    949        6744               HERO_IDLE_L
    950        6744               HERO_IDLE_R
    951        6744               HERO_IDLE_L2
    952        6744               HERO_SUBIDLE_B
    953        6744               HERO_WALK_L
    954        6744               HERO_WALK_R
    955        6744               HERO_RUN_L
    956        6744               HERO_RUN_R
    957        6744 04                   FCB $04
    958        6745 A000                 FDB $A000
    959        6747 A612                 FDB $A612
    960        6749 FF                   FCB $FF
    961        674A 6744                 FDB HERO_RUN_R
    962        674C 0000                 FDB $0000
    963                            
    964                           *****************************************>>
    965                           * HERO Variables
    966                           *****************************************>>
    967                  0400     HERO_WALK_SPD_LIMIT EQU $0400
    968                  0600     HERO_JOG_SPD_LIMIT  EQU $0600
    969        674E               HERO_X_POS
    970        674E 50                   FCB $50                     * Hori>>
    971        674F               HERO_Y_POS
    972        674F C8                   FCB $C8                     * Vert>>
    973        6750               HERO_G_SPEED         * Ground Speed
    974        6750 0000                 FDB $0000            * First byte >>
    975        6752               HERO_X_SPEED
    976        6752 0000                 FDB $0000            * Horizontal >>
    977        6754               HERO_X_SPS
    978        6754 0000                 FDB $0000            * Subpixel X >>
    979        6756               HERO_Y_SPEED
    980        6756 0000                 FDB $0000            * Vertical Sp>>
    981        6758               HERO_Y_SPS
    982        6758 0000                 FDB $0000            * Subpixel Y >>
    983        675A               HERO_TOP_SPEED
    984        675A 0600                 FDB $0600        * vitesse maximum>>
    985        675C               HERO_NEG_TOP_SPEED
    986        675C FA00                 FDB $FA00        * vitesse maximum>>
    987        675E               HERO_ACCELERATION
    988        675E 000C                 FDB $000C        * constante accel>>
    989        6760               HERO_DECELERATION
    990        6760 0080                 FDB $0080        * constante decel>>
    991        6762               HERO_FRICTION
    992        6762 000C                 FDB $000C        * constante de fr>>
    993        6764               HERO_ANIMATION_ADR
    994        6764 0000                 FDB $0000        * Animation coura>>
    995        6766               HERO_ANIMATION_RTN_ADR
    996        6766 0000                 FDB $0000        * Animation coura>>
    997        6768               HERO_ANIMATION_PAG
    998        6768 00                   FCB $00          * Animation coura>>
    999        6769               HERO_ANIMATION_DEL
   1000        6769 0000                 FDB $0000        * Animation coura>>
   1001        676B               HERO_ANIMATION_DRW
   1002        676B 0000                 FDB $0000        * Animation coura>>
   1003        676D               HERO_ANIMATION_IMC
   1004        676D 00                   FCB $00          * Animation coura>>
   1005        676E               HERO_ANIMATION_RTN_IMC
   1006        676E 00                   FCB $00          * Animation coura>>
   1007        676F               HERO_ANIMATION_FRR
   1008        676F 00                   FCB $00          * Animation coura>>

000000 Total Errors

000103 Total Symbols
     0x          Label 6300 BEGIN
     2x          Label 64F3 CLR_CART
     1x          Label 650C CLR_CART_2
     1x          Label 6528 CLR_CART_3
     1x          Label 66A5 Compute_Position
     1x          Label 66C2 Compute_Position_01
     4x          Label 66DC Compute_Position_02
     0x          Equ   0014 DEBUTECRANA
     0x          Equ   2014 DEBUTECRANB
     1x          Equ   622C DK_dernier_bloc_a_ecrire
     1x          Equ   6213 DK_destination
     1x          Equ   6205 DK_lecture
     1x          Equ   620A DK_piste
     1x          Equ   620F DK_secteur
     1x          Equ   1F40 FINECRANA
     1x          Equ   3F40 FINECRANB
     1x          Label 654F FINTABPALETTE
     2x          Label 675E HERO_ACCELERATION
    13x          Label 6764 HERO_ANIMATION_ADR
     2x          Label 6769 HERO_ANIMATION_DEL
     4x          Label 676B HERO_ANIMATION_DRW
     2x          Label 676F HERO_ANIMATION_FRR
     5x          Label 676D HERO_ANIMATION_IMC
     1x          Label 66DE HERO_ANIMATION_LOAD
     3x          Label 66E7 HERO_ANIMATION_LOAD_00
     2x          Label 66F4 HERO_ANIMATION_LOAD_01
     1x          Label 6726 HERO_ANIMATION_LOAD_FE
     1x          Label 6716 HERO_ANIMATION_LOAD_NOPAGE
     1x          Label 6734 HERO_ANIMATION_NEXT
     1x          Label 673A HERO_ANIMATION_NEXT_00
     6x          Label 6768 HERO_ANIMATION_PAG
     2x          Label 6766 HERO_ANIMATION_RTN_ADR
     1x          Label 676E HERO_ANIMATION_RTN_IMC
     4x          Label 6760 HERO_DECELERATION
     2x          Label 6762 HERO_FRICTION
    17x          Label 6750 HERO_G_SPEED
     1x          Label 6744 HERO_IDLE_L
     0x          Label 6744 HERO_IDLE_L2
     2x          Label 6744 HERO_IDLE_R
     2x          Equ   0600 HERO_JOG_SPD_LIMIT
     1x          Label 6569 Hero_Move
     1x          Label 65DB Hero_MoveLeft
     1x          Label 65F5 Hero_MoveLeft_00
     1x          Label 6613 Hero_MoveLeft_01
     1x          Label 65EF Hero_MoveLeft_03
     1x          Label 661F Hero_MoveRight
     1x          Label 6636 Hero_MoveRight_00
     1x          Label 6654 Hero_MoveRight_01
     1x          Label 6630 Hero_MoveRight_03
    11x          Label 665D Hero_MoveUpdatePos
     1x          Label 6677 Hero_MoveUpdatePos_00
     1x          Label 668E Hero_MoveUpdatePos_01
     0x          Label 668E Hero_MoveUpdatePos_03
     2x          Label 6676 Hero_MoveUpdatePos_V00
     3x          Label 675C HERO_NEG_TOP_SPEED
     1x          Label 6572 Hero_NotLeft
     1x          Label 6579 Hero_NotLeftOrRight
     1x          Label 65B0 Hero_NotLeftOrRight_00
     1x          Label 6599 Hero_NotLeftOrRight_01
     1x          Label 65AA Hero_NotLeftOrRight_02
     1x          Label 65AD Hero_NotLeftOrRight_03
     1x          Label 65C4 Hero_NotLeftOrRight_11
     1x          Label 65D5 Hero_NotLeftOrRight_12
     1x          Label 65D8 Hero_NotLeftOrRight_13
     6x          Equ   9F00 HERO_POS
     1x          Label 6744 HERO_RUN_L
     2x          Label 6744 HERO_RUN_R
     0x          Label 6744 HERO_SUBIDLE_B
     3x          Label 675A HERO_TOP_SPEED
     2x          Label 6744 HERO_WALK_L
     2x          Label 6744 HERO_WALK_R
     0x          Equ   0400 HERO_WALK_SPD_LIMIT
     4x          Label 674E HERO_X_POS
     2x          Label 6752 HERO_X_SPEED
     6x          Label 6754 HERO_X_SPS
     4x          Label 674F HERO_Y_POS
     1x          Label 6756 HERO_Y_SPEED
     0x          Label 6758 HERO_Y_SPS
     0x          Label 6356 INIT_VID
     0x          Equ   000D JOY_B
     0x          Equ   0005 JOY_BD
     0x          Equ   0009 JOY_BG
     1x          Label 6568 JOY_BTN_STATUS
     0x          Equ   000F JOY_C
     1x          Equ   0007 JOY_D
     2x          Label 6567 JOY_DIR_STATUS
     1x          Equ   000B JOY_G
     0x          Equ   000E JOY_H
     0x          Equ   0006 JOY_HD
     0x          Equ   000A JOY_HG
     1x          Label 654F JOY_READ
     1x          Label 63B1 MAIN
     2x          Label 6400 MEM_COPY_DATA_TO_CART
     2x          Label 64E6 MEM_COPY_DATA_TO_CART_E
     1x          Label 6406 MEM_COPY_DATA_TO_CART_LOOP
     1x          Label 64EE MEM_COPY_DATA_TO_CART_S
     6x          Label 63D0 SCRC
     3x          Label 63EB SCRC0
     1x          Label 637A SETPALETTE
     1x          Label 652F TABPALETTE
     1x          Label 63F5 VSYNC
     1x          Label 63F5 VSYNC_1
     1x          Label 63FA VSYNC_2

