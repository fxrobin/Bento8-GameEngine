/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : ./input/CODE/MAIN.ASS.TMP
 * Fichier destination : TMP.BIN
 * Contenu :
 *     Main     0:MAIN.ASM     23346
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
     12        6300                      ORG $6300
     13
     14                           *****************************************>>
     15                           * Constantes et variables
     16                           *****************************************>>
     17
     18                  6205     DK_lecture               EQU $6205 * rout>>
     19                  620A     DK_piste                 EQU $620A * 2B n>>
     20                  620F     DK_secteur               EQU $620F * 1B n>>
     21                  6213     DK_destination           EQU $6213 * 2B d>>
     22                  622C     DK_dernier_bloc_a_ecrire EQU $622C * 2B f>>
     23
     24                  0014     DEBUTECRANA EQU $0014 * test pour fin sta>>
     25                  1F40     FINECRANA   EQU $1F40 * fin de la RAM A v>>
     26                  2014     DEBUTECRANB EQU $2014 * test pour fin sta>>
     27                  3F40     FINECRANB   EQU $3F40 * fin de la RAM B v>>
     28
     29                  0005     JOY_BD EQU $05 * Bas Droite
     30                  0006     JOY_HD EQU $06 * Haut Droite
     31                  0007     JOY_D  EQU $07 * Droite
     32                  0009     JOY_BG EQU $09 * Bas Gauche
     33                  000A     JOY_HG EQU $0A * Haut Gauche
     34                  000B     JOY_G  EQU $0B * Gauche
     35                  000D     JOY_B  EQU $0D * Bas
     36                  000E     JOY_H  EQU $0E * Haut
     37                  000F     JOY_C  EQU $0F * Centre
     38
     39                  9F00     HERO_POS EQU $9F00 * HERO Position
     40
     41                           *****************************************>>
     42                           * Debut du programme
     43                           *****************************************>>
     44        6300               BEGIN
     45  2     6300 1A   50              ORCC #$50     * a documenter (inte>>
     46
     47  3     6302 CC   1F40            LDD #FINECRANA
     48  6     6305 FD   9F00            STD HERO_POS
     49  3     6308 CC   3F40            LDD #FINECRANB
     50  6     630B FD   9F02            STD HERO_POS+2
     51
     52                           *****************************************>>
     53                           * Chargement des pages memoire
     54                           *****************************************>>
     55                                  * Chargement des pages depuis la d>>
     56                                  **********************************>>
     57                            
     58  3     630E CC   0004            LDD #$0004
     59  6     6311 FD   620A            STD DK_piste
     60  2     6314 86   01              LDA #$01
     61  5     6316 B7   620F            STA DK_secteur
     62  3     6319 CC   DF00            LDD #$DF00
     63  6     631C FD   622C            STD DK_dernier_bloc_a_ecrire
     64                            
     65        631F               LDPAGE_LOOP
     66  2     631F C6   04              LDB #$04
     67  5     6321 F7   E7E5            STB $E7E5 * Selection de la page e>>
     68                            
     69  2     6324 86   01              LDA #$01
     70  5     6326 B7   620F            STA DK_secteur
     71  3     6329 CC   A000            LDD #$A000
     72  6     632C FD   6213            STD DK_destination
     73  8     632F BD   6205            JSR DK_lecture
     74                            
     75                                  * Duplication de la page p en p+1
     76                                  *********************************
     77        6332               CPPAGE_LOOP
     78  2     6332 C6   65              LDB #$65                       * O>>
     79  5     6334 F7   E7E6            STB $E7E6                      * e>>
     80
     81  3     6337 CE   A000         LDU #$A000                     * Sour>>
     82  4     633A 108E 4040         LDY #$4000+64                  * Dest>>
     83  7     633E 10BF 6500            STY MEM_COPY_DATA_TO_CART_E+2
     84  4     6342 108E 2040         LDY #$2000+64                  * Dest>>
     85  8     6346 BD   6418         JSR MEM_COPY_DATA_TO_CART      * Copi>>
     86                            
     87  3     6349 CE   C000         LDU #$C000                     * Sour>>
     88  4     634C 108E 2040         LDY #$2000+64                  * Dest>>
     89  7     6350 10BF 6500            STY MEM_COPY_DATA_TO_CART_E+2
     90  4     6354 108E 0040         LDY #$0000+64                  * Dest>>
     91  8     6358 BD   6418         JSR MEM_COPY_DATA_TO_CART      * Copi>>
     92                            
     93  7     635B 7C   6333         INC CPPAGE_LOOP+1
     94  7     635E 7C   6333            INC CPPAGE_LOOP+1
     95  7     6361 7C   6320            INC LDPAGE_LOOP+1
     96  7     6364 7C   6320            INC LDPAGE_LOOP+1
     97  5     6367 F6   6320            LDB LDPAGE_LOOP+1
     98  2     636A C1   16              CMPB #$16
     99  3     636C 23   B1              BLS LDPAGE_LOOP
    100                            
    101                           *****************************************>>
    102                           * Initialisation de la routine de commuta>>
    103                           *****************************************>>
    104        636E               INIT_VID
    105  5     636E F6   6081            LDB $6081 * A documenter
    106  2     6371 CA   10              ORB #$10  * mettre le bit d4 a 1
    107  5     6373 F7   6081            STB $6081
    108  5     6376 F7   E7E7            STB $E7E7
    109  8     6379 BD   63E8            JSR SCRC     * page 2 en RAM Carto>>
    110  8     637C BD   650B            JSR CLR_CART * effacement page 2
    111  8     637F BD   63E8            JSR SCRC     * page 0 en RAM Carto>>
    112  8     6382 BD   650B            JSR CLR_CART * effacement page 0
    113  8     6385 BD   63E8            JSR SCRC     * page 2 en RAM Carto>>
    114
    115                           *****************************************>>
    116                           * Initialisation du mode video
    117                           *****************************************>>
    118  2     6388 86   7B              LDA #$7B      * passage en mode 16>>
    119  5     638A B7   E7DC            STA $E7DC
    120
    121                           *****************************************>>
    122                           * Initialisation de la palette de couleur>>
    123                           *****************************************>>
    124  4     638D 108E 6547            LDY #TABPALETTE
    125  2     6391 4F                   CLRA
    126        6392               SETPALETTE
    127  5+1   6392 34   02              PSHS A
    128  2     6394 48                   ASLA
    129  5     6395 B7   E7DB            STA $E7DB
    130  5+3   6398 EC   A1              LDD ,Y++
    131  5     639A F7   E7DA            STB $E7DA
    132  5     639D B7   E7DA            STA $E7DA
    133  5+1   63A0 35   02              PULS A
    134  2     63A2 4C                   INCA
    135  5     63A3 108C 6567            CMPY #FINTABPALETTE
    136  3     63A7 26   E9              BNE    SETPALETTE
    137
    138                           *****************************************>>
    139                           * Initialisation des sprites
    140                           *****************************************>>
    141  3     63A9 8E   67D3            LDX #HERO_IDLE_R
    142  8     63AC BD   66F6            JSR HERO_ANIMATION_LOAD
    143
    144                           *****************************************>>
    145                           * Boucle principale
    146                           *****************************************>>
    147                                  * Init routine effacement sprite
    148  5     63AF F6   68EC            LDB HERO_ANIMATION_PAG            >>
    149  5     63B2 F7   E7E5            STB $E7E5                         >>
    150  7+3   63B5 AD   9F 68EF         JSR [HERO_ANIMATION_DRW]          >>
    151  8     63B9 BD   63E8            JSR SCRC
    152  5     63BC F6   68EC            LDB HERO_ANIMATION_PAG            >>
    153  5     63BF F7   E7E5            STB $E7E5                         >>
    154  7+3   63C2 AD   9F 68EF         JSR [HERO_ANIMATION_DRW]          >>
    155  8     63C6 BD   63E8            JSR SCRC
    156                            
    157        63C9               MAIN
    158                                  * Effacement et affichage des spri>>
    159  5     63C9 F6   68EC            LDB HERO_ANIMATION_PAG            >>
    160  5     63CC F7   E7E5            STB $E7E5                         >>
    161  7+3   63CF AD   9F 68ED         JSR [HERO_ANIMATION_DEL]          >>
    162  7+3   63D3 AD   9F 68EF         JSR [HERO_ANIMATION_DRW]          >>
    163
    164                                  * Gestion des deplacements
    165  8     63D7 BD   6567            JSR JOY_READ
    166  8     63DA BD   6581            JSR Hero_Move
    167  8     63DD BD   66BD            JSR Compute_Position
    168                            
    169  8     63E0 BD   674C            JSR HERO_ANIMATION_NEXT
    170
    171  8     63E3 BD   63E8            JSR SCRC                          >>
    172  3     63E6 20   E1              BRA MAIN
    173
    174                           *****************************************>>
    175                           * Changement de page ESPACE ECRAN (affich>>
    176                           *      $E7DD determine la page affichee d>>
    177                           *      D7=0 D6=0 D5=0 D4=0 (#$0_) : page >>
    178                           *      D7=0 D6=1 D5=0 D4=0 (#$4_) : page >>
    179                           *      D7=1 D6=0 D5=0 D4=0 (#$8_) : page >>
    180                           *      D7=1 D6=1 D5=0 D4=0 (#$C_) : page >>
    181                           *   D3 D2 D1 D0  (#$_0 a #$_F) : couleur >>
    182                           *   Remarque : D5 et D4 utilisable unique>>
    183                           *
    184                           * Changement de page ESPACE CARTOUCHE (ec>>
    185                           *      $E7E6 determine la page affichee d>>
    186                           *   D5 : 1 = espace cartouche recouvert p>>
    187                           *   D4 : 0 = CAS1N valide : banques 0-15 >>
    188                           *      D5=1 D4=0 D3=0 D2=0 D1=0 D0=0 (#$6>>
    189                           *   ...
    190                           *      D5=1 D4=0 D3=1 D2=1 D1=1 D0=1 (#$6>>
    191                           *      D5=1 D4=1 D3=0 D2=0 D1=0 D0=0 (#$7>>
    192                           *   ...
    193                           *      D5=1 D4=1 D3=1 D2=1 D1=1 D0=1 (#$7>>
    194                           *****************************************>>
    195        63E8               SCRC
    196  8     63E8 BD   640D            JSR VSYNC
    197
    198  5     63EB F6   6404            LDB SCRC0+1
    199  2     63EE C4   01              ANDB #$01
    200  5     63F0 FB   68EC            ADDB HERO_ANIMATION_PAG
    201  5     63F3 F7   68EC            STB HERO_ANIMATION_PAG
    202                            
    203  5     63F6 F6   6404            LDB SCRC0+1   * charge la valeur d>>
    204  2     63F9 C4   80              ANDB #$80     * permute #$00 ou #$>>
    205  2     63FB CA   00              ORB #$00      * recharger la coule>>
    206  5     63FD F7   E7DD            STB $E7DD     * changement page da>>
    207  7     6400 73   6404            COM SCRC0+1   * modification du co>>
    208        6403               SCRC0
    209  2     6403 C6   00              LDB #$00
    210  2     6405 C4   02              ANDB #$02     * permute #$60 ou #$>>
    211  2     6407 CA   60              ORB #$60      * espace cartouche r>>
    212  5     6409 F7   E7E6            STB $E7E6     * changement page da>>
    213  5     640C 39                   RTS                  * E7E6 D5=1 p>>
    214                                                       * CAS1N : ban>>
    215
    216                           *****************************************>>
    217                           * Attente VBL
    218                           *****************************************>>
    219        640D               VSYNC
    220        640D               VSYNC_1
    221  7     640D 7D   E7E7            TST    $E7E7
    222  3     6410 2A   FB              BPL    VSYNC_1
    223        6412               VSYNC_2
    224  7     6412 7D   E7E7            TST    $E7E7
    225  3     6415 2B   FB              BMI    VSYNC_2
    226  5     6417 39                   RTS
    227
    228                           *****************************************>>
    229                           * Copie Memoire de la zone donnee vers ca>>
    230                           * Cycles en fonction de l'implementation
    231                           * 256 octets (-128 a 127) x 64  boucles (>>
    232                           * 128 octets (-64  a 63)  x 128 boucles (>>
    233                           * 32  octets (-16  a 15)  x 512 boucles (>>
    234                           *****************************************>>
    235                           *MEM_COPY_DATA_TO_CART
    236                           *   PULS X,U
    237                           *   STX       -128,Y
    238                           *   STU       -126,Y
    239                           *   PULS      D,X,U
    240                           *   STD       -124,Y
    241                           *   STX       -122,Y
    242                           *   STU       -120,Y
    243                           *   PULS      D,X,U
    244                           *   STD       -118,Y
    245                           *   STX       -116,Y
    246                           *   STU       -114,Y
    247                           *   PULS      D,X,U
    248                           *   STD       -112,Y
    249                           *   STX       -110,Y
    250                           *   STU       -108,Y
    251                           *   PULS      D,X,U
    252                           *   STD       -106,Y
    253                           *   STX       -104,Y
    254                           *   STU       -102,Y
    255                           *   PULS      D,X,U
    256                           *   STD       -100,Y
    257                           *   STX       -98,Y
    258                           *   STU       -96,Y
    259                           *   PULS      D,X,U
    260                           *   STD       -94,Y
    261                           *   STX       -92,Y
    262                           *   STU       -90,Y
    263                           *   PULS      D,X,U
    264                           *   STD       -88,Y
    265                           *   STX       -86,Y
    266                           *   STU       -84,Y
    267                           *   PULS      D,X,U
    268                           *   STD       -82,Y
    269                           *   STX       -80,Y
    270                           *   STU       -78,Y
    271                           *   PULS      D,X,U
    272                           *   STD       -76,Y
    273                           *   STX       -74,Y
    274                           *   STU       -72,Y
    275                           *   PULS      D,X,U
    276                           *   STD       -70,Y
    277                           *   STX       -68,Y
    278                           *   STU       -66,Y
    279                           *   PULS      D,X,U
    280                           *   STD       -64,Y
    281                           *   STX       -62,Y
    282                           *   STU       -60,Y
    283                           *   PULS      D,X,U
    284                           *   STD       -58,Y
    285                           *   STX       -56,Y
    286                           *   STU       -54,Y
    287                           *   PULS      D,X,U
    288                           *   STD       -52,Y
    289                           *   STX       -50,Y
    290                           *   STU       -48,Y
    291                           *   PULS      D,X,U
    292                           *   STD       -46,Y
    293                           *   STX       -44,Y
    294                           *   STU       -42,Y
    295                           *   PULS      D,X,U
    296                           *   STD       -40,Y
    297                           *   STX       -38,Y
    298                           *   STU       -36,Y
    299                           *   PULS      D,X,U
    300                           *   STD       -34,Y
    301                           *   STX       -32,Y
    302                           *   STU       -30,Y
    303                           *   PULS      D,X,U
    304                           *   STD       -28,Y
    305                           *   STX       -26,Y
    306                           *   STU       -24,Y
    307                           *   PULS      D,X,U
    308                           *   STD       -22,Y
    309                           *   STX       -20,Y
    310                           *   STU       -18,Y
    311                           *   PULS      D,X,U
    312                           *   STD       -16,Y
    313                           *   STX       -14,Y
    314                           *   STU       -12,Y
    315                           *   PULS      D,X,U
    316                           *   STD       -10,Y
    317                           *   STX       -8,Y
    318                           *   STU       -6,Y
    319                           *   PULS      D,X,U
    320                           *   STD       -4,Y
    321                           *   STX       -2,Y
    322                           *   STU       ,Y
    323                           *   PULS      D,X,U
    324                           *   STD       2,Y
    325                           *   STX       4,Y
    326                           *   STU       6,Y
    327                           *   PULS      D,X,U
    328                           *   STD       8,Y
    329                           *   STX       10,Y
    330                           *   STU       12,Y
    331                           *   PULS      D,X,U
    332                           *   STD       14,Y
    333                           *   STX       16,Y
    334                           *   STU       18,Y
    335                           *   PULS      D,X,U
    336                           *   STD       20,Y
    337                           *   STX       22,Y
    338                           *   STU       24,Y
    339                           *   PULS      D,X,U
    340                           *   STD       26,Y
    341                           *   STX       28,Y
    342                           *   STU       30,Y
    343                           *   PULS      D,X,U
    344                           *   STD       32,Y
    345                           *   STX       34,Y
    346                           *   STU       36,Y
    347                           *   PULS      D,X,U
    348                           *   STD       38,Y
    349                           *   STX       40,Y
    350                           *   STU       42,Y
    351                           *   PULS      D,X,U
    352                           *   STD       44,Y
    353                           *   STX       46,Y
    354                           *   STU       48,Y
    355                           *   PULS      D,X,U
    356                           *   STD       50,Y
    357                           *   STX       52,Y
    358                           *   STU       54,Y
    359                           *   PULS      D,X,U
    360                           *   STD       56,Y
    361                           *   STX       58,Y
    362                           *   STU       60,Y
    363                           *   PULS      D,X,U
    364                           *   STD       62,Y
    365                           *   STX       64,Y
    366                           *   STU       66,Y
    367                           *   PULS      D,X,U
    368                           *   STD       68,Y
    369                           *   STX       70,Y
    370                           *   STU       72,Y
    371                           *   PULS      D,X,U
    372                           *   STD       74,Y
    373                           *   STX       76,Y
    374                           *   STU       78,Y
    375                           *   PULS      D,X,U
    376                           *   STD       80,Y
    377                           *   STX       82,Y
    378                           *   STU       84,Y
    379                           *   PULS      D,X,U
    380                           *   STD       86,Y
    381                           *   STX       88,Y
    382                           *   STU       90,Y
    383                           *   PULS      D,X,U
    384                           *   STD       92,Y
    385                           *   STX       94,Y
    386                           *   STU       96,Y
    387                           *   PULS      D,X,U
    388                           *   STD       98,Y
    389                           *   STX       100,Y
    390                           *   STU       102,Y
    391                           *   PULS      D,X,U
    392                           *   STD       104,Y
    393                           *   STX       106,Y
    394                           *   STU       108,Y
    395                           *   PULS      D,X,U
    396                           *   STD       110,Y
    397                           *   STX       112,Y
    398                           *   STU       114,Y
    399                           *   PULS      D,X,U
    400                           *   STD       116,Y
    401                           *   STX       118,Y
    402                           *   STU       120,Y
    403                           *   PULS      D,X,U
    404                           *   STD       122,Y
    405                           *   STX       124,Y
    406                           *   STU       126,Y
    407                           *   LEAY 256,Y
    408                           *MEM_COPY_DATA_TO_CART_E
    409                           *   CMPY    #$0180
    410                           *   LBNE     MEM_COPY_DATA_TO_CART
    411                           *MEM_COPY_DATA_TO_CART_S
    412                           *   LDS     #$0000    * Rechargement du p>>
    413                           *   RTS
    414                            
    415        6418               MEM_COPY_DATA_TO_CART
    416  7     6418 10FF 6508        STS MEM_COPY_DATA_TO_CART_S+2  * sauve>>
    417  6     641C 1F   34          TFR U,S
    418        641E               MEM_COPY_DATA_TO_CART_LOOP
    419  5+6   641E 35   56          PULS       D,X,U
    420  5+1   6420 ED   A8 C0       STD -64,Y
    421  5+1   6423 AF   A8 C2       STX -62,Y
    422  5+1   6426 EF   A8 C4       STU -60,Y
    423  5+6   6429 35   56          PULS       D,X,U
    424  5+1   642B ED   A8 C6       STD -58,Y
    425  5+1   642E AF   A8 C8       STX -56,Y
    426  5+1   6431 EF   A8 CA       STU -54,Y
    427  5+6   6434 35   56          PULS       D,X,U
    428  5+1   6436 ED   A8 CC       STD -52,Y
    429  5+1   6439 AF   A8 CE       STX -50,Y
    430  5+1   643C EF   A8 D0       STU -48,Y
    431  5+6   643F 35   56          PULS       D,X,U
    432  5+1   6441 ED   A8 D2       STD -46,Y
    433  5+1   6444 AF   A8 D4       STX -44,Y
    434  5+1   6447 EF   A8 D6       STU -42,Y
    435  5+6   644A 35   56          PULS       D,X,U
    436  5+1   644C ED   A8 D8       STD -40,Y
    437  5+1   644F AF   A8 DA       STX -38,Y
    438  5+1   6452 EF   A8 DC       STU -36,Y
    439  5+6   6455 35   56          PULS       D,X,U
    440  5+1   6457 ED   A8 DE       STD -34,Y
    441  5+1   645A AF   A8 E0       STX -32,Y
    442  5+1   645D EF   A8 E2       STU -30,Y
    443  5+6   6460 35   56          PULS       D,X,U
    444  5+1   6462 ED   A8 E4       STD -28,Y
    445  5+1   6465 AF   A8 E6       STX -26,Y
    446  5+1   6468 EF   A8 E8       STU -24,Y
    447  5+6   646B 35   56          PULS       D,X,U
    448  5+1   646D ED   A8 EA       STD -22,Y
    449  5+1   6470 AF   A8 EC       STX -20,Y
    450  5+1   6473 EF   A8 EE       STU -18,Y
    451  5+6   6476 35   56          PULS       D,X,U
    452  5+1   6478 ED   30          STD -16,Y
    453  5+1   647A AF   32          STX -14,Y
    454  5+1   647C EF   34          STU -12,Y
    455  5+6   647E 35   56          PULS       D,X,U
    456  5+1   6480 ED   36          STD -10,Y
    457  5+1   6482 AF   38          STX -8,Y
    458  5+1   6484 EF   3A          STU -6,Y
    459  5+6   6486 35   56          PULS       D,X,U
    460  5+1   6488 ED   3C          STD -4,Y
    461  5+1   648A AF   3E          STX -2,Y
    462  5+0   648C EF   A4          STU ,Y
    463  5+6   648E 35   56          PULS       D,X,U
    464  5+1   6490 ED   22          STD 2,Y
    465  5+1   6492 AF   24          STX 4,Y
    466  5+1   6494 EF   26          STU 6,Y
    467  5+6   6496 35   56          PULS       D,X,U
    468  5+1   6498 ED   28          STD 8,Y
    469  5+1   649A AF   2A          STX 10,Y
    470  5+1   649C EF   2C          STU 12,Y
    471  5+6   649E 35   56          PULS       D,X,U
    472  5+1   64A0 ED   2E          STD 14,Y
    473  5+1   64A2 AF   A8 10       STX 16,Y
    474  5+1   64A5 EF   A8 12       STU 18,Y
    475  5+6   64A8 35   56          PULS       D,X,U
    476  5+1   64AA ED   A8 14       STD 20,Y
    477  5+1   64AD AF   A8 16       STX 22,Y
    478  5+1   64B0 EF   A8 18       STU 24,Y
    479  5+6   64B3 35   56          PULS       D,X,U
    480  5+1   64B5 ED   A8 1A       STD 26,Y
    481  5+1   64B8 AF   A8 1C       STX 28,Y
    482  5+1   64BB EF   A8 1E       STU 30,Y
    483  5+6   64BE 35   56          PULS       D,X,U
    484  5+1   64C0 ED   A8 20       STD 32,Y
    485  5+1   64C3 AF   A8 22       STX 34,Y
    486  5+1   64C6 EF   A8 24       STU 36,Y
    487  5+6   64C9 35   56          PULS       D,X,U
    488  5+1   64CB ED   A8 26       STD 38,Y
    489  5+1   64CE AF   A8 28       STX 40,Y
    490  5+1   64D1 EF   A8 2A       STU 42,Y
    491  5+6   64D4 35   56          PULS       D,X,U
    492  5+1   64D6 ED   A8 2C       STD 44,Y
    493  5+1   64D9 AF   A8 2E       STX 46,Y
    494  5+1   64DC EF   A8 30       STU 48,Y
    495  5+6   64DF 35   56          PULS       D,X,U
    496  5+1   64E1 ED   A8 32       STD 50,Y
    497  5+1   64E4 AF   A8 34       STX 52,Y
    498  5+1   64E7 EF   A8 36       STU 54,Y
    499  5+6   64EA 35   56          PULS       D,X,U
    500  5+1   64EC ED   A8 38       STD 56,Y
    501  5+1   64EF AF   A8 3A       STX 58,Y
    502  5+1   64F2 EF   A8 3C       STU 60,Y
    503  5+2   64F5 35   06          PULS       D
    504  5+1   64F7 ED   A8 3E       STD 62,Y
    505  4+4   64FA 31   A9 0080     LEAY 128,Y
    506        64FE               MEM_COPY_DATA_TO_CART_E
    507  5     64FE 108C 00C0        CMPY    #$00C0
    508  6     6502 1026 FF18        LBNE    MEM_COPY_DATA_TO_CART_LOOP
    509        6506               MEM_COPY_DATA_TO_CART_S
    510  4     6506 10CE 0000        LDS     #$0000    * Rechargement du po>>
    511  5     650A 39               RTS
    512
    513                           *MEM_COPY_DATA_TO_CART
    514                           *   PULS    D,X,U
    515                           *   STD     -16,Y
    516                           *   STX     -14,Y
    517                           *   STU     -12,Y
    518                           *   PULS    D,X,U
    519                           *   STD     -10,Y
    520                           *   STX     -8,Y
    521                           *   STU     -6,Y
    522                           *   PULS    D,X,U
    523                           *   STD     -4,Y
    524                           *   STX     -2,Y
    525                           *   STU     ,Y
    526                           *   PULS    D,X,U
    527                           *   STD     2,Y
    528                           *   STX     4,Y
    529                           *   STU     6,Y
    530                           *   PULS    D,X
    531                           *   STD     8,Y
    532                           *   STX     10,Y
    533                           *   PULS    D,X
    534                           *   STD     12,Y
    535                           *   STX     14,Y
    536                           *   LEAY    32,Y
    537                           *MEM_COPY_DATA_TO_CART_E
    538                           *   CMPY    #$0030
    539                           *   BNE     MEM_COPY_DATA_TO_CART
    540                           *MEM_COPY_DATA_TO_CART_S
    541                           *   LDS     #$0000    * Rechargement du p>>
    542                           *   RTS
    543                           *****************************************>>
    544                           * Effacement memoire Cartouche (27000 cy)>>
    545                           *****************************************>>
    546        650B               CLR_CART
    547  5+3   650B 34   48           PSHS U,DP
    548  7     650D 10FF 6542         STS CLR_CART_3+2
    549  4     6511 10CE 4000         LDS #$4000
    550  3     6515 CE   0000         LDU #$0000
    551  4     6518 108E 0000         LDY #$0000
    552  3     651C 8E   0000         LDX #$0000
    553  3     651F CC   0000         LDD #$0000
    554  6     6522 1F   8B           TFR A,DP
    555        6524               CLR_CART_2
    556  5+9   6524 34   7E           PSHS U,Y,X,DP,B,A
    557  5+9   6526 34   7E           PSHS U,Y,X,DP,B,A
    558  5+9   6528 34   7E           PSHS U,Y,X,DP,B,A
    559  5+9   652A 34   7E           PSHS U,Y,X,DP,B,A
    560  5+9   652C 34   7E           PSHS U,Y,X,DP,B,A
    561  5+9   652E 34   7E           PSHS U,Y,X,DP,B,A
    562  5+9   6530 34   7E           PSHS U,Y,X,DP,B,A
    563  5+9   6532 34   7E           PSHS U,Y,X,DP,B,A
    564  5+9   6534 34   7E           PSHS U,Y,X,DP,B,A
    565  5+9   6536 34   7E           PSHS U,Y,X,DP,B,A
    566  5     6538 118C 0004         CMPS #$0004
    567  3     653C 26   E6           BNE CLR_CART_2
    568  5+4   653E 34   60           PSHS U,Y
    569        6540               CLR_CART_3
    570  4     6540 10CE 0000         LDS #$0000
    571  5+3   6544 35   48           PULS DP,U
    572  5     6546 39                RTS
    573                            
    574                           *****************************************>>
    575                           * Affichage de l arriere plan 57900 cycle>>
    576                           *****************************************>>
    577                           *DRAW_RAM_DATA_TO_CART_160x200
    578                           *      PSHS U,DP            * sauvegarde >>
    579                           *      STS DRAW_RAM_DATA_TO_CART_160x200A>>
    580                           *
    581                           *      LDS #FINECRANA       * init pointe>>
    582                           *      LDU #$A000
    583                           *
    584                           *DRAW_RAM_DATA_TO_CART_160x200A
    585                           *      PULU A,B,DP,X,Y
    586                           *      PSHS Y,X,DP,B,A
    587                           *      PULU A,B,DP,X,Y
    588                           *      PSHS Y,X,DP,B,A
    589                           *      PULU A,B,DP,X,Y
    590                           *      PSHS Y,X,DP,B,A
    591                           *      PULU A,B,DP,X,Y
    592                           *      PSHS Y,X,DP,B,A
    593                           *      PULU A,B,DP,X,Y
    594                           *      PSHS Y,X,DP,B,A
    595                           *      PULU A,B,DP,X,Y
    596                           *      PSHS Y,X,DP,B,A
    597                           *      CMPS #DEBUTECRANA
    598                           *      BNE DRAW_RAM_DATA_TO_CART_160x200A>>
    599                           *      PULU A,B,DP,X,Y
    600                           *      PSHS Y,X,DP,B,A
    601                           *      PULU A,B,DP,X,Y
    602                           *      PSHS Y,X,DP,B,A
    603                           *      PULU B,DP,X,Y
    604                           *      PSHS Y,X,DP,B
    605                           *
    606                           *      LDS #FINECRANB       * init pointe>>
    607                           *      LDU #$C000
    608                           *
    609                           *DRAW_RAM_DATA_TO_CART_160x200B
    610                           *      PULU A,B,DP,X,Y
    611                           *      PSHS Y,X,DP,B,A
    612                           *      PULU A,B,DP,X,Y
    613                           *      PSHS Y,X,DP,B,A
    614                           *      PULU A,B,DP,X,Y
    615                           *      PSHS Y,X,DP,B,A
    616                           *      PULU A,B,DP,X,Y
    617                           *      PSHS Y,X,DP,B,A
    618                           *      PULU A,B,DP,X,Y
    619                           *      PSHS Y,X,DP,B,A
    620                           *      PULU A,B,DP,X,Y
    621                           *      PSHS Y,X,DP,B,A
    622                           *      CMPS #DEBUTECRANB
    623                           *      BNE DRAW_RAM_DATA_TO_CART_160x200B>>
    624                           *      PULU A,B,DP,X,Y
    625                           *      PSHS Y,X,DP,B,A
    626                           *      PULU A,B,DP,X,Y
    627                           *      PSHS Y,X,DP,B,A
    628                           *      PULU B,DP,X,Y
    629                           *      PSHS Y,X,DP,B
    630                           *DRAW_RAM_DATA_TO_CART_160x200A_E
    631                           *      LDS  #$0000 * rechargement des reg>>
    632                           *      PULS U,DP
    633                           *      RTS
    634
    635                           *****************************************>>
    636                           * Palette de 16 couleurs
    637                           *****************************************>>
    638        6547               TABPALETTE
    639        6547 0CCD                 FDB $0ccd     * index:0  R:244 V:2>>
    640        6549 0BA4                 FDB $0ba4     * index:1  R:164 V:2>>
    641        654B 035D                 FDB $035d     * index:2  R:244 V:1>>
    642        654D 0D81                 FDB $0d81     * index:3  R:108 V:2>>
    643        654F 013B                 FDB $013b     * index:4  R:228 V:1>>
    644        6551 0541                 FDB $0541     * index:5  R:100 V:1>>
    645        6553 0D30                 FDB $0d30     * index:6  R:43  V:1>>
    646        6555 0017                 FDB $0017     * index:7  R:196 V:1>>
    647        6557 000B                 FDB $000b     * index:8  R:228 V:2>>
    648        6559 0D10                 FDB $0d10     * index:9  R:4   V:1>>
    649        655B 0110                 FDB $0110     * index:10 R:28  V:9>>
    650        655D 0003                 FDB $0003     * index:11 R:148 V:2>>
    651        655F 0700                 FDB $0700     * index:12 R:4   V:5>>
    652        6561 0200                 FDB $0200     * index:13 R:4   V:2>>
    653        6563 0000                 FDB $0000     * index:14 R:68  V:2>>
    654        6565 0000                 FDB $0000     * index:15 R:4   V:2>>
    655        6567               FINTABPALETTE
    656
    657                           *****************************************>>
    658                           * Get joystick parameters
    659                           *****************************************>>
    660        6567               JOY_READ
    661  3     6567 8E   E7CF            ldx    #$e7cf
    662  4     656A 108E E7CD            ldy    #$e7cd
    663  3     656E CC   400F            ldd    #$400f
    664  5     6571 F4   E7CC            andb   >$e7cc     * Read position
    665  5     6574 F7   657F            stb    JOY_DIR_STATUS
    666  4+0   6577 A4   A4              anda   ,y         * Read button
    667  2     6579 88   40              eora   #$40
    668  5     657B B7   6580            sta    JOY_BTN_STATUS
    669  5     657E 39                   RTS
    670        657F               JOY_DIR_STATUS
    671        657F 00                   FCB $00 * Position Pad
    672        6580               JOY_BTN_STATUS
    673        6580 00                   FCB $00 * 40 Bouton A enfonce
    674
    675                           *****************************************>>
    676                           * Subroutine to      make HERO walk/run
    677                           *****************************************>>
    678        6581               Hero_Move
    679  5     6581 B6   657F            LDA JOY_DIR_STATUS
    680  2     6584 81   0B              CMPA #JOY_G
    681  3     6586 26   02              BNE Hero_NotLeft
    682  3     6588 20   69              BRA Hero_MoveLeft
    683
    684        658A               Hero_NotLeft                   * XREF: He>>
    685  2     658A 81   07              CMPA #JOY_D
    686  3     658C 26   03              BNE Hero_NotLeftOrRight
    687  5     658E 16   00A6            LBRA Hero_MoveRight
    688
    689        6591               Hero_NotLeftOrRight            * XREF: He>>
    690  6     6591 FC   68D4            LDD HERO_G_SPEED
    691  5     6594 1083 0000            CMPD #$0000
    692  3     6598 2D   2E              BLT Hero_NotLeftOrRight_00 * se de>>
    693  7     659A B3   68E6            SUBD HERO_FRICTION     * se deplac>>
    694  3     659D 24   12              BCC Hero_NotLeftOrRight_01 * si on>>
    695  3     659F CC   0000            LDD #$0000
    696  6     65A2 FD   68D4            STD HERO_G_SPEED
    697  6     65A5 FD   68D8            STD HERO_X_SPS
    698  3     65A8 8E   67D3            LDX #HERO_IDLE_R        * Charge a>>
    699  6     65AB BF   68E8            STX HERO_ANIMATION_ADR      * Sauv>>
    700  5     65AE 16   00C4            LBRA Hero_MoveUpdatePos
    701        65B1               Hero_NotLeftOrRight_01
    702  5     65B1 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    703  3     65B5 2C   0B              BGE Hero_NotLeftOrRight_02
    704  6     65B7 FD   68D4            STD HERO_G_SPEED
    705  3     65BA 8E   6790            LDX #HERO_WALK_R        * Charge a>>
    706  6     65BD BF   68E8            STX HERO_ANIMATION_ADR      * Sauv>>
    707  3     65C0 20   03              BRA Hero_NotLeftOrRight_03
    708        65C2               Hero_NotLeftOrRight_02
    709  6     65C2 FD   68D4            STD HERO_G_SPEED
    710        65C5               Hero_NotLeftOrRight_03
    711  5     65C5 16   00AD            LBRA Hero_MoveUpdatePos
    712        65C8               Hero_NotLeftOrRight_00
    713  7     65C8 F3   68E6            ADDD HERO_FRICTION     * se deplac>>
    714  3     65CB 24   0F              BCC Hero_NotLeftOrRight_11 * si on>>
    715  3     65CD CC   0000            LDD #$0000
    716  6     65D0 FD   68D4            STD HERO_G_SPEED
    717  3     65D3 8E   68C8            LDX #HERO_IDLE_L        * Charge a>>
    718  6     65D6 BF   68E8            STX HERO_ANIMATION_ADR      * Sauv>>
    719  5     65D9 16   0099            LBRA Hero_MoveUpdatePos
    720        65DC               Hero_NotLeftOrRight_11
    721  5     65DC 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    722  3     65E0 2F   0B              BLE Hero_NotLeftOrRight_12
    723  6     65E2 FD   68D4            STD HERO_G_SPEED
    724  3     65E5 8E   6818            LDX #HERO_WALK_L        * Charge a>>
    725  6     65E8 BF   68E8            STX HERO_ANIMATION_ADR      * Sauv>>
    726  3     65EB 20   03              BRA Hero_NotLeftOrRight_13
    727        65ED               Hero_NotLeftOrRight_12
    728  6     65ED FD   68D4            STD HERO_G_SPEED
    729        65F0               Hero_NotLeftOrRight_13
    730  5     65F0 16   0082            LBRA Hero_MoveUpdatePos
    731
    732        65F3               Hero_MoveLeft                      * XREF>>
    733  6     65F3 FC   68D4            LDD HERO_G_SPEED            * Char>>
    734  5     65F6 1083 0000            CMPD #$0000                 * Test>>
    735  3     65FA 2F   11              BLE Hero_MoveLeft_00        * BRAN>>
    736  7     65FC B3   68E4            SUBD HERO_DECELERATION      * orie>>
    737  3     65FF 24   06              BCC Hero_MoveLeft_03        * BRAN>>
    738  3     6601 CC   0000            LDD #$0000
    739  7     6604 B3   68E4            SUBD HERO_DECELERATION      * si l>>
    740        6607               Hero_MoveLeft_03
    741  6     6607 FD   68D4            STD HERO_G_SPEED            * On s>>
    742  5     660A 16   0068            LBRA Hero_MoveUpdatePos           >>
    743        660D               Hero_MoveLeft_00                         >>
    744                           *      CMPD #$0000                       >>
    745                           *      BNE Hero_MoveLeft_02        * BRAN>>
    746                           *      LDD #$FEFF                        >>
    747                           *Hero_MoveLeft_02
    748  8     660D 10B3 68E0            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    749  3     6611 27   62              BEQ Hero_MoveUpdatePos      * vite>>
    750  7     6613 B3   68E2            SUBD HERO_ACCELERATION      * acce>>
    751  8     6616 10B3 68E0            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    752  3     661A 2E   0F              BGT Hero_MoveLeft_01        * BRAN>>
    753  3     661C 8E   685B            LDX #HERO_RUN_L        * Charge an>>
    754  6     661F BF   68E8            STX HERO_ANIMATION_ADR      * Sauv>>
    755  6     6622 FC   68E0            LDD HERO_NEG_TOP_SPEED      * Limi>>
    756  6     6625 FD   68D4            STD HERO_G_SPEED            * Enre>>
    757  5     6628 16   004A            LBRA Hero_MoveUpdatePos     * Mise>>
    758        662B               Hero_MoveLeft_01
    759  6     662B FD   68D4            STD HERO_G_SPEED            * Enre>>
    760  3     662E 8E   6818            LDX #HERO_WALK_L        * Charge a>>
    761  6     6631 BF   68E8            STX HERO_ANIMATION_ADR      * Sauv>>
    762  5     6634 16   003E            LBRA Hero_MoveUpdatePos
    763
    764        6637               Hero_MoveRight                  * XREF: H>>
    765  6     6637 FC   68D4            LDD HERO_G_SPEED        * Chargeme>>
    766  5     663A 1083 0000            CMPD #$0000                 * Test>>
    767  3     663E 2C   0E              BGE Hero_MoveRight_00       * BRAN>>
    768  7     6640 F3   68E4            ADDD HERO_DECELERATION      * orie>>
    769  3     6643 24   03              BCC Hero_MoveRight_03       * BRAN>>
    770  6     6645 FC   68E4            LDD HERO_DECELERATION   * si la vi>>
    771        6648               Hero_MoveRight_03
    772  6     6648 FD   68D4            STD HERO_G_SPEED        * On stock>>
    773  5     664B 16   0027            LBRA Hero_MoveUpdatePos           >>
    774        664E               Hero_MoveRight_00                  * Orie>>
    775                           *      CMPD #$0000                       >>
    776                           *      BNE Hero_MoveRight_02       * BRAN>>
    777                           *      LDD #$0100                        >>
    778                           *Hero_MoveRight_02
    779  8     664E 10B3 68DE            CMPD HERO_TOP_SPEED         * Comp>>
    780  3     6652 27   21              BEQ Hero_MoveUpdatePos      * vite>>
    781  7     6654 F3   68E2            ADDD HERO_ACCELERATION      * acce>>
    782  8     6657 10B3 68DE            CMPD HERO_TOP_SPEED         * Comp>>
    783  3     665B 2D   0F              BLT Hero_MoveRight_01       * BRAN>>
    784  3     665D 8E   67DF            LDX #HERO_RUN_R                   >>
    785  6     6660 BF   68E8            STX HERO_ANIMATION_ADR      * Sauv>>
    786  6     6663 FC   68DE            LDD HERO_TOP_SPEED          * Limi>>
    787  6     6666 FD   68D4            STD HERO_G_SPEED            * Enre>>
    788  5     6669 16   0009            LBRA Hero_MoveUpdatePos           >>
    789        666C               Hero_MoveRight_01
    790  6     666C FD   68D4            STD HERO_G_SPEED            * Enre>>
    791  3     666F 8E   6790            LDX #HERO_WALK_R        * Charge a>>
    792  6     6672 BF   68E8            STX HERO_ANIMATION_ADR      * Sauv>>
    793
    794        6675               Hero_MoveUpdatePos
    795  6     6675 FC   68D4            LDD HERO_G_SPEED            * Char>>
    796  6     6678 FD   68D6            STD HERO_X_SPEED        * Stockage>>
    797  5     667B 1083 0000            CMPD #$0000                 * Test>>
    798  3     667F 2D   0E              BLT Hero_MoveUpdatePos_00   * BRAN>>
    799  7     6681 F3   68D8            ADDD HERO_X_SPS         * Ajout du>>
    800  5     6684 F7   68D9            STB HERO_X_SPS+1            * sauv>>
    801  6     6687 1F   89              TFR A,B                     * Divi>>
    802  5     6689 FB   68D2            ADDB HERO_X_POS                   >>
    803  3     668C 20   18              BRA Hero_MoveUpdatePos_01
    804        668E               Hero_MoveUpdatePos_V00
    805        668E 00                   FCB $00
    806        668F               Hero_MoveUpdatePos_00
    807  3     668F CC   0000            LDD #$0000
    808  7     6692 B3   68D6            SUBD HERO_X_SPEED           * La v>>
    809  7     6695 F3   68D8            ADDD HERO_X_SPS         * Ajout du>>
    810  5     6698 F7   68D9            STB HERO_X_SPS+1            * sauv>>
    811  6     669B 1F   89              TFR A,B                     * Divi>>
    812  5     669D F7   668E            STB Hero_MoveUpdatePos_V00
    813  5     66A0 F6   68D2            LDB HERO_X_POS
    814  5     66A3 F0   668E            SUBB Hero_MoveUpdatePos_V00 * Ajou>>
    815        66A6               Hero_MoveUpdatePos_01
    816                           *      CMPB #$50                         >>
    817                           *      BLE Hero_MoveUpdatePos_02   * Bute>>
    818                           *      LDB #$50                          >>
    819                           *Hero_MoveUpdatePos_02
    820                           *    CMPB #$0C                           >>
    821                           *      BGE Hero_MoveUpdatePos_03   * Bute>>
    822                           *      LDB #$0C                          >>
    823        66A6               Hero_MoveUpdatePos_03
    824  5     66A6 F7   68D2            STB HERO_X_POS
    825  2     66A9 C6   00              LDB #$00
    826  5     66AB F7   68D8            STB HERO_X_SPS                    >>
    827  3     66AE CC   0000            LDD #$0000                  * TODO>>
    828  6     66B1 FD   68DA            STD HERO_Y_SPEED
    829  6     66B4 1F   89              TFR A,B                     * divi>>
    830  5     66B6 FB   68D3            ADDB HERO_Y_POS
    831  5     66B9 F7   68D3            STB HERO_Y_POS
    832  5     66BC 39                   RTS
    833
    834                           * TODO : Braking Animation
    835                           * Sonic enters his braking animation when>>
    836                           * In Sonic 1 and Sonic CD, he then stays >>
    837                           * In the other 3 games, Sonic returns to >>
    838
    839        66BD               Compute_Position
    840  5     66BD B6   68D2            LDA HERO_X_POS
    841  2     66C0 44                   LSRA
    842  3     66C1 25   17              BCS Compute_Position_01
    843  5     66C3 B7   66F5            STA Compute_Position_02+1
    844  2     66C6 86   28              LDA #$28
    845  5     66C8 F6   68D3            LDB HERO_Y_POS
    846  2     66CB 5A                   DECB
    847  11    66CC 3D                   MUL
    848  7     66CD F3   66F4            ADDD Compute_Position_02
    849  6     66D0 FD   9F00            STD HERO_POS
    850  4     66D3 C3   2000            ADDD #$2000
    851  6     66D6 FD   9F02            STD HERO_POS+2
    852  5     66D9 39                   RTS
    853        66DA               Compute_Position_01
    854  5     66DA B7   66F5            STA Compute_Position_02+1
    855  2     66DD 86   28              LDA #$28
    856  5     66DF F6   68D3            LDB HERO_Y_POS
    857  2     66E2 5A                   DECB
    858  11    66E3 3D                   MUL
    859  7     66E4 F3   66F4            ADDD Compute_Position_02
    860  4     66E7 C3   2000            ADDD #$2000
    861  6     66EA FD   9F00            STD HERO_POS
    862  4     66ED 83   1FFF            SUBD #$1FFF
    863  6     66F0 FD   9F02            STD HERO_POS+2
    864  5     66F3 39                   RTS
    865        66F4               Compute_Position_02
    866        66F4 0000                 FDB $0000
    867
    868                           *****************************************>>
    869                           * HERO Animations
    870                           * ---------------
    871                           * Note: Speed abs +0, rel +8, rel cap +10>>
    872                           *
    873                           * Chargement nouvelle animation
    874                           *    nouvelle frame = 109 a 119
    875                           *
    876                           * Chargement frame suivante
    877                           *    frame identique = 15
    878                           * ou frame suivante  = 116 a 126
    879                           *
    880                           * Chargement frame suivante avec branchem>>
    881                           *    nouvelle frame = 165 a 175
    882                           * ou frame suivante = 172 a 182
    883                           *
    884                           * Chargement frame suivante avec retour s>>
    885                           *    nouvelle frame = 167 a 177
    886                           * ou frame suivante = 174 a 184
    887                           *****************************************>>
    888
    889        66F6               HERO_ANIMATION_LOAD                      >>
    890  6     66F6 BF   68E8            STX HERO_ANIMATION_ADR
    891  6     66F9 BF   68EA            STX HERO_ANIMATION_RTN_ADR
    892  7     66FC 7F   68F1            CLR HERO_ANIMATION_IMC            >>
    893        66FF               HERO_ANIMATION_LOAD_00
    894  5+1   66FF EC   1E              LDD -2,X                          >>
    895  2     6701 81   00              CMPA #$00                         >>
    896  3     6703 27   07              BEQ HERO_ANIMATION_LOAD_01
    897  5     6705 F0   68D4            SUBB HERO_G_SPEED                 >>
    898  3     6708 24   02              BCC HERO_ANIMATION_LOAD_01
    899  2     670A C6   01              LDB #$01                          >>
    900        670C               HERO_ANIMATION_LOAD_01
    901  5     670C F7   68F3            STB HERO_ANIMATION_FRR            >>
    902  5     670F B6   68F1            LDA HERO_ANIMATION_IMC
    903  2     6712 C6   05              LDB #$05
    904  11    6714 3D                   MUL
    905  7     6715 F3   68E8            ADDD HERO_ANIMATION_ADR
    906  6     6718 1F   02              TFR D,Y
    907  4+0   671A E6   A4              LDB ,Y
    908  2     671C C1   1F              CMPB #$1F                         >>
    909  3     671E 22   0E              BHI HERO_ANIMATION_LOAD_NOPAGE
    910  5     6720 F7   68EC            STB HERO_ANIMATION_PAG            >>
    911  5+1   6723 AE   21              LDX 1,Y
    912  6     6725 BF   68EF            STX HERO_ANIMATION_DRW
    913  5+1   6728 AE   23              LDX 3,Y
    914  6     672A BF   68ED            STX HERO_ANIMATION_DEL
    915  5     672D 39                   RTS
    916        672E               HERO_ANIMATION_LOAD_NOPAGE
    917  2     672E C1   FF              CMPB #$FF
    918  3     6730 26   0C              BNE HERO_ANIMATION_LOAD_FE
    919  5+1   6732 AE   23              LDX 3,Y
    920  6     6734 BF   68F1            STX HERO_ANIMATION_IMC            >>
    921  5+1   6737 AE   21              LDX 1,Y
    922  6     6739 BF   68E8            STX HERO_ANIMATION_ADR
    923  3     673C 20   C1              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    924        673E               HERO_ANIMATION_LOAD_FE
    925  6     673E BE   68EA            LDX HERO_ANIMATION_RTN_ADR  * RETU>>
    926  6     6741 BF   68E8            STX HERO_ANIMATION_ADR
    927  5     6744 F6   68F2            LDB HERO_ANIMATION_RTN_IMC
    928  5     6747 F7   68F1            STB HERO_ANIMATION_IMC
    929  3     674A 20   B3              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    930
    931        674C               HERO_ANIMATION_NEXT
    932  7     674C 7A   68F3            DEC HERO_ANIMATION_FRR
    933  3     674F 27   01              BEQ HERO_ANIMATION_NEXT_00  * BRAN>>
    934  5     6751 39                   RTS
    935        6752               HERO_ANIMATION_NEXT_00
    936  7     6752 7C   68F1            INC HERO_ANIMATION_IMC
    937  6     6755 BE   68E8            LDX HERO_ANIMATION_ADR
    938  3     6758 20   A5              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    939                            
    940                           *   SAMPLE CODE ANIMATION
    941                           *      ---------------------
    942                           *      FDB $0018            * 00 Absolute>>
    943                           *HERO_IDLE_L
    944                           *      FCB $01                     * Page>>
    945                           *      FDB $A000            * Adresse drw>>
    946                           *      FDB $A000            * Adresse del>>
    947                           *
    948                           *      FCB $FF                     * FF S>>
    949                           *      FDB HERO_IDLE-C * adresse animatio>>
    950                           *      FDB $0301            * 03 image ci>>
    951                           *
    952                           *      FCB $FE                     * FE R>>
    953                           *
    954                           *      LDX #HERO_IDLE_R
    955                           *      JSR HERO_ANIMATION_LOAD
    956                           *
    957                           *      JSR HERO_ANIMATION_NEXT
    958
    959                           *****************************************>>
    960                           * ANIMATION Scripts
    961                           *****************************************>>
    962
    963
    964
    965        675A 0108                 FDB $0108
    966        675C               HERO_SKID_R
    967        675C 04                   FCB $04
    968        675D D5AB                 FDB $D5AB
    969        675F DFF4                 FDB $DFF4
    970        6761 06                   FCB $06
    971        6762 D455                 FDB $D455
    972        6764 DFDF                 FDB $DFDF
    973        6766 04                   FCB $04
    974        6767 CA37                 FDB $CA37
    975        6769 D5AB                 FDB $D5AB
    976        676B 0A                   FCB $0A
    977        676C D414                 FDB $D414
    978        676E DFF4                 FDB $DFF4
    979        6770 04                   FCB $04
    980        6771 BF4A                 FDB $BF4A
    981        6773 CA37                 FDB $CA37
    982        6775 04                   FCB $04
    983        6776 B40C                 FDB $B40C
    984        6778 BF4A                 FDB $BF4A
    985        677A 06                   FCB $06
    986        677B C904                 FDB $C904
    987        677D D455                 FDB $D455
    988        677F 04                   FCB $04
    989        6780 A8F4                 FDB $A8F4
    990        6782 B40C                 FDB $B40C
    991        6784 08                   FCB $08
    992        6785 D42E                 FDB $D42E
    993        6787 DFD9                 FDB $DFD9
    994        6789 FF                   FCB $FF
    995        678A 675C                 FDB HERO_SKID_R
    996        678C 0000                 FDB $0000
    997
    998        678E 0008                 FDB $0008
    999        6790               HERO_WALK_R
   1000        6790 04                   FCB $04
   1001        6791 A000                 FDB $A000
   1002        6793 A8F4                 FDB $A8F4
   1003        6795 06                   FCB $06
   1004        6796 BF54                 FDB $BF54
   1005        6798 C904                 FDB $C904
   1006        679A 08                   FCB $08
   1007        679B C8B9                 FDB $C8B9
   1008        679D D42E                 FDB $D42E
   1009        679F 0A                   FCB $0A
   1010        67A0 C85C                 FDB $C85C
   1011        67A2 D414                 FDB $D414
   1012        67A4 0A                   FCB $0A
   1013        67A5 BCDC                 FDB $BCDC
   1014        67A7 C85C                 FDB $C85C
   1015        67A9 06                   FCB $06
   1016        67AA B43B                 FDB $B43B
   1017        67AC BF54                 FDB $BF54
   1018        67AE 06                   FCB $06
   1019        67AF AA5F                 FDB $AA5F
   1020        67B1 B43B                 FDB $B43B
   1021        67B3 06                   FCB $06
   1022        67B4 A000                 FDB $A000
   1023        67B6 AA5F                 FDB $AA5F
   1024        67B8 08                   FCB $08
   1025        67B9 BE9E                 FDB $BE9E
   1026        67BB C8B9                 FDB $C8B9
   1027        67BD 0C                   FCB $0C
   1028        67BE D35D                 FDB $D35D
   1029        67C0 DF09                 FDB $DF09
   1030        67C2 0C                   FCB $0C
   1031        67C3 C7CC                 FDB $C7CC
   1032        67C5 D35D                 FDB $D35D
   1033        67C7 08                   FCB $08
   1034        67C8 B46C                 FDB $B46C
   1035        67CA BE9E                 FDB $BE9E
   1036        67CC FF                   FCB $FF
   1037        67CD 6790                 FDB HERO_WALK_R
   1038        67CF 0000                 FDB $0000
   1039
   1040        67D1 0118                 FDB $0118
   1041        67D3               HERO_IDLE_R
   1042        67D3 08                   FCB $08
   1043        67D4 AA65                 FDB $AA65
   1044        67D6 B46C                 FDB $B46C
   1045        67D8 FF                   FCB $FF
   1046        67D9 67D3                 FDB HERO_IDLE_R
   1047        67DB 0000                 FDB $0000
   1048
   1049        67DD 0008                 FDB $0008
   1050        67DF               HERO_RUN_R
   1051        67DF 0C                   FCB $0C
   1052        67E0 BBD6                 FDB $BBD6
   1053        67E2 C7CC                 FDB $C7CC
   1054        67E4 08                   FCB $08
   1055        67E5 A000                 FDB $A000
   1056        67E7 AA65                 FDB $AA65
   1057        67E9 0A                   FCB $0A
   1058        67EA B2F9                 FDB $B2F9
   1059        67EC BCDC                 FDB $BCDC
   1060        67EE 0A                   FCB $0A
   1061        67EF A944                 FDB $A944
   1062        67F1 B2F9                 FDB $B2F9
   1063        67F3 0E                   FCB $0E
   1064        67F4 D42B                 FDB $D42B
   1065        67F6 DF58                 FDB $DF58
   1066        67F8 12                   FCB $12
   1067        67F9 D308                 FDB $D308
   1068        67FB DF86                 FDB $DF86
   1069        67FD 0A                   FCB $0A
   1070        67FE A000                 FDB $A000
   1071        6800 A944                 FDB $A944
   1072        6802 0C                   FCB $0C
   1073        6803 B28C                 FDB $B28C
   1074        6805 BBD6                 FDB $BBD6
   1075        6807 0C                   FCB $0C
   1076        6808 A8F4                 FDB $A8F4
   1077        680A B28C                 FDB $B28C
   1078        680C 0E                   FCB $0E
   1079        680D C954                 FDB $C954
   1080        680F D42B                 FDB $D42B
   1081        6811 FF                   FCB $FF
   1082        6812 67DF                 FDB HERO_RUN_R
   1083        6814 0000                 FDB $0000
   1084
   1085        6816 0008                 FDB $0008
   1086        6818               HERO_WALK_L
   1087        6818 0C                   FCB $0C
   1088        6819 A000                 FDB $A000
   1089        681B A8F4                 FDB $A8F4
   1090        681D 0E                   FCB $0E
   1091        681E BFA4                 FDB $BFA4
   1092        6820 C954                 FDB $C954
   1093        6822 0E                   FCB $0E
   1094        6823 B440                 FDB $B440
   1095        6825 BFA4                 FDB $BFA4
   1096        6827 10                   FCB $10
   1097        6828 D410                 FDB $D410
   1098        682A DFC8                 FDB $DFC8
   1099        682C 10                   FCB $10
   1100        682D C89F                 FDB $C89F
   1101        682F D410                 FDB $D410
   1102        6831 12                   FCB $12
   1103        6832 C7EF                 FDB $C7EF
   1104        6834 D308                 FDB $D308
   1105        6836 0E                   FCB $0E
   1106        6837 AA64                 FDB $AA64
   1107        6839 B440                 FDB $B440
   1108        683B 0E                   FCB $0E
   1109        683C A000                 FDB $A000
   1110        683E AA64                 FDB $AA64
   1111        6840 10                   FCB $10
   1112        6841 BE84                 FDB $BE84
   1113        6843 C89F                 FDB $C89F
   1114        6845 12                   FCB $12
   1115        6846 BC52                 FDB $BC52
   1116        6848 C7EF                 FDB $C7EF
   1117        684A 14                   FCB $14
   1118        684B D400                 FDB $D400
   1119        684D DF91                 FDB $DF91
   1120        684F 10                   FCB $10
   1121        6850 B44D                 FDB $B44D
   1122        6852 BE84                 FDB $BE84
   1123        6854 FF                   FCB $FF
   1124        6855 6818                 FDB HERO_WALK_L
   1125        6857 0000                 FDB $0000
   1126
   1127        6859 0008                 FDB $0008
   1128        685B               HERO_RUN_L
   1129        685B 16                   FCB $16
   1130        685C CF43                 FDB $CF43
   1131        685E DB48                 FDB $DB48
   1132        6860 10                   FCB $10
   1133        6861 A9E3                 FDB $A9E3
   1134        6863 B44D                 FDB $B44D
   1135        6865 10                   FCB $10
   1136        6866 A000                 FDB $A000
   1137        6868 A9E3                 FDB $A9E3
   1138        686A 12                   FCB $12
   1139        686B B293                 FDB $B293
   1140        686D BC52                 FDB $BC52
   1141        686F 14                   FCB $14
   1142        6870 C8C9                 FDB $C8C9
   1143        6872 D400                 FDB $D400
   1144        6874 16                   FCB $16
   1145        6875 C2D9                 FDB $C2D9
   1146        6877 CF43                 FDB $CF43
   1147        6879 12                   FCB $12
   1148        687A A94A                 FDB $A94A
   1149        687C B293                 FDB $B293
   1150        687E 12                   FCB $12
   1151        687F A000                 FDB $A000
   1152        6881 A94A                 FDB $A94A
   1153        6883 14                   FCB $14
   1154        6884 BF2C                 FDB $BF2C
   1155        6886 C8C9                 FDB $C8C9
   1156        6888 14                   FCB $14
   1157        6889 B450                 FDB $B450
   1158        688B BF2C                 FDB $BF2C
   1159        688D FF                   FCB $FF
   1160        688E 685B                 FDB HERO_RUN_L
   1161        6890 0000                 FDB $0000
   1162
   1163        6892 0108                 FDB $0108
   1164        6894               HERO_SKID_L
   1165        6894 14                   FCB $14
   1166        6895 AA07                 FDB $AA07
   1167        6897 B450                 FDB $B450
   1168        6899 16                   FCB $16
   1169        689A B74F                 FDB $B74F
   1170        689C C2D9                 FDB $C2D9
   1171        689E 16                   FCB $16
   1172        689F ABE0                 FDB $ABE0
   1173        68A1 B74F                 FDB $B74F
   1174        68A3 16                   FCB $16
   1175        68A4 A000                 FDB $A000
   1176        68A6 ABE0                 FDB $ABE0
   1177        68A8 18                   FCB $18
   1178        68A9 CD61                 FDB $CD61
   1179        68AB D853                 FDB $D853
   1180        68AD 18                   FCB $18
   1181        68AE C223                 FDB $C223
   1182        68B0 CD61                 FDB $CD61
   1183        68B2 18                   FCB $18
   1184        68B3 B6CD                 FDB $B6CD
   1185        68B5 C223                 FDB $C223
   1186        68B7 18                   FCB $18
   1187        68B8 ABB0                 FDB $ABB0
   1188        68BA B6CD                 FDB $B6CD
   1189        68BC 18                   FCB $18
   1190        68BD A000                 FDB $A000
   1191        68BF ABB0                 FDB $ABB0
   1192        68C1 FF                   FCB $FF
   1193        68C2 6894                 FDB HERO_SKID_L
   1194        68C4 0000                 FDB $0000
   1195
   1196        68C6 0118                 FDB $0118
   1197        68C8               HERO_IDLE_L
   1198        68C8 14                   FCB $14
   1199        68C9 A000                 FDB $A000
   1200        68CB AA07                 FDB $AA07
   1201        68CD FF                   FCB $FF
   1202        68CE 68C8                 FDB HERO_IDLE_L
   1203        68D0 0000                 FDB $0000
   1204                            
   1205                           *****************************************>>
   1206                           * HERO Variables
   1207                           *****************************************>>
   1208                  0400     HERO_WALK_SPD_LIMIT EQU $0400
   1209                  0600     HERO_JOG_SPD_LIMIT  EQU $0600
   1210        68D2               HERO_X_POS
   1211        68D2 50                   FCB $50                     * Hori>>
   1212        68D3               HERO_Y_POS
   1213        68D3 C8                   FCB $C8                     * Vert>>
   1214        68D4               HERO_G_SPEED         * Ground Speed
   1215        68D4 0000                 FDB $0000            * First byte >>
   1216        68D6               HERO_X_SPEED
   1217        68D6 0000                 FDB $0000            * Horizontal >>
   1218        68D8               HERO_X_SPS
   1219        68D8 0000                 FDB $0000            * Subpixel X >>
   1220        68DA               HERO_Y_SPEED
   1221        68DA 0000                 FDB $0000            * Vertical Sp>>
   1222        68DC               HERO_Y_SPS
   1223        68DC 0000                 FDB $0000            * Subpixel Y >>
   1224        68DE               HERO_TOP_SPEED
   1225        68DE 0600                 FDB $0600        * vitesse maximum>>
   1226        68E0               HERO_NEG_TOP_SPEED
   1227        68E0 FA00                 FDB $FA00        * vitesse maximum>>
   1228        68E2               HERO_ACCELERATION
   1229        68E2 000C                 FDB $000C        * constante accel>>
   1230        68E4               HERO_DECELERATION
   1231        68E4 0080                 FDB $0080        * constante decel>>
   1232        68E6               HERO_FRICTION
   1233        68E6 000C                 FDB $000C        * constante de fr>>
   1234        68E8               HERO_ANIMATION_ADR
   1235        68E8 0000                 FDB $0000        * Animation coura>>
   1236        68EA               HERO_ANIMATION_RTN_ADR
   1237        68EA 0000                 FDB $0000        * Animation coura>>
   1238        68EC               HERO_ANIMATION_PAG
   1239        68EC 00                   FCB $00          * Animation coura>>
   1240        68ED               HERO_ANIMATION_DEL
   1241        68ED 0000                 FDB $0000        * Animation coura>>
   1242        68EF               HERO_ANIMATION_DRW
   1243        68EF 0000                 FDB $0000        * Animation coura>>
   1244        68F1               HERO_ANIMATION_IMC
   1245        68F1 00                   FCB $00          * Animation coura>>
   1246        68F2               HERO_ANIMATION_RTN_IMC
   1247        68F2 00                   FCB $00          * Animation coura>>
   1248        68F3               HERO_ANIMATION_FRR
   1249        68F3 00                   FCB $00          * Animation coura>>

000000 Total Errors

000105 Total Symbols
     0x          Label 6300 BEGIN
     2x          Label 650B CLR_CART
     1x          Label 6524 CLR_CART_2
     1x          Label 6540 CLR_CART_3
     1x          Label 66BD Compute_Position
     1x          Label 66DA Compute_Position_01
     4x          Label 66F4 Compute_Position_02
     2x          Label 6332 CPPAGE_LOOP
     0x          Equ   0014 DEBUTECRANA
     0x          Equ   2014 DEBUTECRANB
     1x          Equ   622C DK_dernier_bloc_a_ecrire
     1x          Equ   6213 DK_destination
     1x          Equ   6205 DK_lecture
     1x          Equ   620A DK_piste
     2x          Equ   620F DK_secteur
     1x          Equ   1F40 FINECRANA
     1x          Equ   3F40 FINECRANB
     1x          Label 6567 FINTABPALETTE
     2x          Label 68E2 HERO_ACCELERATION
    13x          Label 68E8 HERO_ANIMATION_ADR
     2x          Label 68ED HERO_ANIMATION_DEL
     4x          Label 68EF HERO_ANIMATION_DRW
     2x          Label 68F3 HERO_ANIMATION_FRR
     5x          Label 68F1 HERO_ANIMATION_IMC
     1x          Label 66F6 HERO_ANIMATION_LOAD
     3x          Label 66FF HERO_ANIMATION_LOAD_00
     2x          Label 670C HERO_ANIMATION_LOAD_01
     1x          Label 673E HERO_ANIMATION_LOAD_FE
     1x          Label 672E HERO_ANIMATION_LOAD_NOPAGE
     1x          Label 674C HERO_ANIMATION_NEXT
     1x          Label 6752 HERO_ANIMATION_NEXT_00
     6x          Label 68EC HERO_ANIMATION_PAG
     2x          Label 68EA HERO_ANIMATION_RTN_ADR
     1x          Label 68F2 HERO_ANIMATION_RTN_IMC
     4x          Label 68E4 HERO_DECELERATION
     2x          Label 68E6 HERO_FRICTION
    17x          Label 68D4 HERO_G_SPEED
     2x          Label 68C8 HERO_IDLE_L
     3x          Label 67D3 HERO_IDLE_R
     2x          Equ   0600 HERO_JOG_SPD_LIMIT
     1x          Label 6581 Hero_Move
     1x          Label 65F3 Hero_MoveLeft
     1x          Label 660D Hero_MoveLeft_00
     1x          Label 662B Hero_MoveLeft_01
     1x          Label 6607 Hero_MoveLeft_03
     1x          Label 6637 Hero_MoveRight
     1x          Label 664E Hero_MoveRight_00
     1x          Label 666C Hero_MoveRight_01
     1x          Label 6648 Hero_MoveRight_03
    11x          Label 6675 Hero_MoveUpdatePos
     1x          Label 668F Hero_MoveUpdatePos_00
     1x          Label 66A6 Hero_MoveUpdatePos_01
     0x          Label 66A6 Hero_MoveUpdatePos_03
     2x          Label 668E Hero_MoveUpdatePos_V00
     3x          Label 68E0 HERO_NEG_TOP_SPEED
     1x          Label 658A Hero_NotLeft
     1x          Label 6591 Hero_NotLeftOrRight
     1x          Label 65C8 Hero_NotLeftOrRight_00
     1x          Label 65B1 Hero_NotLeftOrRight_01
     1x          Label 65C2 Hero_NotLeftOrRight_02
     1x          Label 65C5 Hero_NotLeftOrRight_03
     1x          Label 65DC Hero_NotLeftOrRight_11
     1x          Label 65ED Hero_NotLeftOrRight_12
     1x          Label 65F0 Hero_NotLeftOrRight_13
     6x          Equ   9F00 HERO_POS
     2x          Label 685B HERO_RUN_L
     2x          Label 67DF HERO_RUN_R
     1x          Label 6894 HERO_SKID_L
     1x          Label 675C HERO_SKID_R
     3x          Label 68DE HERO_TOP_SPEED
     3x          Label 6818 HERO_WALK_L
     3x          Label 6790 HERO_WALK_R
     0x          Equ   0400 HERO_WALK_SPD_LIMIT
     4x          Label 68D2 HERO_X_POS
     2x          Label 68D6 HERO_X_SPEED
     6x          Label 68D8 HERO_X_SPS
     4x          Label 68D3 HERO_Y_POS
     1x          Label 68DA HERO_Y_SPEED
     0x          Label 68DC HERO_Y_SPS
     0x          Label 636E INIT_VID
     0x          Equ   000D JOY_B
     0x          Equ   0005 JOY_BD
     0x          Equ   0009 JOY_BG
     1x          Label 6580 JOY_BTN_STATUS
     0x          Equ   000F JOY_C
     1x          Equ   0007 JOY_D
     2x          Label 657F JOY_DIR_STATUS
     1x          Equ   000B JOY_G
     0x          Equ   000E JOY_H
     0x          Equ   0006 JOY_HD
     0x          Equ   000A JOY_HG
     1x          Label 6567 JOY_READ
     4x          Label 631F LDPAGE_LOOP
     1x          Label 63C9 MAIN
     2x          Label 6418 MEM_COPY_DATA_TO_CART
     2x          Label 64FE MEM_COPY_DATA_TO_CART_E
     1x          Label 641E MEM_COPY_DATA_TO_CART_LOOP
     1x          Label 6506 MEM_COPY_DATA_TO_CART_S
     6x          Label 63E8 SCRC
     3x          Label 6403 SCRC0
     1x          Label 6392 SETPALETTE
     1x          Label 6547 TABPALETTE
     1x          Label 640D VSYNC
     1x          Label 640D VSYNC_1
     1x          Label 6412 VSYNC_2

