/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : ./input/CODE/MAIN.ASS
 * Fichier destination : TMP.BIN
 * Contenu :
 *     Main     0:MAIN.ASM     20323
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
     12        6300                      ORG $6300
     13
     14                           *****************************************>>
     15                           * Constantes et variables
     16                           *****************************************>>
     17
     18                  6205     DK_lecture               EQU $6205 * rout>>
     19                  620A     DK_piste                 EQU $620A * 2B n>>
     20                  620F     DK_secteur               EQU $620F * 1B n>>
     21                  6213     DK_destination           EQU $6213 * 2B d>>
     22                  622C     DK_dernier_bloc_a_ecrire EQU $622C * 2B f>>
     23
     24                  0014     DEBUTECRANA EQU $0014 * test pour fin sta>>
     25                  1F40     FINECRANA   EQU $1F40 * fin de la RAM A v>>
     26                  2014     DEBUTECRANB EQU $2014 * test pour fin sta>>
     27                  3F40     FINECRANB   EQU $3F40 * fin de la RAM B v>>
     28
     29                  0005     JOY_BD EQU $05 * Bas Droite
     30                  0006     JOY_HD EQU $06 * Haut Droite
     31                  0007     JOY_D  EQU $07 * Droite
     32                  0009     JOY_BG EQU $09 * Bas Gauche
     33                  000A     JOY_HG EQU $0A * Haut Gauche
     34                  000B     JOY_G  EQU $0B * Gauche
     35                  000D     JOY_B  EQU $0D * Bas
     36                  000E     JOY_H  EQU $0E * Haut
     37                  000F     JOY_C  EQU $0F * Centre
     38
     39                  9F00     SSAVE    EQU $9F00 * BUFFER for S when us>>
     40                  9F02     HERO_POS EQU $9F02
     41
     42                           *****************************************>>
     43                           * Debut du programme
     44                           *****************************************>>
     45        6300               BEGIN
     46  2     6300 1A   50              ORCC #$50     * a documenter (inte>>
     47                            
     48  3     6302 CC   0000            LDD #$0000     * Init variables gl>>
     49  6     6305 FD   9F00            STD SSAVE
     50  3     6308 CC   1F40            LDD #FINECRANA
     51  6     630B FD   9F02            STD HERO_POS
     52  3     630E CC   3F40            LDD #FINECRANB
     53  6     6311 FD   9F04            STD HERO_POS+2
     54
     55                           *****************************************>>
     56                           * Chargement des pages memoire
     57                           *****************************************>>
     58                                  * Chargement de la page 4 depuis l>>
     59                                  **********************************>>
     60  2     6314 C6   04              LDB #$04                       * O>>
     61  5     6316 F7   E7E5            STB $E7E5                      * e>>
     62                            
     63  3     6319 CC   0004            LDD #$0004
     64  6     631C FD   620A            STD DK_piste
     65  2     631F 86   01              LDA #$01
     66  5     6321 B7   620F            STA DK_secteur
     67  3     6324 CC   A000            LDD #$A000
     68  6     6327 FD   6213            STD DK_destination
     69  3     632A CC   DF00            LDD #$DF00
     70  6     632D FD   622C            STD DK_dernier_bloc_a_ecrire
     71  8     6330 BD   6205            JSR DK_lecture
     72                            
     73                                  * Copie de la page 4 en page 5
     74                                  ******************************
     75  2     6333 C6   65              LDB #$65                       * O>>
     76  5     6335 F7   E7E6            STB $E7E6                      * e>>
     77
     78  3     6338 CE   A000         LDU #$A000                     * Sour>>
     79  4     633B 108E 4040         LDY #$4000+64                  * Dest>>
     80  7     633F 10BF 64EE            STY MEM_COPY_DATA_TO_CART_E+2
     81  4     6343 108E 2040         LDY #$2000+64                  * Dest>>
     82  8     6347 BD   6406         JSR MEM_COPY_DATA_TO_CART      * Copi>>
     83                            
     84  3     634A CE   C000         LDU #$C000                     * Sour>>
     85  4     634D 108E 2040         LDY #$2000+64                  * Dest>>
     86  7     6351 10BF 64EE            STY MEM_COPY_DATA_TO_CART_E+2
     87  4     6355 108E 0040         LDY #$0000+64                  * Dest>>
     88  8     6359 BD   6406         JSR MEM_COPY_DATA_TO_CART      * Copi>>
     89                            
     90                           *****************************************>>
     91                           * Initialisation de la routine de commuta>>
     92                           *****************************************>>
     93        635C               INIT_VID
     94  5     635C F6   6081            LDB $6081 * A documenter
     95  2     635F CA   10              ORB #$10  * mettre le bit d4 a 1
     96  5     6361 F7   6081            STB $6081
     97  5     6364 F7   E7E7            STB $E7E7
     98  8     6367 BD   63D6            JSR SCRC     * page 2 en RAM Carto>>
     99  8     636A BD   64F9            JSR CLR_CART * effacement page 2
    100  8     636D BD   63D6            JSR SCRC     * page 0 en RAM Carto>>
    101  8     6370 BD   64F9            JSR CLR_CART * effacement page 0
    102  8     6373 BD   63D6            JSR SCRC     * page 2 en RAM Carto>>
    103
    104                           *****************************************>>
    105                           * Initialisation du mode video
    106                           *****************************************>>
    107  2     6376 86   7B              LDA #$7B      * passage en mode 16>>
    108  5     6378 B7   E7DC            STA $E7DC
    109
    110                           *****************************************>>
    111                           * Initialisation de la palette de couleur>>
    112                           *****************************************>>
    113  4     637B 108E 6535            LDY #TABPALETTE
    114  2     637F 4F                   CLRA
    115        6380               SETPALETTE
    116  5+1   6380 34   02              PSHS A
    117  2     6382 48                   ASLA
    118  5     6383 B7   E7DB            STA $E7DB
    119  5+3   6386 EC   A1              LDD ,Y++
    120  5     6388 F7   E7DA            STB $E7DA
    121  5     638B B7   E7DA            STA $E7DA
    122  5+1   638E 35   02              PULS A
    123  2     6390 4C                   INCA
    124  5     6391 108C 6555            CMPY #FINTABPALETTE
    125  3     6395 26   E9              BNE    SETPALETTE
    126
    127                           *****************************************>>
    128                           * Initialisation des sprites
    129                           *****************************************>>
    130  3     6397 8E   674A            LDX #HERO_IDLE_R
    131  8     639A BD   66E4            JSR HERO_ANIMATION_LOAD
    132
    133                           *****************************************>>
    134                           * Boucle principale
    135                           *****************************************>>
    136                                  * Init routine effacement sprite
    137  5     639D F6   676E            LDB HERO_ANIMATION_PAG            >>
    138  5     63A0 F7   E7E5            STB $E7E5                         >>
    139  7+3   63A3 AD   9F 6771         JSR [HERO_ANIMATION_DRW]          >>
    140  8     63A7 BD   63D6            JSR SCRC
    141  5     63AA F6   676E            LDB HERO_ANIMATION_PAG            >>
    142  5     63AD F7   E7E5            STB $E7E5                         >>
    143  7+3   63B0 AD   9F 6771         JSR [HERO_ANIMATION_DRW]          >>
    144  8     63B4 BD   63D6            JSR SCRC
    145                            
    146        63B7               MAIN
    147                                  * Effacement et affichage des spri>>
    148  5     63B7 F6   676E            LDB HERO_ANIMATION_PAG            >>
    149  5     63BA F7   E7E5            STB $E7E5                         >>
    150  7+3   63BD AD   9F 676F         JSR [HERO_ANIMATION_DEL]          >>
    151  7+3   63C1 AD   9F 6771         JSR [HERO_ANIMATION_DRW]          >>
    152
    153                                  * Gestion des deplacements
    154  8     63C5 BD   6555            JSR JOY_READ
    155  8     63C8 BD   656F            JSR Hero_Move
    156  8     63CB BD   66AB            JSR Compute_Position
    157                            
    158  8     63CE BD   673A            JSR HERO_ANIMATION_NEXT
    159
    160  8     63D1 BD   63D6            JSR SCRC                          >>
    161  3     63D4 20   E1              BRA MAIN
    162
    163                           *****************************************>>
    164                           * Changement de page ESPACE ECRAN (affich>>
    165                           *      $E7DD determine la page affichee d>>
    166                           *      D7=0 D6=0 D5=0 D4=0 (#$0_) : page >>
    167                           *      D7=0 D6=1 D5=0 D4=0 (#$4_) : page >>
    168                           *      D7=1 D6=0 D5=0 D4=0 (#$8_) : page >>
    169                           *      D7=1 D6=1 D5=0 D4=0 (#$C_) : page >>
    170                           *   D3 D2 D1 D0  (#$_0 a #$_F) : couleur >>
    171                           *   Remarque : D5 et D4 utilisable unique>>
    172                           *
    173                           * Changement de page ESPACE CARTOUCHE (ec>>
    174                           *      $E7E6 determine la page affichee d>>
    175                           *   D5 : 1 = espace cartouche recouvert p>>
    176                           *   D4 : 0 = CAS1N valide : banques 0-15 >>
    177                           *      D5=1 D4=0 D3=0 D2=0 D1=0 D0=0 (#$6>>
    178                           *   ...
    179                           *      D5=1 D4=0 D3=1 D2=1 D1=1 D0=1 (#$6>>
    180                           *      D5=1 D4=1 D3=0 D2=0 D1=0 D0=0 (#$7>>
    181                           *   ...
    182                           *      D5=1 D4=1 D3=1 D2=1 D1=1 D0=1 (#$7>>
    183                           *****************************************>>
    184        63D6               SCRC
    185  8     63D6 BD   63FB            JSR VSYNC
    186
    187  5     63D9 F6   63F2            LDB SCRC0+1
    188  2     63DC C4   01              ANDB #$01
    189  5     63DE FB   676E            ADDB HERO_ANIMATION_PAG
    190  5     63E1 F7   676E            STB HERO_ANIMATION_PAG
    191                            
    192  5     63E4 F6   63F2            LDB SCRC0+1   * charge la valeur d>>
    193  2     63E7 C4   80              ANDB #$80     * permute #$00 ou #$>>
    194  2     63E9 CA   00              ORB #$00      * recharger la coule>>
    195  5     63EB F7   E7DD            STB $E7DD     * changement page da>>
    196  7     63EE 73   63F2            COM SCRC0+1   * modification du co>>
    197        63F1               SCRC0
    198  2     63F1 C6   00              LDB #$00
    199  2     63F3 C4   02              ANDB #$02     * permute #$60 ou #$>>
    200  2     63F5 CA   60              ORB #$60      * espace cartouche r>>
    201  5     63F7 F7   E7E6            STB $E7E6     * changement page da>>
    202  5     63FA 39                   RTS                  * E7E6 D5=1 p>>
    203                                                       * CAS1N : ban>>
    204
    205                           *****************************************>>
    206                           * Attente VBL
    207                           *****************************************>>
    208        63FB               VSYNC
    209        63FB               VSYNC_1
    210  7     63FB 7D   E7E7            TST    $E7E7
    211  3     63FE 2A   FB              BPL    VSYNC_1
    212        6400               VSYNC_2
    213  7     6400 7D   E7E7            TST    $E7E7
    214  3     6403 2B   FB              BMI    VSYNC_2
    215  5     6405 39                   RTS
    216
    217                           *****************************************>>
    218                           * Copie Memoire de la zone donnee vers ca>>
    219                           * Cycles en fonction de l'implementation
    220                           * 256 octets (-128 a 127) x 64  boucles (>>
    221                           * 128 octets (-64  a 63)  x 128 boucles (>>
    222                           * 32  octets (-16  a 15)  x 512 boucles (>>
    223                           *****************************************>>
    224                           *MEM_COPY_DATA_TO_CART
    225                           *   PULS X,U
    226                           *   STX       -128,Y
    227                           *   STU       -126,Y
    228                           *   PULS      D,X,U
    229                           *   STD       -124,Y
    230                           *   STX       -122,Y
    231                           *   STU       -120,Y
    232                           *   PULS      D,X,U
    233                           *   STD       -118,Y
    234                           *   STX       -116,Y
    235                           *   STU       -114,Y
    236                           *   PULS      D,X,U
    237                           *   STD       -112,Y
    238                           *   STX       -110,Y
    239                           *   STU       -108,Y
    240                           *   PULS      D,X,U
    241                           *   STD       -106,Y
    242                           *   STX       -104,Y
    243                           *   STU       -102,Y
    244                           *   PULS      D,X,U
    245                           *   STD       -100,Y
    246                           *   STX       -98,Y
    247                           *   STU       -96,Y
    248                           *   PULS      D,X,U
    249                           *   STD       -94,Y
    250                           *   STX       -92,Y
    251                           *   STU       -90,Y
    252                           *   PULS      D,X,U
    253                           *   STD       -88,Y
    254                           *   STX       -86,Y
    255                           *   STU       -84,Y
    256                           *   PULS      D,X,U
    257                           *   STD       -82,Y
    258                           *   STX       -80,Y
    259                           *   STU       -78,Y
    260                           *   PULS      D,X,U
    261                           *   STD       -76,Y
    262                           *   STX       -74,Y
    263                           *   STU       -72,Y
    264                           *   PULS      D,X,U
    265                           *   STD       -70,Y
    266                           *   STX       -68,Y
    267                           *   STU       -66,Y
    268                           *   PULS      D,X,U
    269                           *   STD       -64,Y
    270                           *   STX       -62,Y
    271                           *   STU       -60,Y
    272                           *   PULS      D,X,U
    273                           *   STD       -58,Y
    274                           *   STX       -56,Y
    275                           *   STU       -54,Y
    276                           *   PULS      D,X,U
    277                           *   STD       -52,Y
    278                           *   STX       -50,Y
    279                           *   STU       -48,Y
    280                           *   PULS      D,X,U
    281                           *   STD       -46,Y
    282                           *   STX       -44,Y
    283                           *   STU       -42,Y
    284                           *   PULS      D,X,U
    285                           *   STD       -40,Y
    286                           *   STX       -38,Y
    287                           *   STU       -36,Y
    288                           *   PULS      D,X,U
    289                           *   STD       -34,Y
    290                           *   STX       -32,Y
    291                           *   STU       -30,Y
    292                           *   PULS      D,X,U
    293                           *   STD       -28,Y
    294                           *   STX       -26,Y
    295                           *   STU       -24,Y
    296                           *   PULS      D,X,U
    297                           *   STD       -22,Y
    298                           *   STX       -20,Y
    299                           *   STU       -18,Y
    300                           *   PULS      D,X,U
    301                           *   STD       -16,Y
    302                           *   STX       -14,Y
    303                           *   STU       -12,Y
    304                           *   PULS      D,X,U
    305                           *   STD       -10,Y
    306                           *   STX       -8,Y
    307                           *   STU       -6,Y
    308                           *   PULS      D,X,U
    309                           *   STD       -4,Y
    310                           *   STX       -2,Y
    311                           *   STU       ,Y
    312                           *   PULS      D,X,U
    313                           *   STD       2,Y
    314                           *   STX       4,Y
    315                           *   STU       6,Y
    316                           *   PULS      D,X,U
    317                           *   STD       8,Y
    318                           *   STX       10,Y
    319                           *   STU       12,Y
    320                           *   PULS      D,X,U
    321                           *   STD       14,Y
    322                           *   STX       16,Y
    323                           *   STU       18,Y
    324                           *   PULS      D,X,U
    325                           *   STD       20,Y
    326                           *   STX       22,Y
    327                           *   STU       24,Y
    328                           *   PULS      D,X,U
    329                           *   STD       26,Y
    330                           *   STX       28,Y
    331                           *   STU       30,Y
    332                           *   PULS      D,X,U
    333                           *   STD       32,Y
    334                           *   STX       34,Y
    335                           *   STU       36,Y
    336                           *   PULS      D,X,U
    337                           *   STD       38,Y
    338                           *   STX       40,Y
    339                           *   STU       42,Y
    340                           *   PULS      D,X,U
    341                           *   STD       44,Y
    342                           *   STX       46,Y
    343                           *   STU       48,Y
    344                           *   PULS      D,X,U
    345                           *   STD       50,Y
    346                           *   STX       52,Y
    347                           *   STU       54,Y
    348                           *   PULS      D,X,U
    349                           *   STD       56,Y
    350                           *   STX       58,Y
    351                           *   STU       60,Y
    352                           *   PULS      D,X,U
    353                           *   STD       62,Y
    354                           *   STX       64,Y
    355                           *   STU       66,Y
    356                           *   PULS      D,X,U
    357                           *   STD       68,Y
    358                           *   STX       70,Y
    359                           *   STU       72,Y
    360                           *   PULS      D,X,U
    361                           *   STD       74,Y
    362                           *   STX       76,Y
    363                           *   STU       78,Y
    364                           *   PULS      D,X,U
    365                           *   STD       80,Y
    366                           *   STX       82,Y
    367                           *   STU       84,Y
    368                           *   PULS      D,X,U
    369                           *   STD       86,Y
    370                           *   STX       88,Y
    371                           *   STU       90,Y
    372                           *   PULS      D,X,U
    373                           *   STD       92,Y
    374                           *   STX       94,Y
    375                           *   STU       96,Y
    376                           *   PULS      D,X,U
    377                           *   STD       98,Y
    378                           *   STX       100,Y
    379                           *   STU       102,Y
    380                           *   PULS      D,X,U
    381                           *   STD       104,Y
    382                           *   STX       106,Y
    383                           *   STU       108,Y
    384                           *   PULS      D,X,U
    385                           *   STD       110,Y
    386                           *   STX       112,Y
    387                           *   STU       114,Y
    388                           *   PULS      D,X,U
    389                           *   STD       116,Y
    390                           *   STX       118,Y
    391                           *   STU       120,Y
    392                           *   PULS      D,X,U
    393                           *   STD       122,Y
    394                           *   STX       124,Y
    395                           *   STU       126,Y
    396                           *   LEAY 256,Y
    397                           *MEM_COPY_DATA_TO_CART_E
    398                           *   CMPY    #$0180
    399                           *   LBNE     MEM_COPY_DATA_TO_CART
    400                           *MEM_COPY_DATA_TO_CART_S
    401                           *   LDS     #$0000    * Rechargement du p>>
    402                           *   RTS
    403                            
    404        6406               MEM_COPY_DATA_TO_CART
    405  7     6406 10FF 64F6        STS MEM_COPY_DATA_TO_CART_S+2  * sauve>>
    406  6     640A 1F   34          TFR U,S
    407        640C               MEM_COPY_DATA_TO_CART_LOOP
    408  5+6   640C 35   56          PULS       D,X,U
    409  5+1   640E ED   A8 C0       STD -64,Y
    410  5+1   6411 AF   A8 C2       STX -62,Y
    411  5+1   6414 EF   A8 C4       STU -60,Y
    412  5+6   6417 35   56          PULS       D,X,U
    413  5+1   6419 ED   A8 C6       STD -58,Y
    414  5+1   641C AF   A8 C8       STX -56,Y
    415  5+1   641F EF   A8 CA       STU -54,Y
    416  5+6   6422 35   56          PULS       D,X,U
    417  5+1   6424 ED   A8 CC       STD -52,Y
    418  5+1   6427 AF   A8 CE       STX -50,Y
    419  5+1   642A EF   A8 D0       STU -48,Y
    420  5+6   642D 35   56          PULS       D,X,U
    421  5+1   642F ED   A8 D2       STD -46,Y
    422  5+1   6432 AF   A8 D4       STX -44,Y
    423  5+1   6435 EF   A8 D6       STU -42,Y
    424  5+6   6438 35   56          PULS       D,X,U
    425  5+1   643A ED   A8 D8       STD -40,Y
    426  5+1   643D AF   A8 DA       STX -38,Y
    427  5+1   6440 EF   A8 DC       STU -36,Y
    428  5+6   6443 35   56          PULS       D,X,U
    429  5+1   6445 ED   A8 DE       STD -34,Y
    430  5+1   6448 AF   A8 E0       STX -32,Y
    431  5+1   644B EF   A8 E2       STU -30,Y
    432  5+6   644E 35   56          PULS       D,X,U
    433  5+1   6450 ED   A8 E4       STD -28,Y
    434  5+1   6453 AF   A8 E6       STX -26,Y
    435  5+1   6456 EF   A8 E8       STU -24,Y
    436  5+6   6459 35   56          PULS       D,X,U
    437  5+1   645B ED   A8 EA       STD -22,Y
    438  5+1   645E AF   A8 EC       STX -20,Y
    439  5+1   6461 EF   A8 EE       STU -18,Y
    440  5+6   6464 35   56          PULS       D,X,U
    441  5+1   6466 ED   30          STD -16,Y
    442  5+1   6468 AF   32          STX -14,Y
    443  5+1   646A EF   34          STU -12,Y
    444  5+6   646C 35   56          PULS       D,X,U
    445  5+1   646E ED   36          STD -10,Y
    446  5+1   6470 AF   38          STX -8,Y
    447  5+1   6472 EF   3A          STU -6,Y
    448  5+6   6474 35   56          PULS       D,X,U
    449  5+1   6476 ED   3C          STD -4,Y
    450  5+1   6478 AF   3E          STX -2,Y
    451  5+0   647A EF   A4          STU ,Y
    452  5+6   647C 35   56          PULS       D,X,U
    453  5+1   647E ED   22          STD 2,Y
    454  5+1   6480 AF   24          STX 4,Y
    455  5+1   6482 EF   26          STU 6,Y
    456  5+6   6484 35   56          PULS       D,X,U
    457  5+1   6486 ED   28          STD 8,Y
    458  5+1   6488 AF   2A          STX 10,Y
    459  5+1   648A EF   2C          STU 12,Y
    460  5+6   648C 35   56          PULS       D,X,U
    461  5+1   648E ED   2E          STD 14,Y
    462  5+1   6490 AF   A8 10       STX 16,Y
    463  5+1   6493 EF   A8 12       STU 18,Y
    464  5+6   6496 35   56          PULS       D,X,U
    465  5+1   6498 ED   A8 14       STD 20,Y
    466  5+1   649B AF   A8 16       STX 22,Y
    467  5+1   649E EF   A8 18       STU 24,Y
    468  5+6   64A1 35   56          PULS       D,X,U
    469  5+1   64A3 ED   A8 1A       STD 26,Y
    470  5+1   64A6 AF   A8 1C       STX 28,Y
    471  5+1   64A9 EF   A8 1E       STU 30,Y
    472  5+6   64AC 35   56          PULS       D,X,U
    473  5+1   64AE ED   A8 20       STD 32,Y
    474  5+1   64B1 AF   A8 22       STX 34,Y
    475  5+1   64B4 EF   A8 24       STU 36,Y
    476  5+6   64B7 35   56          PULS       D,X,U
    477  5+1   64B9 ED   A8 26       STD 38,Y
    478  5+1   64BC AF   A8 28       STX 40,Y
    479  5+1   64BF EF   A8 2A       STU 42,Y
    480  5+6   64C2 35   56          PULS       D,X,U
    481  5+1   64C4 ED   A8 2C       STD 44,Y
    482  5+1   64C7 AF   A8 2E       STX 46,Y
    483  5+1   64CA EF   A8 30       STU 48,Y
    484  5+6   64CD 35   56          PULS       D,X,U
    485  5+1   64CF ED   A8 32       STD 50,Y
    486  5+1   64D2 AF   A8 34       STX 52,Y
    487  5+1   64D5 EF   A8 36       STU 54,Y
    488  5+6   64D8 35   56          PULS       D,X,U
    489  5+1   64DA ED   A8 38       STD 56,Y
    490  5+1   64DD AF   A8 3A       STX 58,Y
    491  5+1   64E0 EF   A8 3C       STU 60,Y
    492  5+2   64E3 35   06          PULS       D
    493  5+1   64E5 ED   A8 3E       STD 62,Y
    494  4+4   64E8 31   A9 0080     LEAY 128,Y
    495        64EC               MEM_COPY_DATA_TO_CART_E
    496  5     64EC 108C 00C0        CMPY    #$00C0
    497  6     64F0 1026 FF18        LBNE    MEM_COPY_DATA_TO_CART_LOOP
    498        64F4               MEM_COPY_DATA_TO_CART_S
    499  4     64F4 10CE 0000        LDS     #$0000    * Rechargement du po>>
    500  5     64F8 39               RTS
    501
    502                           *MEM_COPY_DATA_TO_CART
    503                           *   PULS    D,X,U
    504                           *   STD     -16,Y
    505                           *   STX     -14,Y
    506                           *   STU     -12,Y
    507                           *   PULS    D,X,U
    508                           *   STD     -10,Y
    509                           *   STX     -8,Y
    510                           *   STU     -6,Y
    511                           *   PULS    D,X,U
    512                           *   STD     -4,Y
    513                           *   STX     -2,Y
    514                           *   STU     ,Y
    515                           *   PULS    D,X,U
    516                           *   STD     2,Y
    517                           *   STX     4,Y
    518                           *   STU     6,Y
    519                           *   PULS    D,X
    520                           *   STD     8,Y
    521                           *   STX     10,Y
    522                           *   PULS    D,X
    523                           *   STD     12,Y
    524                           *   STX     14,Y
    525                           *   LEAY    32,Y
    526                           *MEM_COPY_DATA_TO_CART_E
    527                           *   CMPY    #$0030
    528                           *   BNE     MEM_COPY_DATA_TO_CART
    529                           *MEM_COPY_DATA_TO_CART_S
    530                           *   LDS     #$0000    * Rechargement du p>>
    531                           *   RTS
    532                           *****************************************>>
    533                           * Effacement memoire Cartouche (27000 cy)>>
    534                           *****************************************>>
    535        64F9               CLR_CART
    536  5+3   64F9 34   48           PSHS U,DP
    537  7     64FB 10FF 6530         STS CLR_CART_3+2
    538  4     64FF 10CE 4000         LDS #$4000
    539  3     6503 CE   0000         LDU #$0000
    540  4     6506 108E 0000         LDY #$0000
    541  3     650A 8E   0000         LDX #$0000
    542  3     650D CC   0000         LDD #$0000
    543  6     6510 1F   8B           TFR A,DP
    544        6512               CLR_CART_2
    545  5+9   6512 34   7E           PSHS U,Y,X,DP,B,A
    546  5+9   6514 34   7E           PSHS U,Y,X,DP,B,A
    547  5+9   6516 34   7E           PSHS U,Y,X,DP,B,A
    548  5+9   6518 34   7E           PSHS U,Y,X,DP,B,A
    549  5+9   651A 34   7E           PSHS U,Y,X,DP,B,A
    550  5+9   651C 34   7E           PSHS U,Y,X,DP,B,A
    551  5+9   651E 34   7E           PSHS U,Y,X,DP,B,A
    552  5+9   6520 34   7E           PSHS U,Y,X,DP,B,A
    553  5+9   6522 34   7E           PSHS U,Y,X,DP,B,A
    554  5+9   6524 34   7E           PSHS U,Y,X,DP,B,A
    555  5     6526 118C 0004         CMPS #$0004
    556  3     652A 26   E6           BNE CLR_CART_2
    557  5+4   652C 34   60           PSHS U,Y
    558        652E               CLR_CART_3
    559  4     652E 10CE 0000         LDS #$0000
    560  5+3   6532 35   48           PULS DP,U
    561  5     6534 39                RTS
    562                            
    563                           *****************************************>>
    564                           * Affichage de l arriere plan 57900 cycle>>
    565                           *****************************************>>
    566                           *DRAW_RAM_DATA_TO_CART_160x200
    567                           *      PSHS U,DP            * sauvegarde >>
    568                           *      STS >SSAVE
    569                           *
    570                           *      LDS #FINECRANA       * init pointe>>
    571                           *      LDU #$A000
    572                           *
    573                           *DRAW_RAM_DATA_TO_CART_160x200A
    574                           *      PULU A,B,DP,X,Y
    575                           *      PSHS Y,X,DP,B,A
    576                           *      PULU A,B,DP,X,Y
    577                           *      PSHS Y,X,DP,B,A
    578                           *      PULU A,B,DP,X,Y
    579                           *      PSHS Y,X,DP,B,A
    580                           *      PULU A,B,DP,X,Y
    581                           *      PSHS Y,X,DP,B,A
    582                           *      PULU A,B,DP,X,Y
    583                           *      PSHS Y,X,DP,B,A
    584                           *      PULU A,B,DP,X,Y
    585                           *      PSHS Y,X,DP,B,A
    586                           *      CMPS #DEBUTECRANA
    587                           *      BNE DRAW_RAM_DATA_TO_CART_160x200A>>
    588                           *      PULU A,B,DP,X,Y
    589                           *      PSHS Y,X,DP,B,A
    590                           *      PULU A,B,DP,X,Y
    591                           *      PSHS Y,X,DP,B,A
    592                           *      PULU B,DP,X,Y
    593                           *      PSHS Y,X,DP,B
    594                           *
    595                           *      LDS #FINECRANB       * init pointe>>
    596                           *      LDU #$C000
    597                           *
    598                           *DRAW_RAM_DATA_TO_CART_160x200B
    599                           *      PULU A,B,DP,X,Y
    600                           *      PSHS Y,X,DP,B,A
    601                           *      PULU A,B,DP,X,Y
    602                           *      PSHS Y,X,DP,B,A
    603                           *      PULU A,B,DP,X,Y
    604                           *      PSHS Y,X,DP,B,A
    605                           *      PULU A,B,DP,X,Y
    606                           *      PSHS Y,X,DP,B,A
    607                           *      PULU A,B,DP,X,Y
    608                           *      PSHS Y,X,DP,B,A
    609                           *      PULU A,B,DP,X,Y
    610                           *      PSHS Y,X,DP,B,A
    611                           *      CMPS #DEBUTECRANB
    612                           *      BNE DRAW_RAM_DATA_TO_CART_160x200B>>
    613                           *      PULU A,B,DP,X,Y
    614                           *      PSHS Y,X,DP,B,A
    615                           *      PULU A,B,DP,X,Y
    616                           *      PSHS Y,X,DP,B,A
    617                           *      PULU B,DP,X,Y
    618                           *      PSHS Y,X,DP,B
    619                           *
    620                           *      LDS  >SSAVE          * rechargemen>>
    621                           *      PULS U,DP
    622                           *      RTS
    623
    624                           *****************************************>>
    625                           * Palette de 16 couleurs
    626                           *****************************************>>
    627        6535               TABPALETTE
    628        6535 0CCD                 FDB $0ccd     * index:0  R:244 V:2>>
    629        6537 0BA4                 FDB $0ba4     * index:1  R:164 V:2>>
    630        6539 035D                 FDB $035d     * index:2  R:244 V:1>>
    631        653B 0D81                 FDB $0d81     * index:3  R:108 V:2>>
    632        653D 013B                 FDB $013b     * index:4  R:228 V:1>>
    633        653F 0541                 FDB $0541     * index:5  R:100 V:1>>
    634        6541 0D30                 FDB $0d30     * index:6  R:43  V:1>>
    635        6543 0017                 FDB $0017     * index:7  R:196 V:1>>
    636        6545 000B                 FDB $000b     * index:8  R:228 V:2>>
    637        6547 0D10                 FDB $0d10     * index:9  R:4   V:1>>
    638        6549 0110                 FDB $0110     * index:10 R:28  V:9>>
    639        654B 0003                 FDB $0003     * index:11 R:148 V:2>>
    640        654D 0700                 FDB $0700     * index:12 R:4   V:5>>
    641        654F 0200                 FDB $0200     * index:13 R:4   V:2>>
    642        6551 0000                 FDB $0000     * index:14 R:68  V:2>>
    643        6553 0000                 FDB $0000     * index:15 R:4   V:2>>
    644        6555               FINTABPALETTE
    645
    646                           *****************************************>>
    647                           * Get joystick parameters
    648                           *****************************************>>
    649        6555               JOY_READ
    650  3     6555 8E   E7CF            ldx    #$e7cf
    651  4     6558 108E E7CD            ldy    #$e7cd
    652  3     655C CC   400F            ldd    #$400f
    653  5     655F F4   E7CC            andb   >$e7cc     * Read position
    654  5     6562 F7   656D            stb    JOY_DIR_STATUS
    655  4+0   6565 A4   A4              anda   ,y         * Read button
    656  2     6567 88   40              eora   #$40
    657  5     6569 B7   656E            sta    JOY_BTN_STATUS
    658  5     656C 39                   RTS
    659        656D               JOY_DIR_STATUS
    660        656D 00                   FCB $00 * Position Pad
    661        656E               JOY_BTN_STATUS
    662        656E 00                   FCB $00 * 40 Bouton A enfonce
    663
    664                           *****************************************>>
    665                           * Subroutine to      make HERO walk/run
    666                           *****************************************>>
    667        656F               Hero_Move
    668  5     656F B6   656D            LDA JOY_DIR_STATUS
    669  2     6572 81   0B              CMPA #JOY_G
    670  3     6574 26   02              BNE Hero_NotLeft
    671  3     6576 20   69              BRA Hero_MoveLeft
    672
    673        6578               Hero_NotLeft                   * XREF: He>>
    674  2     6578 81   07              CMPA #JOY_D
    675  3     657A 26   03              BNE Hero_NotLeftOrRight
    676  5     657C 16   00A6            LBRA Hero_MoveRight
    677
    678        657F               Hero_NotLeftOrRight            * XREF: He>>
    679  6     657F FC   6756            LDD HERO_G_SPEED
    680  5     6582 1083 0000            CMPD #$0000
    681  3     6586 2D   2E              BLT Hero_NotLeftOrRight_00 * se de>>
    682  7     6588 B3   6768            SUBD HERO_FRICTION     * se deplac>>
    683  3     658B 24   12              BCC Hero_NotLeftOrRight_01 * si on>>
    684  3     658D CC   0000            LDD #$0000
    685  6     6590 FD   6756            STD HERO_G_SPEED
    686  6     6593 FD   675A            STD HERO_X_SPS
    687  3     6596 8E   674A            LDX #HERO_IDLE_R        * Charge a>>
    688  6     6599 BF   676A            STX HERO_ANIMATION_ADR      * Sauv>>
    689  5     659C 16   00C4            LBRA Hero_MoveUpdatePos
    690        659F               Hero_NotLeftOrRight_01
    691  5     659F 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    692  3     65A3 2C   0B              BGE Hero_NotLeftOrRight_02
    693  6     65A5 FD   6756            STD HERO_G_SPEED
    694  3     65A8 8E   674A            LDX #HERO_WALK_R        * Charge a>>
    695  6     65AB BF   676A            STX HERO_ANIMATION_ADR      * Sauv>>
    696  3     65AE 20   03              BRA Hero_NotLeftOrRight_03
    697        65B0               Hero_NotLeftOrRight_02
    698  6     65B0 FD   6756            STD HERO_G_SPEED
    699        65B3               Hero_NotLeftOrRight_03
    700  5     65B3 16   00AD            LBRA Hero_MoveUpdatePos
    701        65B6               Hero_NotLeftOrRight_00
    702  7     65B6 F3   6768            ADDD HERO_FRICTION     * se deplac>>
    703  3     65B9 24   0F              BCC Hero_NotLeftOrRight_11 * si on>>
    704  3     65BB CC   0000            LDD #$0000
    705  6     65BE FD   6756            STD HERO_G_SPEED
    706  3     65C1 8E   674A            LDX #HERO_IDLE_L        * Charge a>>
    707  6     65C4 BF   676A            STX HERO_ANIMATION_ADR      * Sauv>>
    708  5     65C7 16   0099            LBRA Hero_MoveUpdatePos
    709        65CA               Hero_NotLeftOrRight_11
    710  5     65CA 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    711  3     65CE 2F   0B              BLE Hero_NotLeftOrRight_12
    712  6     65D0 FD   6756            STD HERO_G_SPEED
    713  3     65D3 8E   674A            LDX #HERO_WALK_L        * Charge a>>
    714  6     65D6 BF   676A            STX HERO_ANIMATION_ADR      * Sauv>>
    715  3     65D9 20   03              BRA Hero_NotLeftOrRight_13
    716        65DB               Hero_NotLeftOrRight_12
    717  6     65DB FD   6756            STD HERO_G_SPEED
    718        65DE               Hero_NotLeftOrRight_13
    719  5     65DE 16   0082            LBRA Hero_MoveUpdatePos
    720
    721        65E1               Hero_MoveLeft                      * XREF>>
    722  6     65E1 FC   6756            LDD HERO_G_SPEED            * Char>>
    723  5     65E4 1083 0000            CMPD #$0000                 * Test>>
    724  3     65E8 2F   11              BLE Hero_MoveLeft_00        * BRAN>>
    725  7     65EA B3   6766            SUBD HERO_DECELERATION      * orie>>
    726  3     65ED 24   06              BCC Hero_MoveLeft_03        * BRAN>>
    727  3     65EF CC   0000            LDD #$0000
    728  7     65F2 B3   6766            SUBD HERO_DECELERATION      * si l>>
    729        65F5               Hero_MoveLeft_03
    730  6     65F5 FD   6756            STD HERO_G_SPEED            * On s>>
    731  5     65F8 16   0068            LBRA Hero_MoveUpdatePos           >>
    732        65FB               Hero_MoveLeft_00                         >>
    733                           *      CMPD #$0000                       >>
    734                           *      BNE Hero_MoveLeft_02        * BRAN>>
    735                           *      LDD #$FEFF                        >>
    736                           *Hero_MoveLeft_02
    737  8     65FB 10B3 6762            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    738  3     65FF 27   62              BEQ Hero_MoveUpdatePos      * vite>>
    739  7     6601 B3   6764            SUBD HERO_ACCELERATION      * acce>>
    740  8     6604 10B3 6762            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    741  3     6608 2E   0F              BGT Hero_MoveLeft_01        * BRAN>>
    742  3     660A 8E   674A            LDX #HERO_RUN_L        * Charge an>>
    743  6     660D BF   676A            STX HERO_ANIMATION_ADR      * Sauv>>
    744  6     6610 FC   6762            LDD HERO_NEG_TOP_SPEED      * Limi>>
    745  6     6613 FD   6756            STD HERO_G_SPEED            * Enre>>
    746  5     6616 16   004A            LBRA Hero_MoveUpdatePos     * Mise>>
    747        6619               Hero_MoveLeft_01
    748  6     6619 FD   6756            STD HERO_G_SPEED            * Enre>>
    749  3     661C 8E   674A            LDX #HERO_WALK_L        * Charge a>>
    750  6     661F BF   676A            STX HERO_ANIMATION_ADR      * Sauv>>
    751  5     6622 16   003E            LBRA Hero_MoveUpdatePos
    752
    753        6625               Hero_MoveRight                  * XREF: H>>
    754  6     6625 FC   6756            LDD HERO_G_SPEED        * Chargeme>>
    755  5     6628 1083 0000            CMPD #$0000                 * Test>>
    756  3     662C 2C   0E              BGE Hero_MoveRight_00       * BRAN>>
    757  7     662E F3   6766            ADDD HERO_DECELERATION      * orie>>
    758  3     6631 24   03              BCC Hero_MoveRight_03       * BRAN>>
    759  6     6633 FC   6766            LDD HERO_DECELERATION   * si la vi>>
    760        6636               Hero_MoveRight_03
    761  6     6636 FD   6756            STD HERO_G_SPEED        * On stock>>
    762  5     6639 16   0027            LBRA Hero_MoveUpdatePos           >>
    763        663C               Hero_MoveRight_00                  * Orie>>
    764                           *      CMPD #$0000                       >>
    765                           *      BNE Hero_MoveRight_02       * BRAN>>
    766                           *      LDD #$0100                        >>
    767                           *Hero_MoveRight_02
    768  8     663C 10B3 6760            CMPD HERO_TOP_SPEED         * Comp>>
    769  3     6640 27   21              BEQ Hero_MoveUpdatePos      * vite>>
    770  7     6642 F3   6764            ADDD HERO_ACCELERATION      * acce>>
    771  8     6645 10B3 6760            CMPD HERO_TOP_SPEED         * Comp>>
    772  3     6649 2D   0F              BLT Hero_MoveRight_01       * BRAN>>
    773  3     664B 8E   674A            LDX #HERO_RUN_R                   >>
    774  6     664E BF   676A            STX HERO_ANIMATION_ADR      * Sauv>>
    775  6     6651 FC   6760            LDD HERO_TOP_SPEED          * Limi>>
    776  6     6654 FD   6756            STD HERO_G_SPEED            * Enre>>
    777  5     6657 16   0009            LBRA Hero_MoveUpdatePos           >>
    778        665A               Hero_MoveRight_01
    779  6     665A FD   6756            STD HERO_G_SPEED            * Enre>>
    780  3     665D 8E   674A            LDX #HERO_WALK_R        * Charge a>>
    781  6     6660 BF   676A            STX HERO_ANIMATION_ADR      * Sauv>>
    782
    783        6663               Hero_MoveUpdatePos
    784  6     6663 FC   6756            LDD HERO_G_SPEED            * Char>>
    785  6     6666 FD   6758            STD HERO_X_SPEED        * Stockage>>
    786  5     6669 1083 0000            CMPD #$0000                 * Test>>
    787  3     666D 2D   0E              BLT Hero_MoveUpdatePos_00   * BRAN>>
    788  7     666F F3   675A            ADDD HERO_X_SPS         * Ajout du>>
    789  5     6672 F7   675B            STB HERO_X_SPS+1            * sauv>>
    790  6     6675 1F   89              TFR A,B                     * Divi>>
    791  5     6677 FB   6754            ADDB HERO_X_POS                   >>
    792  3     667A 20   18              BRA Hero_MoveUpdatePos_01
    793        667C               Hero_MoveUpdatePos_V00
    794        667C 00                   FCB $00
    795        667D               Hero_MoveUpdatePos_00
    796  3     667D CC   0000            LDD #$0000
    797  7     6680 B3   6758            SUBD HERO_X_SPEED           * La v>>
    798  7     6683 F3   675A            ADDD HERO_X_SPS         * Ajout du>>
    799  5     6686 F7   675B            STB HERO_X_SPS+1            * sauv>>
    800  6     6689 1F   89              TFR A,B                     * Divi>>
    801  5     668B F7   667C            STB Hero_MoveUpdatePos_V00
    802  5     668E F6   6754            LDB HERO_X_POS
    803  5     6691 F0   667C            SUBB Hero_MoveUpdatePos_V00 * Ajou>>
    804        6694               Hero_MoveUpdatePos_01
    805                           *      CMPB #$50                         >>
    806                           *      BLE Hero_MoveUpdatePos_02   * Bute>>
    807                           *      LDB #$50                          >>
    808                           *Hero_MoveUpdatePos_02
    809                           *    CMPB #$0C                           >>
    810                           *      BGE Hero_MoveUpdatePos_03   * Bute>>
    811                           *      LDB #$0C                          >>
    812        6694               Hero_MoveUpdatePos_03
    813  5     6694 F7   6754            STB HERO_X_POS
    814  2     6697 C6   00              LDB #$00
    815  5     6699 F7   675A            STB HERO_X_SPS                    >>
    816  3     669C CC   0000            LDD #$0000                  * TODO>>
    817  6     669F FD   675C            STD HERO_Y_SPEED
    818  6     66A2 1F   89              TFR A,B                     * divi>>
    819  5     66A4 FB   6755            ADDB HERO_Y_POS
    820  5     66A7 F7   6755            STB HERO_Y_POS
    821  5     66AA 39                   RTS
    822
    823                           * TODO : Braking Animation
    824                           * Sonic enters his braking animation when>>
    825                           * In Sonic 1 and Sonic CD, he then stays >>
    826                           * In the other 3 games, Sonic returns to >>
    827
    828        66AB               Compute_Position
    829  5     66AB B6   6754            LDA HERO_X_POS
    830  2     66AE 44                   LSRA
    831  3     66AF 25   17              BCS Compute_Position_01
    832  5     66B1 B7   66E3            STA Compute_Position_02+1
    833  2     66B4 86   28              LDA #$28
    834  5     66B6 F6   6755            LDB HERO_Y_POS
    835  2     66B9 5A                   DECB
    836  11    66BA 3D                   MUL
    837  7     66BB F3   66E2            ADDD Compute_Position_02
    838  6     66BE FD   9F02            STD HERO_POS
    839  4     66C1 C3   2000            ADDD #$2000
    840  6     66C4 FD   9F04            STD HERO_POS+2
    841  5     66C7 39                   RTS
    842        66C8               Compute_Position_01
    843  5     66C8 B7   66E3            STA Compute_Position_02+1
    844  2     66CB 86   28              LDA #$28
    845  5     66CD F6   6755            LDB HERO_Y_POS
    846  2     66D0 5A                   DECB
    847  11    66D1 3D                   MUL
    848  7     66D2 F3   66E2            ADDD Compute_Position_02
    849  4     66D5 C3   2000            ADDD #$2000
    850  6     66D8 FD   9F02            STD HERO_POS
    851  4     66DB 83   1FFF            SUBD #$1FFF
    852  6     66DE FD   9F04            STD HERO_POS+2
    853  5     66E1 39                   RTS
    854        66E2               Compute_Position_02
    855        66E2 0000                 FDB $0000
    856
    857                           *****************************************>>
    858                           * HERO Animations
    859                           * ---------------
    860                           * Note: Speed abs +0, rel +8, rel cap +10>>
    861                           *
    862                           * Chargement nouvelle animation
    863                           *    nouvelle frame = 109 a 119
    864                           *
    865                           * Chargement frame suivante
    866                           *    frame identique = 15
    867                           * ou frame suivante  = 116 a 126
    868                           *
    869                           * Chargement frame suivante avec branchem>>
    870                           *    nouvelle frame = 165 a 175
    871                           * ou frame suivante = 172 a 182
    872                           *
    873                           * Chargement frame suivante avec retour s>>
    874                           *    nouvelle frame = 167 a 177
    875                           * ou frame suivante = 174 a 184
    876                           *****************************************>>
    877
    878        66E4               HERO_ANIMATION_LOAD                      >>
    879  6     66E4 BF   676A            STX HERO_ANIMATION_ADR
    880  6     66E7 BF   676C            STX HERO_ANIMATION_RTN_ADR
    881  7     66EA 7F   6773            CLR HERO_ANIMATION_IMC            >>
    882        66ED               HERO_ANIMATION_LOAD_00
    883  5+1   66ED EC   1E              LDD -2,X                          >>
    884  2     66EF 81   00              CMPA #$00                         >>
    885  3     66F1 27   07              BEQ HERO_ANIMATION_LOAD_01
    886  5     66F3 F0   6756            SUBB HERO_G_SPEED                 >>
    887  3     66F6 24   02              BCC HERO_ANIMATION_LOAD_01
    888  2     66F8 C6   01              LDB #$01                          >>
    889        66FA               HERO_ANIMATION_LOAD_01
    890  5     66FA F7   6775            STB HERO_ANIMATION_FRR            >>
    891  5     66FD B6   6773            LDA HERO_ANIMATION_IMC
    892  2     6700 C6   05              LDB #$05
    893  11    6702 3D                   MUL
    894  7     6703 F3   676A            ADDD HERO_ANIMATION_ADR
    895  6     6706 1F   02              TFR D,Y
    896  4+0   6708 E6   A4              LDB ,Y
    897  2     670A C1   1F              CMPB #$1F                         >>
    898  3     670C 22   0E              BHI HERO_ANIMATION_LOAD_NOPAGE
    899  5     670E F7   676E            STB HERO_ANIMATION_PAG            >>
    900  5+1   6711 AE   21              LDX 1,Y
    901  6     6713 BF   6771            STX HERO_ANIMATION_DRW
    902  5+1   6716 AE   23              LDX 3,Y
    903  6     6718 BF   676F            STX HERO_ANIMATION_DEL
    904  5     671B 39                   RTS
    905        671C               HERO_ANIMATION_LOAD_NOPAGE
    906  2     671C C1   FF              CMPB #$FF
    907  3     671E 26   0C              BNE HERO_ANIMATION_LOAD_FE
    908  5+1   6720 AE   23              LDX 3,Y
    909  6     6722 BF   6773            STX HERO_ANIMATION_IMC            >>
    910  5+1   6725 AE   21              LDX 1,Y
    911  6     6727 BF   676A            STX HERO_ANIMATION_ADR
    912  3     672A 20   C1              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    913        672C               HERO_ANIMATION_LOAD_FE
    914  6     672C BE   676C            LDX HERO_ANIMATION_RTN_ADR  * RETU>>
    915  6     672F BF   676A            STX HERO_ANIMATION_ADR
    916  5     6732 F6   6774            LDB HERO_ANIMATION_RTN_IMC
    917  5     6735 F7   6773            STB HERO_ANIMATION_IMC
    918  3     6738 20   B3              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    919
    920        673A               HERO_ANIMATION_NEXT
    921  7     673A 7A   6775            DEC HERO_ANIMATION_FRR
    922  3     673D 27   01              BEQ HERO_ANIMATION_NEXT_00  * BRAN>>
    923  5     673F 39                   RTS
    924        6740               HERO_ANIMATION_NEXT_00
    925  7     6740 7C   6773            INC HERO_ANIMATION_IMC
    926  6     6743 BE   676A            LDX HERO_ANIMATION_ADR
    927  3     6746 20   A5              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    928                            
    929                           *   SAMPLE CODE ANIMATION
    930                           *      ---------------------
    931                           *      FDB $0018            * 00 Absolute>>
    932                           *HERO_IDLE_L
    933                           *      FCB $01                     * Page>>
    934                           *      FDB $A000            * Adresse drw>>
    935                           *      FDB $A000            * Adresse del>>
    936                           *
    937                           *      FCB $FF                     * FF S>>
    938                           *      FDB HERO_IDLE-C * adresse animatio>>
    939                           *      FDB $0301            * 03 image ci>>
    940                           *
    941                           *      FCB $FE                     * FE R>>
    942                           *
    943                           *      LDX #HERO_IDLE_R
    944                           *      JSR HERO_ANIMATION_LOAD
    945                           *
    946                           *      JSR HERO_ANIMATION_NEXT
    947
    948                           *<ANIMATION_TABLE>
    949                           * Limite a 128 images par animations
    950
    951        6748 0001                 FDB $0001
    952        674A               HERO_IDLE_L
    953        674A               HERO_IDLE_R
    954        674A               HERO_IDLE_L2
    955        674A               HERO_SUBIDLE_B
    956        674A               HERO_WALK_L
    957        674A               HERO_WALK_R
    958        674A               HERO_RUN_L
    959        674A               HERO_RUN_R
    960        674A 04                   FCB $04
    961        674B A000                 FDB $A000
    962        674D A50A                 FDB $A50A
    963        674F FF                   FCB $FF
    964        6750 674A                 FDB HERO_RUN_R
    965        6752 0000                 FDB $0000
    966                            
    967                           *****************************************>>
    968                           * HERO Variables
    969                           *****************************************>>
    970                  0400     HERO_WALK_SPD_LIMIT EQU $0400
    971                  0600     HERO_JOG_SPD_LIMIT  EQU $0600
    972        6754               HERO_X_POS
    973        6754 50                   FCB $50                     * Hori>>
    974        6755               HERO_Y_POS
    975        6755 C8                   FCB $C8                     * Vert>>
    976        6756               HERO_G_SPEED         * Ground Speed
    977        6756 0000                 FDB $0000            * First byte >>
    978        6758               HERO_X_SPEED
    979        6758 0000                 FDB $0000            * Horizontal >>
    980        675A               HERO_X_SPS
    981        675A 0000                 FDB $0000            * Subpixel X >>
    982        675C               HERO_Y_SPEED
    983        675C 0000                 FDB $0000            * Vertical Sp>>
    984        675E               HERO_Y_SPS
    985        675E 0000                 FDB $0000            * Subpixel Y >>
    986        6760               HERO_TOP_SPEED
    987        6760 0600                 FDB $0600        * vitesse maximum>>
    988        6762               HERO_NEG_TOP_SPEED
    989        6762 FA00                 FDB $FA00        * vitesse maximum>>
    990        6764               HERO_ACCELERATION
    991        6764 000C                 FDB $000C        * constante accel>>
    992        6766               HERO_DECELERATION
    993        6766 0080                 FDB $0080        * constante decel>>
    994        6768               HERO_FRICTION
    995        6768 000C                 FDB $000C        * constante de fr>>
    996        676A               HERO_ANIMATION_ADR
    997        676A 0000                 FDB $0000        * Animation coura>>
    998        676C               HERO_ANIMATION_RTN_ADR
    999        676C 0000                 FDB $0000        * Animation coura>>
   1000        676E               HERO_ANIMATION_PAG
   1001        676E 00                   FCB $00          * Animation coura>>
   1002        676F               HERO_ANIMATION_DEL
   1003        676F 0000                 FDB $0000        * Animation coura>>
   1004        6771               HERO_ANIMATION_DRW
   1005        6771 0000                 FDB $0000        * Animation coura>>
   1006        6773               HERO_ANIMATION_IMC
   1007        6773 00                   FCB $00          * Animation coura>>
   1008        6774               HERO_ANIMATION_RTN_IMC
   1009        6774 00                   FCB $00          * Animation coura>>
   1010        6775               HERO_ANIMATION_FRR
   1011        6775 00                   FCB $00          * Animation coura>>

000000 Total Errors

000104 Total Symbols
     0x          Label 6300 BEGIN
     2x          Label 64F9 CLR_CART
     1x          Label 6512 CLR_CART_2
     1x          Label 652E CLR_CART_3
     1x          Label 66AB Compute_Position
     1x          Label 66C8 Compute_Position_01
     4x          Label 66E2 Compute_Position_02
     0x          Equ   0014 DEBUTECRANA
     0x          Equ   2014 DEBUTECRANB
     1x          Equ   622C DK_dernier_bloc_a_ecrire
     1x          Equ   6213 DK_destination
     1x          Equ   6205 DK_lecture
     1x          Equ   620A DK_piste
     1x          Equ   620F DK_secteur
     1x          Equ   1F40 FINECRANA
     1x          Equ   3F40 FINECRANB
     1x          Label 6555 FINTABPALETTE
     2x          Label 6764 HERO_ACCELERATION
    13x          Label 676A HERO_ANIMATION_ADR
     2x          Label 676F HERO_ANIMATION_DEL
     4x          Label 6771 HERO_ANIMATION_DRW
     2x          Label 6775 HERO_ANIMATION_FRR
     5x          Label 6773 HERO_ANIMATION_IMC
     1x          Label 66E4 HERO_ANIMATION_LOAD
     3x          Label 66ED HERO_ANIMATION_LOAD_00
     2x          Label 66FA HERO_ANIMATION_LOAD_01
     1x          Label 672C HERO_ANIMATION_LOAD_FE
     1x          Label 671C HERO_ANIMATION_LOAD_NOPAGE
     1x          Label 673A HERO_ANIMATION_NEXT
     1x          Label 6740 HERO_ANIMATION_NEXT_00
     6x          Label 676E HERO_ANIMATION_PAG
     2x          Label 676C HERO_ANIMATION_RTN_ADR
     1x          Label 6774 HERO_ANIMATION_RTN_IMC
     4x          Label 6766 HERO_DECELERATION
     2x          Label 6768 HERO_FRICTION
    17x          Label 6756 HERO_G_SPEED
     1x          Label 674A HERO_IDLE_L
     0x          Label 674A HERO_IDLE_L2
     2x          Label 674A HERO_IDLE_R
     2x          Equ   0600 HERO_JOG_SPD_LIMIT
     1x          Label 656F Hero_Move
     1x          Label 65E1 Hero_MoveLeft
     1x          Label 65FB Hero_MoveLeft_00
     1x          Label 6619 Hero_MoveLeft_01
     1x          Label 65F5 Hero_MoveLeft_03
     1x          Label 6625 Hero_MoveRight
     1x          Label 663C Hero_MoveRight_00
     1x          Label 665A Hero_MoveRight_01
     1x          Label 6636 Hero_MoveRight_03
    11x          Label 6663 Hero_MoveUpdatePos
     1x          Label 667D Hero_MoveUpdatePos_00
     1x          Label 6694 Hero_MoveUpdatePos_01
     0x          Label 6694 Hero_MoveUpdatePos_03
     2x          Label 667C Hero_MoveUpdatePos_V00
     3x          Label 6762 HERO_NEG_TOP_SPEED
     1x          Label 6578 Hero_NotLeft
     1x          Label 657F Hero_NotLeftOrRight
     1x          Label 65B6 Hero_NotLeftOrRight_00
     1x          Label 659F Hero_NotLeftOrRight_01
     1x          Label 65B0 Hero_NotLeftOrRight_02
     1x          Label 65B3 Hero_NotLeftOrRight_03
     1x          Label 65CA Hero_NotLeftOrRight_11
     1x          Label 65DB Hero_NotLeftOrRight_12
     1x          Label 65DE Hero_NotLeftOrRight_13
     6x          Equ   9F02 HERO_POS
     1x          Label 674A HERO_RUN_L
     2x          Label 674A HERO_RUN_R
     0x          Label 674A HERO_SUBIDLE_B
     3x          Label 6760 HERO_TOP_SPEED
     2x          Label 674A HERO_WALK_L
     2x          Label 674A HERO_WALK_R
     0x          Equ   0400 HERO_WALK_SPD_LIMIT
     4x          Label 6754 HERO_X_POS
     2x          Label 6758 HERO_X_SPEED
     6x          Label 675A HERO_X_SPS
     4x          Label 6755 HERO_Y_POS
     1x          Label 675C HERO_Y_SPEED
     0x          Label 675E HERO_Y_SPS
     0x          Label 635C INIT_VID
     0x          Equ   000D JOY_B
     0x          Equ   0005 JOY_BD
     0x          Equ   0009 JOY_BG
     1x          Label 656E JOY_BTN_STATUS
     0x          Equ   000F JOY_C
     1x          Equ   0007 JOY_D
     2x          Label 656D JOY_DIR_STATUS
     1x          Equ   000B JOY_G
     0x          Equ   000E JOY_H
     0x          Equ   0006 JOY_HD
     0x          Equ   000A JOY_HG
     1x          Label 6555 JOY_READ
     1x          Label 63B7 MAIN
     2x          Label 6406 MEM_COPY_DATA_TO_CART
     2x          Label 64EC MEM_COPY_DATA_TO_CART_E
     1x          Label 640C MEM_COPY_DATA_TO_CART_LOOP
     1x          Label 64F4 MEM_COPY_DATA_TO_CART_S
     6x          Label 63D6 SCRC
     3x          Label 63F1 SCRC0
     1x          Label 6380 SETPALETTE
     1x          Equ   9F00 SSAVE
     1x          Label 6535 TABPALETTE
     1x          Label 63FB VSYNC
     1x          Label 63FB VSYNC_1
     1x          Label 6400 VSYNC_2

