/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : ./input/CODE/MAIN.ASM
 * Fichier destination : MAIN.BIN
 * Contenu :
 *     Main     0:MAIN.ASM     14105
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
     12        8000                      ORG $8000
     13
     14                           *****************************************>>
     15                           * Constantes et variables
     16                           *****************************************>>
     17                  0014     DEBUTECRANA EQU $0014       * test pour f>>
     18                  1F40     FINECRANA   EQU $1F40       * fin de la R>>
     19                  2014     DEBUTECRANB EQU $2014       * test pour f>>
     20                  3F40     FINECRANB   EQU $3F40       * fin de la R>>
     21                  0005     JOY_BD EQU $05       * Bas Droite
     22                  0006     JOY_HD EQU $06       * Haut Droite
     23                  0007     JOY_D  EQU $07       * Droite
     24                  0009     JOY_BG EQU $09       * Bas Gauche
     25                  000A     JOY_HG EQU $0A       * Haut Gauche
     26                  000B     JOY_G  EQU $0B       * Gauche
     27                  000D     JOY_B  EQU $0D       * Bas
     28                  000E     JOY_H  EQU $0E       * Haut
     29                  000F     JOY_C  EQU $0F       * Centre
     30
     31        8000 0000          SSAVE FDB $0000
     32
     33                           *<ANIMATION_TABLE>
     34                           * Limite a 128 images par animations
     35
     36        8002 0018                 FDB $0018            * 00 Absolute>>
     37        8004               HERO_IDLE_L
     38        8004 01                   FCB $01                     * Page>>
     39        8005 A000                 FDB $A000            * Adresse drw>>
     40        8007 A000                 FDB $A000            * Adresse del>>
     41        8009 01                   FCB $01                     * Page>>
     42        800A A000                 FDB $A000            * Adresse drw>>
     43        800C A000                 FDB $A000            * Adresse del>>
     44        800E 01                   FCB $01                     * Page>>
     45        800F A000                 FDB $A000            * Adresse drw>>
     46        8011 A000                 FDB $A000            * Adresse del>>
     47        8013 FF                   FCB $FF                     * FF B>>
     48        8014 0000                 FDB $0000            * 00 image de>>
     49        8016 0000                 FDB $0000            * non utilise>>
     50        8018 01                   FCB $01                     * Page>>
     51        8019 A000                 FDB $A000            * Adresse drw>>
     52        801B A000                 FDB $A000            * Adresse del>>
     53        801D FF                   FCB $FF                     * FF B>>
     54        801E 0000                 FDB $0000            * 00 image de>>
     55        8020 0000                 FDB $0000            * non utilise>>
     56                            
     57        8022 0018                 FDB $0018            * 00 Absolute>>
     58        8024               HERO_IDLE_R
     59        8024 01                   FCB $01                     * Page>>
     60        8025 A000                 FDB $A000            * Adresse drw>>
     61        8027 A000                 FDB $A000            * Adresse del>>
     62        8029 01                   FCB $01                     * Page>>
     63        802A A000                 FDB $A000            * Adresse drw>>
     64        802C A000                 FDB $A000            * Adresse del>>
     65        802E 01                   FCB $01                     * Page>>
     66        802F A000                 FDB $A000            * Adresse drw>>
     67        8031 A000                 FDB $A000            * Adresse del>>
     68        8033 FE                   FCB $FE                     * FE d>>
     69        8034 0000                 FDB $0000            * 00 unused 0>>
(70) Expression Error
     70        FDB HERO_IDLE-C * adresse animation cible
     71
     72        8036 0018                 FDB $0018            * 00 Absolute>>
     73        8038               HERO_IDLE_L2
     74        8038 01                   FCB $01                     * Page>>
     75        8039 A000                 FDB $A000            * Adresse drw>>
     76        803B A000                 FDB $A000            * Adresse del>>
     77        803D FD                   FCB $FD                     * FD s>>
     78        803E 0000                 FDB $0000            * 00 unused 0>>
(79) Expression Error
     79        FDB HERO_IDLE_B * animation cible
     80        8040 01                   FCB $01                     * Page>>
     81        8041 A000                 FDB $A000            * Adresse drw>>
     82        8043 A000                 FDB $A000            * Adresse del>>
     83        8045 FF                   FCB $FF                     * FF B>>
     84        8046 0000                 FDB $000             * 01 image de>>
     85        8048 0000                 FDB $0000            * non utilise>>
     86                            
     87        804A 0018                 FDB $0018            * 00 Absolute>>
     88        804C               HERO_SUBIDLE_B
     89        804C 01                   FCB $01                     * Page>>
     90        804D A000                 FDB $A000            * Adresse drw>>
     91        804F A000                 FDB $A000            * Adresse del>>
     92        8051 00FC                 FDB $FC                     * FC r>>
     93                            
     94        8053               HERO_WALK_L
     95        8053               HERO_WALK_R
     96        8053               HERO_RUN_L
     97        8053               HERO_RUN_R
     98
     99                           *****************************************>>
    100                           * Debut du programme
    101                           *****************************************>>
    102  2     8053 1A   50              ORCC #$50     * a documenter (inte>>
    103                            
    104  2     8055 86   7B              LDA #$7B      * passage en mode 16>>
    105  5     8057 B7   E7DC            STA $E7DC
    106
    107                           *****************************************>>
    108                           * Initialisation de la palette de couleur>>
    109                           *****************************************>>
    110  4     805A 108E 82F3            LDY #TABPALETTE
    111  2     805E 4F                   CLRA
    112        805F               SETPALETTE
    113  5+1   805F 34   02              PSHS A
    114  2     8061 48                   ASLA
    115  5     8062 B7   E7DB            STA $E7DB
    116  5+3   8065 EC   A1              LDD ,Y++
    117  5     8067 F7   E7DA            STB $E7DA
    118  5     806A B7   E7DA            STA $E7DA
    119  5+1   806D 35   02              PULS A
    120  2     806F 4C                   INCA
    121  5     8070 108C 8313            CMPY #FINTABPALETTE
    122  3     8074 26   ED              BNE    SETPALETTE
    123
    124                           *****************************************>>
    125                           * Initialisation de la routine de commuta>>
    126                           *****************************************>>
    127  5     8076 F6   6081            LDB $6081 * A documenter
    128  2     8079 CA   10              ORB #$10  * mettre le bit d4 a 1
    129  5     807B F7   6081            STB $6081
    130  5     807E F7   E7E7            STB $E7E7
    131  8     8081 BD   80C2            JSR SCRC * page 2 en RAM Cartouche>>
    132
    133                           *****************************************>>
    134                           * Initialisation des deux pages videos av>>
    135                           *****************************************>>
    136  3     8084 8E   8024            LDX #HERO_IDLE_R
    137  8     8087 BD   8313            JSR HERO_ANIMATION_LOAD
    138
    139        808A 01                   FCB $01
    140        808B               INIT_SCREEN
    141  2     808B C6   03              LDB #$03                          >>
    142  5     808D F7   E7E5            STB $E7E5                         >>
    143  8     8090 BD   8284            JSR DRAW_RAM_DATA_TO_CART_160x200
    144                            
    145  5     8093 F6   8397            LDB HERO_ANIMATION_PAG            >>
    146  5     8096 F7   E7E5            STB $E7E5                         >>
    147  7+3   8099 AD   9F 839A         JSR [HERO_ANIMATION_DRW]          >>
    148                            
    149  8     809D BD   80C2            JSR SCRC                          >>
    150                                                                    >>
(151) Bad Operand
    151        DEC -1,INIT_SCREEN
    152  3     80A0 24   ED              BCC INIT_SCREEN
    153
    154                           *****************************************>>
    155                           * Boucle principale
    156                           *****************************************>>
    157        80A2               MAIN
    158                                  * Effacement et affichage des spri>>
    159  5     80A2 F6   8397            LDB HERO_ANIMATION_PAG            >>
    160  5     80A5 F7   E7E5            STB $E7E5                         >>
(161) Expression Error
    161        JSR [HERO_ANIMATION_EFF]                  * Efface le sprite>>
    162  7+3   80A8 AD   9F 839A         JSR [HERO_ANIMATION_DRW]          >>
    163
    164                                  * Gestion des deplacements
    165  8     80AC BD   80F5            JSR JOY_READ
    166  8     80AF BD   810F            JSR Hero_Move
    167  8     80B2 BD   824B            JSR Compute_Position
    168
    169  8     80B5 BD   80C2            JSR SCRC                          >>
    170  3     80B8 20   EC              BRA MAIN
    171
    172                           *****************************************>>
    173                           * Changement de page ESPACE ECRAN (affich>>
    174                           *      $E7DD determine la page affichee d>>
    175                           *      D7=0 D6=0 D5=0 D4=0 (#$0_) : page >>
    176                           *      D7=0 D6=1 D5=0 D4=0 (#$4_) : page >>
    177                           *      D7=1 D6=0 D5=0 D4=0 (#$8_) : page >>
    178                           *      D7=1 D6=1 D5=0 D4=0 (#$C_) : page >>
    179                           *   D3 D2 D1 D0  (#$_0 a #$_F) : couleur >>
    180                           *   Remarque : D5 et D4 utilisable unique>>
    181                           *
    182                           * Changement de page ESPACE CARTOUCHE (ec>>
    183                           *      $E7E6 determine la page affichee d>>
    184                           *   D5 : 1 = espace cartouche recouvert p>>
    185                           *   D4 : 0 = CAS1N valide : banques 0-15 >>
    186                           *      D5=1 D4=0 D3=0 D2=0 D1=0 D0=0 (#$6>>
    187                           *   ...
    188                           *      D5=1 D4=0 D3=1 D2=1 D1=1 D0=1 (#$6>>
    189                           *      D5=1 D4=1 D3=0 D2=0 D1=0 D0=0 (#$7>>
    190                           *   ...
    191                           *      D5=1 D4=1 D3=1 D2=1 D1=1 D0=1 (#$7>>
    192                           *****************************************>>
    193        80BA               SCRC
    194  8     80BA BD   80EA            JSR VSYNC
    195
    196  5     80BD F6   80E1            LDB SCRC0+1
    197  2     80C0 C4   01              ANDB #$01
    198  5     80C2 B6   8397            LDA HERO_ANIMATION_PAG
(199) Expression Error
    199        ADDA B
    200  5     80C5 B7   8397            STA HERO_ANIMATION_PAG
    201                            
    202  5     80C8 F6   80E1            LDB SCRC0+1   * charge la valeur d>>
    203  2     80CB C4   80              ANDB #$80     * permute #$00 ou #$>>
    204  2     80CD CA   0F              ORB #$0F      * recharger la coule>>
    205  5     80CF F7   E7DD            STB $E7DD     * changement page da>>
    206  7     80D2 73   80E1            COM SCRC0+1   * modification du co>>
    207        80D5               SCRC0
    208  2     80D5 C6   00              LDB #$00
    209  2     80D7 C4   02              ANDB #$02     * permute #$60 ou #$>>
    210  2     80D9 CA   60              ORB #$60      * espace cartouche r>>
    211  5     80DB F7   E7E6            STB $E7E6     * changement page da>>
    212  5     80DE 39                   RTS                  * E7E6 D5=1 p>>
    213                                                       * CAS1N : ban>>
    214
    215                           *****************************************>>
    216                           * Attente VBL
    217                           *****************************************>>
    218        80DF               VSYNC
    219        80DF               VSYNC_1
    220  7     80DF 7D   E7E7            TST    $E7E7
    221  3     80E2 2A   06              BPL    VSYNC_1
    222        80E4               VSYNC_2
    223  7     80E4 7D   E7E7            TST    $E7E7
    224  3     80E7 2B   06              BMI    VSYNC_2
    225  5     80E9 39                   RTS
    226
    227                           ****************************************
    228                           * Get joystick parameters
    229                           ****************************************
    230        80EA               JOY_READ
    231  3     80EA 8E   E7CF            ldx    #$e7cf
    232  4     80ED 108E E7CD            ldy    #$e7cd
    233  3     80F1 CC   400F            ldd    #$400f
    234  5     80F4 F4   E7CC            andb   >$e7cc     * Read position
    235  5     80F7 F7   810D            stb    JOY_DIR_STATUS
    236  4+0   80FA A4   A4              anda   ,y         * Read button
    237  2     80FC 88   40              eora   #$40
    238  5     80FE B7   810E            sta    JOY_BTN_STATUS
    239  5     8101 39                   RTS
    240        8102               JOY_DIR_STATUS
    241        8102 00                   FCB $00 * Position Pad
    242        8103               JOY_BTN_STATUS
    243        8103 00                   FCB $00 * 40 Bouton A enfonce
    244
    245                           *****************************************>>
    246                           * Subroutine to      make HERO walk/run
    247                           *****************************************>>
    248        8104               Hero_Move
    249  5     8104 B6   810D            LDA JOY_DIR_STATUS
    250  2     8107 81   0B              CMPA #JOY_G
    251  3     8109 26   0D              BNE Hero_NotLeft
    252  3     810B 20   74              BRA Hero_MoveLeft
    253
    254        810D               Hero_NotLeft                   * XREF: He>>
    255  2     810D 81   07              CMPA #JOY_D
    256  3     810F 26   0E              BNE Hero_NotLeftOrRight
    257  5     8111 16   00B1            LBRA Hero_MoveRight
    258
    259        8114               Hero_NotLeftOrRight            * XREF: He>>
    260  6     8114 FC   837F            LDD HERO_G_SPEED
    261  5     8117 1083 0000            CMPD #$0000
    262  3     811B 2D   39              BLT Hero_NotLeftOrRight_00 * se de>>
    263  7     811D B3   8391            SUBD HERO_FRICTION     * se deplac>>
    264  3     8120 24   1D              BCC Hero_NotLeftOrRight_01 * si on>>
    265  3     8122 CC   0000            LDD #$0000
    266  6     8125 FD   837F            STD HERO_G_SPEED
    267  6     8128 FD   8383            STD HERO_X_SPS
    268  3     812B 8E   8024            LDX #HERO_IDLE_R        * Charge a>>
    269  6     812E BF   8393            STX HERO_ANIMATION_ADR      * Sauv>>
    270  5     8131 16   00CF            LBRA Hero_MoveUpdatePos
    271        8134               Hero_NotLeftOrRight_01
    272  5     8134 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    273  3     8138 2C   16              BGE Hero_NotLeftOrRight_02
    274  6     813A FD   837F            STD HERO_G_SPEED
    275  3     813D 8E   8057            LDX #HERO_WALK_R        * Charge a>>
    276  6     8140 BF   8393            STX HERO_ANIMATION_ADR      * Sauv>>
    277  3     8143 20   0E              BRA Hero_NotLeftOrRight_03
    278        8145               Hero_NotLeftOrRight_02
    279  6     8145 FD   837F            STD HERO_G_SPEED
    280        8148               Hero_NotLeftOrRight_03
    281  5     8148 16   00B8            LBRA Hero_MoveUpdatePos
    282        814B               Hero_NotLeftOrRight_00
    283  7     814B F3   8391            ADDD HERO_FRICTION     * se deplac>>
    284  3     814E 24   1A              BCC Hero_NotLeftOrRight_11 * si on>>
    285  3     8150 CC   0000            LDD #$0000
    286  6     8153 FD   837F            STD HERO_G_SPEED
    287  3     8156 8E   8004            LDX #HERO_IDLE_L        * Charge a>>
    288  6     8159 BF   8393            STX HERO_ANIMATION_ADR      * Sauv>>
    289  5     815C 16   00A4            LBRA Hero_MoveUpdatePos
    290        815F               Hero_NotLeftOrRight_11
    291  5     815F 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    292  3     8163 2F   16              BLE Hero_NotLeftOrRight_12
    293  6     8165 FD   837F            STD HERO_G_SPEED
    294  3     8168 8E   8057            LDX #HERO_WALK_L        * Charge a>>
    295  6     816B BF   8393            STX HERO_ANIMATION_ADR      * Sauv>>
    296  3     816E 20   0E              BRA Hero_NotLeftOrRight_13
    297        8170               Hero_NotLeftOrRight_12
    298  6     8170 FD   837F            STD HERO_G_SPEED
    299        8173               Hero_NotLeftOrRight_13
    300  5     8173 16   008D            LBRA Hero_MoveUpdatePos
    301
    302        8176               Hero_MoveLeft                      * XREF>>
    303  6     8176 FC   837F            LDD HERO_G_SPEED            * Char>>
    304  5     8179 1083 0000            CMPD #$0000                 * Test>>
    305  3     817D 2F   1C              BLE Hero_MoveLeft_00        * BRAN>>
    306  7     817F B3   838F            SUBD HERO_DECELERATION      * orie>>
    307  3     8182 24   11              BCC Hero_MoveLeft_03        * BRAN>>
    308  3     8184 CC   0000            LDD #$0000
    309  7     8187 B3   838F            SUBD HERO_DECELERATION      * si l>>
    310        818A               Hero_MoveLeft_03
    311  6     818A FD   837F            STD HERO_G_SPEED            * On s>>
    312  5     818D 16   0073            LBRA Hero_MoveUpdatePos           >>
    313        8190               Hero_MoveLeft_00                         >>
    314                           *      CMPD #$0000                       >>
    315                           *      BNE Hero_MoveLeft_02        * BRAN>>
    316                           *      LDD #$FEFF                        >>
    317                           *Hero_MoveLeft_02
    318  8     8190 10B3 838B            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    319  3     8194 27   6D              BEQ Hero_MoveUpdatePos      * vite>>
    320  7     8196 B3   838D            SUBD HERO_ACCELERATION      * acce>>
    321  8     8199 10B3 838B            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    322  3     819D 2E   1A              BGT Hero_MoveLeft_01        * BRAN>>
    323  3     819F 8E   8057            LDX #HERO_RUN_L        * Charge an>>
    324  6     81A2 BF   8393            STX HERO_ANIMATION_ADR      * Sauv>>
    325  6     81A5 FC   838B            LDD HERO_NEG_TOP_SPEED      * Limi>>
    326  6     81A8 FD   837F            STD HERO_G_SPEED            * Enre>>
    327  5     81AB 16   0055            LBRA Hero_MoveUpdatePos     * Mise>>
    328        81AE               Hero_MoveLeft_01
    329  6     81AE FD   837F            STD HERO_G_SPEED            * Enre>>
    330  3     81B1 8E   8057            LDX #HERO_WALK_L        * Charge a>>
    331  6     81B4 BF   8393            STX HERO_ANIMATION_ADR      * Sauv>>
    332  5     81B7 16   0049            LBRA Hero_MoveUpdatePos
    333
    334        81BA               Hero_MoveRight                  * XREF: H>>
    335  6     81BA FC   837F            LDD HERO_G_SPEED        * Chargeme>>
    336  5     81BD 1083 0000            CMPD #$0000                 * Test>>
    337  3     81C1 2C   19              BGE Hero_MoveRight_00       * BRAN>>
    338  7     81C3 F3   838F            ADDD HERO_DECELERATION      * orie>>
    339  3     81C6 24   0E              BCC Hero_MoveRight_03       * BRAN>>
    340  6     81C8 FC   838F            LDD HERO_DECELERATION   * si la vi>>
    341        81CB               Hero_MoveRight_03
    342  6     81CB FD   837F            STD HERO_G_SPEED        * On stock>>
    343  5     81CE 16   0032            LBRA Hero_MoveUpdatePos           >>
    344        81D1               Hero_MoveRight_00                  * Orie>>
    345                           *      CMPD #$0000                       >>
    346                           *      BNE Hero_MoveRight_02       * BRAN>>
    347                           *      LDD #$0100                        >>
    348                           *Hero_MoveRight_02
    349  8     81D1 10B3 8389            CMPD HERO_TOP_SPEED         * Comp>>
    350  3     81D5 27   2C              BEQ Hero_MoveUpdatePos      * vite>>
    351  7     81D7 F3   838D            ADDD HERO_ACCELERATION      * acce>>
    352  8     81DA 10B3 8389            CMPD HERO_TOP_SPEED         * Comp>>
    353  3     81DE 2D   1A              BLT Hero_MoveRight_01       * BRAN>>
    354  3     81E0 8E   8057            LDX #HERO_RUN_R                   >>
    355  6     81E3 BF   8393            STX HERO_ANIMATION_ADR      * Sauv>>
    356  6     81E6 FC   8389            LDD HERO_TOP_SPEED          * Limi>>
    357  6     81E9 FD   837F            STD HERO_G_SPEED            * Enre>>
    358  5     81EC 16   0014            LBRA Hero_MoveUpdatePos           >>
    359        81EF               Hero_MoveRight_01
    360  6     81EF FD   837F            STD HERO_G_SPEED            * Enre>>
    361  3     81F2 8E   8057            LDX #HERO_WALK_R        * Charge a>>
    362  6     81F5 BF   8393            STX HERO_ANIMATION_ADR      * Sauv>>
    363
    364        81F8               Hero_MoveUpdatePos
    365  6     81F8 FC   837F            LDD HERO_G_SPEED            * Char>>
    366  6     81FB FD   8381            STD HERO_X_SPEED        * Stockage>>
    367  5     81FE 1083 0000            CMPD #$0000                 * Test>>
    368  3     8202 2D   19              BLT Hero_MoveUpdatePos_00   * BRAN>>
    369  7     8204 F3   8383            ADDD HERO_X_SPS         * Ajout du>>
    370  5     8207 F7   8384            STB HERO_X_SPS+1            * sauv>>
    371  6     820A 1F   89              TFR A,B                     * Divi>>
    372  5     820C FB   837D            ADDB HERO_X_POS                   >>
    373  3     820F 20   23              BRA Hero_MoveUpdatePos_01
    374        8211               Hero_MoveUpdatePos_V00
    375        8211 00                   FCB $00
    376        8212               Hero_MoveUpdatePos_00
    377  3     8212 CC   0000            LDD #$0000
    378  7     8215 B3   8381            SUBD HERO_X_SPEED           * La v>>
    379  7     8218 F3   8383            ADDD HERO_X_SPS         * Ajout du>>
    380  5     821B F7   8384            STB HERO_X_SPS+1            * sauv>>
    381  6     821E 1F   89              TFR A,B                     * Divi>>
    382  5     8220 F7   821C            STB Hero_MoveUpdatePos_V00
    383  5     8223 F6   837D            LDB HERO_X_POS
    384  5     8226 F0   821C            SUBB Hero_MoveUpdatePos_V00 * Ajou>>
    385        8229               Hero_MoveUpdatePos_01
    386                           *      CMPB #$50                         >>
    387                           *      BLE Hero_MoveUpdatePos_02   * Bute>>
    388                           *      LDB #$50                          >>
    389                           *Hero_MoveUpdatePos_02
    390                           *    CMPB #$0C                           >>
    391                           *      BGE Hero_MoveUpdatePos_03   * Bute>>
    392                           *      LDB #$0C                          >>
    393        8229               Hero_MoveUpdatePos_03
    394  5     8229 F7   837D            STB HERO_X_POS
    395  2     822C C6   00              LDB #$00
(396) Expression Error
    396        STB TEST1X10_X_SPS                 * reste subpixel est sur >>
    397  3     822E CC   0000            LDD #$0000                  * TODO>>
    398  6     8231 FD   8385            STD HERO_Y_SPEED
    399  6     8234 1F   89              TFR A,B                     * divi>>
    400  5     8236 FB   837E            ADDB HERO_Y_POS
    401  5     8239 F7   837E            STB HERO_Y_POS
    402  5     823C 39                   RTS
    403
    404                           * TODO : Braking Animation
    405                           * Sonic enters his braking animation when>>
    406                           * In Sonic 1 and Sonic CD, he then stays >>
    407                           * In the other 3 games, Sonic returns to >>
    408
    409        823D               Compute_Position
    410  5     823D B6   837D            LDA HERO_X_POS
    411  2     8240 44                   LSRA
    412  3     8241 25   25              BCS Compute_Position_01
    413  5     8243 B7   8283            STA Compute_Position_02+1
    414  2     8246 86   28              LDA #$28
    415  5     8248 F6   837E            LDB HERO_Y_POS
    416  2     824B 5A                   DECB
    417  11    824C 3D                   MUL
    418  7     824D F3   8282            ADDD Compute_Position_02
(419) Expression Error
    419        STD POS_HERO0000
    420  4     8250 C3   2000            ADDD #$2000
(421) Expression Error
    421        STD POS_HERO0000+2
    422  5     8253 39                   RTS
    423        8254               Compute_Position_01
    424  5     8254 B7   8283            STA Compute_Position_02+1
    425  2     8257 86   28              LDA #$28
    426  5     8259 F6   837E            LDB HERO_Y_POS
    427  2     825C 5A                   DECB
    428  11    825D 3D                   MUL
    429  7     825E F3   8282            ADDD Compute_Position_02
    430  4     8261 C3   2000            ADDD #$2000
(431) Expression Error
    431        STD POS_HERO0000
    432  4     8264 83   1FFF            SUBD #$1FFF
(433) Expression Error
    433        STD POS_HERO0000+2
    434  5     8267 39                   RTS
    435        8268               Compute_Position_02
    436        8268 0000                 FDB $0000
    437                            
    438                           *****************************************>>
    439                           * Affichage de l arriere plan xxx cycles
    440                           *****************************************>>
    441        826A               DRAW_RAM_DATA_TO_CART_160x200
    442  5+3   826A 34   48              PSHS U,DP            * sauvegarde >>
    443  7     826C 10FF 8000            STS >SSAVE
    444                            
    445  4     8270 10CE 1F40            LDS #FINECRANA       * init pointe>>
    446  3     8274 CE   A000            LDU #$A000
    447
    448        8277               DRAW_RAM_DATA_TO_CART_160x200A
    449  5+7   8277 37   3E              PULU A,B,DP,X,Y
    450  5+7   8279 34   3E              PSHS Y,X,DP,B,A
    451  5+7   827B 37   3E              PULU A,B,DP,X,Y
    452  5+7   827D 34   3E              PSHS Y,X,DP,B,A
    453  5+7   827F 37   3E              PULU A,B,DP,X,Y
    454  5+7   8281 34   3E              PSHS Y,X,DP,B,A
    455  5+7   8283 37   3E              PULU A,B,DP,X,Y
    456  5+7   8285 34   3E              PSHS Y,X,DP,B,A
    457  5+7   8287 37   3E              PULU A,B,DP,X,Y
    458  5+7   8289 34   3E              PSHS Y,X,DP,B,A
    459  5+7   828B 37   3E              PULU A,B,DP,X,Y
    460  5+7   828D 34   3E              PSHS Y,X,DP,B,A
    461  5     828F 118C 0014            CMPS #DEBUTECRANA
    462  3     8293 26   FC              BNE DRAW_RAM_DATA_TO_CART_160x200A>>
    463  5+7   8295 37   3E              PULU A,B,DP,X,Y
    464  5+7   8297 34   3E              PSHS Y,X,DP,B,A
    465  5+7   8299 37   3E              PULU A,B,DP,X,Y
    466  5+7   829B 34   3E              PSHS Y,X,DP,B,A
    467  5+6   829D 37   3C              PULU B,DP,X,Y
    468  5+6   829F 34   3C              PSHS Y,X,DP,B
    469
    470  4     82A1 10CE 3F40            LDS #FINECRANB       * init pointe>>
    471  3     82A5 CE   C000            LDU #$C000
    472
    473        82A8               DRAW_RAM_DATA_TO_CART_160x200B
    474  5+7   82A8 37   3E              PULU A,B,DP,X,Y
    475  5+7   82AA 34   3E              PSHS Y,X,DP,B,A
    476  5+7   82AC 37   3E              PULU A,B,DP,X,Y
    477  5+7   82AE 34   3E              PSHS Y,X,DP,B,A
    478  5+7   82B0 37   3E              PULU A,B,DP,X,Y
    479  5+7   82B2 34   3E              PSHS Y,X,DP,B,A
    480  5+7   82B4 37   3E              PULU A,B,DP,X,Y
    481  5+7   82B6 34   3E              PSHS Y,X,DP,B,A
    482  5+7   82B8 37   3E              PULU A,B,DP,X,Y
    483  5+7   82BA 34   3E              PSHS Y,X,DP,B,A
    484  5+7   82BC 37   3E              PULU A,B,DP,X,Y
    485  5+7   82BE 34   3E              PSHS Y,X,DP,B,A
    486  5     82C0 118C 2014            CMPS #DEBUTECRANB
    487  3     82C4 26   FC              BNE DRAW_RAM_DATA_TO_CART_160x200B>>
    488  5+7   82C6 37   3E              PULU A,B,DP,X,Y
    489  5+7   82C8 34   3E              PSHS Y,X,DP,B,A
    490  5+7   82CA 37   3E              PULU A,B,DP,X,Y
    491  5+7   82CC 34   3E              PSHS Y,X,DP,B,A
    492  5+6   82CE 37   3C              PULU B,DP,X,Y
    493  5+6   82D0 34   3C              PSHS Y,X,DP,B
    494
    495  7     82D2 10FE 8000            LDS  >SSAVE          * rechargemen>>
    496  5+3   82D6 35   48              PULS U,DP
    497  5     82D8 39                   RTS
    498                            
    499                           *****************************************>>
    500                           * Palette de 16 couleurs
    501                           *****************************************>>
    502        82D9               TABPALETTE
    503        82D9 0111                 FDB $0111     * index:0  R:51  V:5>>
    504        82DB 0143                 FDB $0143     * index:1  R:108 V:1>>
    505        82DD 0113                 FDB $0113     * index:2  R:107 V:5>>
    506        82DF 0484                 FDB $0484     * index:3  R:132 V:1>>
    507        82E1 0112                 FDB $0112     * index:4  R:92  V:6>>
    508        82E3 0247                 FDB $0247     * index:5  R:180 V:1>>
    509        82E5 0233                 FDB $0233     * index:6  R:116 V:1>>
    510        82E7 0177                 FDB $0177     * index:7  R:172 V:1>>
    511        82E9 0111                 FDB $0111     * index:8  R:60  V:5>>
    512        82EB 0016                 FDB $0016     * index:9  R:164 V:6>>
    513        82ED 0698                 FDB $0698     * index:10 R:187 V:1>>
    514        82EF 0344                 FDB $0344     * index:11 R:132 V:1>>
    515        82F1 0221                 FDB $0221     * index:12 R:68  V:9>>
    516        82F3 0452                 FDB $0452     * index:13 R:92  V:1>>
    517        82F5 0356                 FDB $0356     * index:14 R:164 V:1>>
    518        82F7 0125                 FDB $0125     * index:15 R:140 V:1>>
    519        82F9               FINTABPALETTE
    520
    521                           *****************************************>>
    522                           * HERO Animations
    523                           *****************************************>>
    524
    525        82F9               HERO_ANIMATION_LOAD                      >>
    526  6     82F9 BF   8393            STX HERO_ANIMATION_ADR
    527  7     82FC 7F   839C            CLR HERO_ANIMATION_IMC            >>
    528        82FF               HERO_ANIMATION_LOAD_00
    529  6     82FF BE   8393            LDX HERO_ANIMATION_ADR
    530  6     8302 BF   8395            STX HERO_ANIMATION_RTN_ADR
    531  5+1   8305 EC   1E              LDD -2,X                          >>
    532  2     8307 81   00              CMPA #$00                         >>
    533  3     8309 27   21              BEQ HERO_ANIMATION_LOAD_01
    534  5     830B F0   837F            SUBB HERO_G_SPEED                 >>
    535  3     830E 24   1C              BCC HERO_ANIMATION_LOAD_01
    536  2     8310 C6   01              LDB #$01                          >>
    537        8312               HERO_ANIMATION_LOAD_01
    538  5     8312 F7   839E            STB HERO_ANIMATION_FRR            >>
    539  5     8315 B6   839C            LDA HERO_ANIMATION_IMC
    540  2     8318 C6   05              LDB #$05
    541  11    831A 3D                   MUL
    542  4+4   831B E6   8B              LDB D,X+                          >>
    543  2     831D C1   1F              CMPB #$1F                         >>
    544  3     831F 22   2C              BHI HERO_ANIMATION_LOAD_NOPAGE
    545  5     8321 F7   8397            STB HERO_ANIMATION_PAG
    546  6+4   8324 10AE 8B              LDY D,X++
    547  7     8327 10BF 839A            STY HERO_ANIMATION_DRW
    548  6+4   832B 10AE 8B              LDY D,X
    549  7     832E 10BF 8398            STY HERO_ANIMATION_DEL
    550  5     8332 39                   RTS
    551        8333               HERO_ANIMATION_LOAD_NOPAGE
    552  2     8333 C1   FF              CMPB #$FF
    553  3     8335 26   2D              BNE HERO_ANIMATION_LOAD_FE
    554  6+4   8337 10AE 8B              LDY D,X++
    555  7     833A 10BF 8393            STY HERO_ANIMATION_ADR
    556  4+4   833E E6   8B              LDB D,X+
    557  5     8340 F7   839C            STB HERO_ANIMATION_IMC
    558  4+4   8343 E6   8B              LDB D,X+
    559  5     8345 F7   839D            STB HERO_ANIMATION_RTN_IMC
    560  3     8348 20   CF              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    561        834A               HERO_ANIMATION_LOAD_FE
    562  6     834A BE   8395            LDX HERO_ANIMATION_RTN_ADR  * RETU>>
    563  6     834D BF   8393            STX HERO_ANIMATION_ADR
    564  5     8350 F6   839D            LDB HERO_ANIMATION_RTN_IMC
    565  5     8353 F7   839C            STB HERO_ANIMATION_IMC
    566  3     8356 20   C1              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    567
    568        8358               HERO_ANIMATION_NEXT
    569  7     8358 7A   839E            DEC HERO_ANIMATION_FRR
    570  3     835B 27   1B              BEQ HERO_ANIMATION_NEXT_00  * BRAN>>
    571  5     835D 39                   RTS
    572        835E               HERO_ANIMATION_NEXT_00
    573  7     835E 7C   839C            INC HERO_ANIMATION_IMC
    574  3     8361 20   B6              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    575
    576                           *   CODE SPECIAUX ANIMATION
    577                           *      -----------------------
    578                           *      FCB $FF                     * FF S>>
    579                           *      FDB HERO_IDLE-C * adresse animatio>>
    580                           *      FDB $0301            * 03 image ci>>
    581                           *
    582                           *      FCB $FE                     * FE R>>
    583
    584                           *****************************************>>
    585                           * HERO Variables
    586                           *****************************************>>
    587                  0400     HERO_WALK_SPD_LIMIT EQU $0400
    588                  0600     HERO_JOG_SPD_LIMIT  EQU $0600
    589        8363               HERO_X_POS
    590        8363 50                   FCB $50                     * Hori>>
    591        8364               HERO_Y_POS
    592        8364 C8                   FCB $C8                     * Vert>>
    593        8365               HERO_G_SPEED         * Ground Speed
    594        8365 0000                 FDB $0000            * First byte >>
    595        8367               HERO_X_SPEED
    596        8367 0000                 FDB $0000            * Horizontal >>
    597        8369               HERO_X_SPS
    598        8369 0000                 FDB $0000            * Subpixel X >>
    599        836B               HERO_Y_SPEED
    600        836B 0000                 FDB $0000            * Vertical Sp>>
    601        836D               HERO_Y_SPS
    602        836D 0000                 FDB $0000            * Subpixel Y >>
    603        836F               HERO_TOP_SPEED
    604        836F 0600                 FDB $0600        * vitesse maximum>>
    605        8371               HERO_NEG_TOP_SPEED
    606        8371 FA00                 FDB $FA00        * vitesse maximum>>
    607        8373               HERO_ACCELERATION
    608        8373 000C                 FDB $000C        * constante accel>>
    609        8375               HERO_DECELERATION
    610        8375 0080                 FDB $0080        * constante decel>>
    611        8377               HERO_FRICTION
    612        8377 000C                 FDB $000C        * constante de fr>>
    613        8379               HERO_ANIMATION_ADR
    614        8379 0000                 FDB $0000        * Animation coura>>
    615        837B               HERO_ANIMATION_RTN_ADR
    616        837B 0000                 FDB $0000        * Animation coura>>
    617        837D               HERO_ANIMATION_PAG
    618        837D 00                   FCB $00          * Animation coura>>
    619        837E               HERO_ANIMATION_DEL
    620        837E 0000                 FDB $0000        * Animation coura>>
    621        8380               HERO_ANIMATION_DRW
    622        8380 0000                 FDB $0000        * Animation coura>>
    623        8382               HERO_ANIMATION_IMC
    624        8382 00                   FCB $00          * Animation coura>>
    625        8383               HERO_ANIMATION_RTN_IMC
    626        8383 00                   FCB $00          * Animation coura>>
    627        8384               HERO_ANIMATION_FRR
    628        8384 00                   FCB $00          * Animation coura>>

000010 Total Errors
        Expression Error      70        FDB HERO_IDLE-C * adresse animation>>
        Expression Error      79        FDB HERO_IDLE_B * animation cible
             Bad Operand     151        DEC -1,INIT_SCREEN
        Expression Error     161        JSR [HERO_ANIMATION_EFF]           >>
        Expression Error     199        ADDA B
        Expression Error     396        STB TEST1X10_X_SPS                 >>
        Expression Error     419        STD POS_HERO0000
        Expression Error     421        STD POS_HERO0000+2
        Expression Error     431        STD POS_HERO0000
        Expression Error     433        STD POS_HERO0000+2

000100 Total Symbols
     1x Unknown  Equ   0000 B
     1x Unknown  Equ   0000 C
     1x          Label 824B Compute_Position
     1x          Label 8268 Compute_Position_01
     4x          Label 8282 Compute_Position_02
     1x          Equ   0014 DEBUTECRANA
     1x          Equ   2014 DEBUTECRANB
     1x          Label 8284 DRAW_RAM_DATA_TO_CART_160x200
     1x          Label 8291 DRAW_RAM_DATA_TO_CART_160x200A
     1x          Label 82C2 DRAW_RAM_DATA_TO_CART_160x200B
     1x          Equ   1F40 FINECRANA
     1x          Equ   3F40 FINECRANB
     1x          Label 8313 FINTABPALETTE
     2x          Label 838D HERO_ACCELERATION
    12x          Label 8393 HERO_ANIMATION_ADR
     1x          Label 8398 HERO_ANIMATION_DEL
     3x          Label 839A HERO_ANIMATION_DRW
     1x Unknown  Equ   0000 HERO_ANIMATION_EFF
     2x          Label 839E HERO_ANIMATION_FRR
     5x          Label 839C HERO_ANIMATION_IMC
     1x          Label 8313 HERO_ANIMATION_LOAD
     3x          Label 8319 HERO_ANIMATION_LOAD_00
     2x          Label 832C HERO_ANIMATION_LOAD_01
     1x          Label 8364 HERO_ANIMATION_LOAD_FE
     1x          Label 834D HERO_ANIMATION_LOAD_NOPAGE
     0x          Label 8372 HERO_ANIMATION_NEXT
     1x          Label 8378 HERO_ANIMATION_NEXT_00
     5x          Label 8397 HERO_ANIMATION_PAG
     2x          Label 8395 HERO_ANIMATION_RTN_ADR
     2x          Label 839D HERO_ANIMATION_RTN_IMC
     4x          Label 838F HERO_DECELERATION
     2x          Label 8391 HERO_FRICTION
    17x          Label 837F HERO_G_SPEED
     1x Unknown  Equ   0000 HERO_IDLE
     1x Unknown  Equ   0000 HERO_IDLE_B
     1x          Label 8004 HERO_IDLE_L
     0x          Label 803A HERO_IDLE_L2
     2x          Label 8024 HERO_IDLE_R
     2x          Equ   0600 HERO_JOG_SPD_LIMIT
     1x          Label 810F Hero_Move
     1x          Label 8181 Hero_MoveLeft
     1x          Label 819B Hero_MoveLeft_00
     1x          Label 81B9 Hero_MoveLeft_01
     1x          Label 8195 Hero_MoveLeft_03
     1x          Label 81C5 Hero_MoveRight
     1x          Label 81DC Hero_MoveRight_00
     1x          Label 81FA Hero_MoveRight_01
     1x          Label 81D6 Hero_MoveRight_03
    11x          Label 8203 Hero_MoveUpdatePos
     1x          Label 821D Hero_MoveUpdatePos_00
     1x          Label 8234 Hero_MoveUpdatePos_01
     0x          Label 8234 Hero_MoveUpdatePos_03
     2x          Label 821C Hero_MoveUpdatePos_V00
     3x          Label 838B HERO_NEG_TOP_SPEED
     1x          Label 8118 Hero_NotLeft
     1x          Label 811F Hero_NotLeftOrRight
     1x          Label 8156 Hero_NotLeftOrRight_00
     1x          Label 813F Hero_NotLeftOrRight_01
     1x          Label 8150 Hero_NotLeftOrRight_02
     1x          Label 8153 Hero_NotLeftOrRight_03
     1x          Label 816A Hero_NotLeftOrRight_11
     1x          Label 817B Hero_NotLeftOrRight_12
     1x          Label 817E Hero_NotLeftOrRight_13
     1x          Label 8057 HERO_RUN_L
     1x          Label 8057 HERO_RUN_R
     0x          Label 8050 HERO_SUBIDLE_B
     3x          Label 8389 HERO_TOP_SPEED
     2x          Label 8057 HERO_WALK_L
     2x          Label 8057 HERO_WALK_R
     0x          Equ   0400 HERO_WALK_SPD_LIMIT
     4x          Label 837D HERO_X_POS
     2x          Label 8381 HERO_X_SPEED
     5x          Label 8383 HERO_X_SPS
     4x          Label 837E HERO_Y_POS
     1x          Label 8385 HERO_Y_SPEED
     0x          Label 8387 HERO_Y_SPS
     1x          Label 808F INIT_SCREEN
     0x          Equ   000D JOY_B
     0x          Equ   0005 JOY_BD
     0x          Equ   0009 JOY_BG
     1x          Label 810E JOY_BTN_STATUS
     0x          Equ   000F JOY_C
     1x          Equ   0007 JOY_D
     2x          Label 810D JOY_DIR_STATUS
     1x          Equ   000B JOY_G
     0x          Equ   000E JOY_H
     0x          Equ   0006 JOY_HD
     0x          Equ   000A JOY_HG
     1x          Label 80F5 JOY_READ
     1x          Label 80A6 MAIN
     4x Unknown  Equ   0000 POS_HERO0000
     3x          Label 80C2 SCRC
     3x          Label 80E0 SCRC0
     1x          Label 8063 SETPALETTE
     2x          Label 8000 SSAVE
     1x          Label 82F3 TABPALETTE
     1x Unknown  Equ   0000 TEST1X10_X_SPS
     1x          Label 80EA VSYNC
     1x          Label 80EA VSYNC_1
     1x          Label 80EF VSYNC_2

