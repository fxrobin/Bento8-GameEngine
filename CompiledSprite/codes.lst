/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : ./input/CODE/MAIN.ASS
 * Fichier destination : TMP.BIN
 * Contenu :
 *     Main     0:MAIN.ASM     20024
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
     12        6300                      ORG $6300
     13
     14                           *****************************************>>
     15                           * Constantes et variables
     16                           *****************************************>>
     17
     18                  6205     DK_lecture               EQU $6205 * rout>>
     19                  620A     DK_piste                 EQU $620A * 2B n>>
     20                  620F     DK_secteur               EQU $620F * 1B n>>
     21                  6213     DK_destination           EQU $6213 * 2B d>>
     22                  622C     DK_dernier_bloc_a_ecrire EQU $622C * 2B f>>
     23
     24                  0014     DEBUTECRANA EQU $0014 * test pour fin sta>>
     25                  1F40     FINECRANA   EQU $1F40 * fin de la RAM A v>>
     26                  2014     DEBUTECRANB EQU $2014 * test pour fin sta>>
     27                  3F40     FINECRANB   EQU $3F40 * fin de la RAM B v>>
     28
     29                  0005     JOY_BD EQU $05 * Bas Droite
     30                  0006     JOY_HD EQU $06 * Haut Droite
     31                  0007     JOY_D  EQU $07 * Droite
     32                  0009     JOY_BG EQU $09 * Bas Gauche
     33                  000A     JOY_HG EQU $0A * Haut Gauche
     34                  000B     JOY_G  EQU $0B * Gauche
     35                  000D     JOY_B  EQU $0D * Bas
     36                  000E     JOY_H  EQU $0E * Haut
     37                  000F     JOY_C  EQU $0F * Centre
     38
     39                  9F00     SSAVE    EQU $9F00 * BUFFER for S when us>>
     40                  9F02     HERO_POS EQU $9F02
     41
     42                           *****************************************>>
     43                           * Debut du programme
     44                           *****************************************>>
     45        6300               BEGIN
     46  2     6300 1A   50              ORCC #$50     * a documenter (inte>>
     47                            
     48  3     6302 CC   0000            LDD #$0000     * Init variables gl>>
     49  6     6305 FD   9F00            STD SSAVE
     50  3     6308 CC   1F40            LDD #FINECRANA
     51  6     630B FD   9F02            STD HERO_POS
     52  3     630E CC   3F40            LDD #FINECRANB
     53  6     6311 FD   9F04            STD HERO_POS+2
     54
     55                           *****************************************>>
     56                           * Chargement des pages memoire
     57                           *****************************************>>
     58                                  * Chargement de la page 4 depuis l>>
     59                                  **********************************>>
     60  2     6314 C6   04              LDB #$04                       * O>>
     61  5     6316 F7   E7E5            STB $E7E5                      * e>>
     62                            
     63  3     6319 CC   0004            LDD #$0004
     64  6     631C FD   620A            STD DK_piste
     65  2     631F 86   01              LDA #$01
     66  5     6321 B7   620F            STA DK_secteur
     67  3     6324 CC   A000            LDD #$A000
     68  6     6327 FD   6213            STD DK_destination
     69  3     632A CC   DF00            LDD #$DF00
     70  6     632D FD   622C            STD DK_dernier_bloc_a_ecrire
     71  8     6330 BD   6205            JSR DK_lecture
     72                            
     73                                  * Copie de la page 4 en page 5
     74                                  ******************************
     75  2     6333 C6   65              LDB #$65                       * O>>
     76  5     6335 F7   E7E6            STB $E7E6                      * e>>
     77
     78  7     6338 10FF 64DB         STS MEM_COPY_DATA_TO_CART_S+2  * sauv>>
     79  4     633C 10CE A000         LDS #$A000                     * Sour>>
     80  4     6340 108E 4040         LDY #$4000+64                  * Nb B>>
     81  7     6344 10BF 64D3            STY MEM_COPY_DATA_TO_CART_E+2
     82  4     6348 108E 0040         LDY #$0000+64                  * Dest>>
     83  8     634C BD   63F1         JSR MEM_COPY_DATA_TO_CART      * Copi>>
     84                            
     85                                  * Initialisation de la page 0
     86                                  *****************************
     87  2     634F C6   60              LDB #$60                       * O>>
     88  5     6351 F7   E7E6            STB $E7E6                      * e>>
     89  8     6354 BD   64DE            JSR CLR_CART
     90                            
     91                           *****************************************>>
     92                           * Initialisation de la routine de commuta>>
     93                           *****************************************>>
     94        6357               INIT_VID
     95  5     6357 F6   6081            LDB $6081 * A documenter
     96  2     635A CA   10              ORB #$10  * mettre le bit d4 a 1
     97  5     635C F7   6081            STB $6081
     98  5     635F F7   E7E7            STB $E7E7
     99  8     6362 BD   63C1            JSR SCRC * page 2 en RAM Cartouche>>
    100
    101                           *****************************************>>
    102                           * Initialisation de la palette de couleur>>
    103                           *****************************************>>
    104  4     6365 108E 6718            LDY #TABPALETTE
    105  2     6369 4F                   CLRA
    106        636A               SETPALETTE
    107  5+1   636A 34   02              PSHS A
    108  2     636C 48                   ASLA
    109  5     636D B7   E7DB            STA $E7DB
    110  5+3   6370 EC   A1              LDD ,Y++
    111  5     6372 F7   E7DA            STB $E7DA
    112  5     6375 B7   E7DA            STA $E7DA
    113  5+1   6378 35   02              PULS A
    114  2     637A 4C                   INCA
    115  5     637B 108C 6738            CMPY #FINTABPALETTE
    116  3     637F 26   E9              BNE    SETPALETTE
    117
    118                           *****************************************>>
    119                           * Initialisation du mode video
    120                           *****************************************>>
    121  2     6381 86   7B              LDA #$7B      * passage en mode 16>>
    122  5     6383 B7   E7DC            STA $E7DC
    123
    124                           *****************************************>>
    125                           * Initialisation des deux pages videos av>>
    126                           *****************************************>>
    127  3     6386 8E   679E            LDX #HERO_IDLE_R
    128  8     6389 BD   6738            JSR HERO_ANIMATION_LOAD
    129
    130  8     638C BD   64DE            JSR CLR_CART
    131  5     638F F6   67C2            LDB HERO_ANIMATION_PAG            >>
    132  5     6392 F7   E7E5            STB $E7E5                         >>
    133  7+3   6395 AD   9F 67C5         JSR [HERO_ANIMATION_DRW]
    134  8     6399 BD   63C1            JSR SCRC                          >>
    135
    136  8     639C BD   64DE            JSR CLR_CART
    137  7+3   639F AD   9F 67C5         JSR [HERO_ANIMATION_DRW]
    138  8     63A3 BD   63C1            JSR SCRC                          >>
    139
    140                           *****************************************>>
    141                           * Boucle principale
    142                           *****************************************>>
    143        63A6               MAIN
    144                                  * Effacement et affichage des spri>>
    145  5     63A6 F6   67C2            LDB HERO_ANIMATION_PAG            >>
    146  5     63A9 F7   E7E5            STB $E7E5                         >>
    147                                  *JSR [HERO_ANIMATION_DEL]         >>
    148  7+3   63AC AD   9F 67C5         JSR [HERO_ANIMATION_DRW]          >>
    149
    150                                  * Gestion des deplacements
    151  8     63B0 BD   651A            JSR JOY_READ
    152  8     63B3 BD   6534            JSR Hero_Move
    153  8     63B6 BD   6670            JSR Compute_Position
    154                            
    155  8     63B9 BD   678E            JSR HERO_ANIMATION_NEXT
    156
    157  8     63BC BD   63C1            JSR SCRC                          >>
    158  3     63BF 20   E5              BRA MAIN
    159
    160                           *****************************************>>
    161                           * Changement de page ESPACE ECRAN (affich>>
    162                           *      $E7DD determine la page affichee d>>
    163                           *      D7=0 D6=0 D5=0 D4=0 (#$0_) : page >>
    164                           *      D7=0 D6=1 D5=0 D4=0 (#$4_) : page >>
    165                           *      D7=1 D6=0 D5=0 D4=0 (#$8_) : page >>
    166                           *      D7=1 D6=1 D5=0 D4=0 (#$C_) : page >>
    167                           *   D3 D2 D1 D0  (#$_0 a #$_F) : couleur >>
    168                           *   Remarque : D5 et D4 utilisable unique>>
    169                           *
    170                           * Changement de page ESPACE CARTOUCHE (ec>>
    171                           *      $E7E6 determine la page affichee d>>
    172                           *   D5 : 1 = espace cartouche recouvert p>>
    173                           *   D4 : 0 = CAS1N valide : banques 0-15 >>
    174                           *      D5=1 D4=0 D3=0 D2=0 D1=0 D0=0 (#$6>>
    175                           *   ...
    176                           *      D5=1 D4=0 D3=1 D2=1 D1=1 D0=1 (#$6>>
    177                           *      D5=1 D4=1 D3=0 D2=0 D1=0 D0=0 (#$7>>
    178                           *   ...
    179                           *      D5=1 D4=1 D3=1 D2=1 D1=1 D0=1 (#$7>>
    180                           *****************************************>>
    181        63C1               SCRC
    182  8     63C1 BD   63E6            JSR VSYNC
    183
    184  5     63C4 F6   63DD            LDB SCRC0+1
    185  2     63C7 C4   01              ANDB #$01
    186  5     63C9 FB   67C2            ADDB HERO_ANIMATION_PAG
    187  5     63CC F7   67C2            STB HERO_ANIMATION_PAG
    188                            
    189  5     63CF F6   63DD            LDB SCRC0+1   * charge la valeur d>>
    190  2     63D2 C4   80              ANDB #$80     * permute #$00 ou #$>>
    191  2     63D4 CA   00              ORB #$00      * recharger la coule>>
    192  5     63D6 F7   E7DD            STB $E7DD     * changement page da>>
    193  7     63D9 73   63DD            COM SCRC0+1   * modification du co>>
    194        63DC               SCRC0
    195  2     63DC C6   00              LDB #$00
    196  2     63DE C4   02              ANDB #$02     * permute #$60 ou #$>>
    197  2     63E0 CA   60              ORB #$60      * espace cartouche r>>
    198  5     63E2 F7   E7E6            STB $E7E6     * changement page da>>
    199  5     63E5 39                   RTS                  * E7E6 D5=1 p>>
    200                                                       * CAS1N : ban>>
    201
    202                           *****************************************>>
    203                           * Attente VBL
    204                           *****************************************>>
    205        63E6               VSYNC
    206        63E6               VSYNC_1
    207  7     63E6 7D   E7E7            TST    $E7E7
    208  3     63E9 2A   FB              BPL    VSYNC_1
    209        63EB               VSYNC_2
    210  7     63EB 7D   E7E7            TST    $E7E7
    211  3     63EE 2B   FB              BMI    VSYNC_2
    212  5     63F0 39                   RTS
    213
    214                           *****************************************>>
    215                           * Copie Memoire de la zone donnee vers ca>>
    216                           * Cycles en fonction de l'implementation
    217                           * 256 octets (-128 a 127) x 64  boucles (>>
    218                           * 128 octets (-64  a 63)  x 128 boucles (>>
    219                           * 32  octets (-16  a 15)  x 512 boucles (>>
    220                           *****************************************>>
    221                           *MEM_COPY_DATA_TO_CART
    222                           *   PULS X,U
    223                           *   STX       -128,Y
    224                           *   STU       -126,Y
    225                           *   PULS      D,X,U
    226                           *   STD       -124,Y
    227                           *   STX       -122,Y
    228                           *   STU       -120,Y
    229                           *   PULS      D,X,U
    230                           *   STD       -118,Y
    231                           *   STX       -116,Y
    232                           *   STU       -114,Y
    233                           *   PULS      D,X,U
    234                           *   STD       -112,Y
    235                           *   STX       -110,Y
    236                           *   STU       -108,Y
    237                           *   PULS      D,X,U
    238                           *   STD       -106,Y
    239                           *   STX       -104,Y
    240                           *   STU       -102,Y
    241                           *   PULS      D,X,U
    242                           *   STD       -100,Y
    243                           *   STX       -98,Y
    244                           *   STU       -96,Y
    245                           *   PULS      D,X,U
    246                           *   STD       -94,Y
    247                           *   STX       -92,Y
    248                           *   STU       -90,Y
    249                           *   PULS      D,X,U
    250                           *   STD       -88,Y
    251                           *   STX       -86,Y
    252                           *   STU       -84,Y
    253                           *   PULS      D,X,U
    254                           *   STD       -82,Y
    255                           *   STX       -80,Y
    256                           *   STU       -78,Y
    257                           *   PULS      D,X,U
    258                           *   STD       -76,Y
    259                           *   STX       -74,Y
    260                           *   STU       -72,Y
    261                           *   PULS      D,X,U
    262                           *   STD       -70,Y
    263                           *   STX       -68,Y
    264                           *   STU       -66,Y
    265                           *   PULS      D,X,U
    266                           *   STD       -64,Y
    267                           *   STX       -62,Y
    268                           *   STU       -60,Y
    269                           *   PULS      D,X,U
    270                           *   STD       -58,Y
    271                           *   STX       -56,Y
    272                           *   STU       -54,Y
    273                           *   PULS      D,X,U
    274                           *   STD       -52,Y
    275                           *   STX       -50,Y
    276                           *   STU       -48,Y
    277                           *   PULS      D,X,U
    278                           *   STD       -46,Y
    279                           *   STX       -44,Y
    280                           *   STU       -42,Y
    281                           *   PULS      D,X,U
    282                           *   STD       -40,Y
    283                           *   STX       -38,Y
    284                           *   STU       -36,Y
    285                           *   PULS      D,X,U
    286                           *   STD       -34,Y
    287                           *   STX       -32,Y
    288                           *   STU       -30,Y
    289                           *   PULS      D,X,U
    290                           *   STD       -28,Y
    291                           *   STX       -26,Y
    292                           *   STU       -24,Y
    293                           *   PULS      D,X,U
    294                           *   STD       -22,Y
    295                           *   STX       -20,Y
    296                           *   STU       -18,Y
    297                           *   PULS      D,X,U
    298                           *   STD       -16,Y
    299                           *   STX       -14,Y
    300                           *   STU       -12,Y
    301                           *   PULS      D,X,U
    302                           *   STD       -10,Y
    303                           *   STX       -8,Y
    304                           *   STU       -6,Y
    305                           *   PULS      D,X,U
    306                           *   STD       -4,Y
    307                           *   STX       -2,Y
    308                           *   STU       ,Y
    309                           *   PULS      D,X,U
    310                           *   STD       2,Y
    311                           *   STX       4,Y
    312                           *   STU       6,Y
    313                           *   PULS      D,X,U
    314                           *   STD       8,Y
    315                           *   STX       10,Y
    316                           *   STU       12,Y
    317                           *   PULS      D,X,U
    318                           *   STD       14,Y
    319                           *   STX       16,Y
    320                           *   STU       18,Y
    321                           *   PULS      D,X,U
    322                           *   STD       20,Y
    323                           *   STX       22,Y
    324                           *   STU       24,Y
    325                           *   PULS      D,X,U
    326                           *   STD       26,Y
    327                           *   STX       28,Y
    328                           *   STU       30,Y
    329                           *   PULS      D,X,U
    330                           *   STD       32,Y
    331                           *   STX       34,Y
    332                           *   STU       36,Y
    333                           *   PULS      D,X,U
    334                           *   STD       38,Y
    335                           *   STX       40,Y
    336                           *   STU       42,Y
    337                           *   PULS      D,X,U
    338                           *   STD       44,Y
    339                           *   STX       46,Y
    340                           *   STU       48,Y
    341                           *   PULS      D,X,U
    342                           *   STD       50,Y
    343                           *   STX       52,Y
    344                           *   STU       54,Y
    345                           *   PULS      D,X,U
    346                           *   STD       56,Y
    347                           *   STX       58,Y
    348                           *   STU       60,Y
    349                           *   PULS      D,X,U
    350                           *   STD       62,Y
    351                           *   STX       64,Y
    352                           *   STU       66,Y
    353                           *   PULS      D,X,U
    354                           *   STD       68,Y
    355                           *   STX       70,Y
    356                           *   STU       72,Y
    357                           *   PULS      D,X,U
    358                           *   STD       74,Y
    359                           *   STX       76,Y
    360                           *   STU       78,Y
    361                           *   PULS      D,X,U
    362                           *   STD       80,Y
    363                           *   STX       82,Y
    364                           *   STU       84,Y
    365                           *   PULS      D,X,U
    366                           *   STD       86,Y
    367                           *   STX       88,Y
    368                           *   STU       90,Y
    369                           *   PULS      D,X,U
    370                           *   STD       92,Y
    371                           *   STX       94,Y
    372                           *   STU       96,Y
    373                           *   PULS      D,X,U
    374                           *   STD       98,Y
    375                           *   STX       100,Y
    376                           *   STU       102,Y
    377                           *   PULS      D,X,U
    378                           *   STD       104,Y
    379                           *   STX       106,Y
    380                           *   STU       108,Y
    381                           *   PULS      D,X,U
    382                           *   STD       110,Y
    383                           *   STX       112,Y
    384                           *   STU       114,Y
    385                           *   PULS      D,X,U
    386                           *   STD       116,Y
    387                           *   STX       118,Y
    388                           *   STU       120,Y
    389                           *   PULS      D,X,U
    390                           *   STD       122,Y
    391                           *   STX       124,Y
    392                           *   STU       126,Y
    393                           *   LEAY 256,Y
    394                           *MEM_COPY_DATA_TO_CART_E
    395                           *   CMPY    #$0180
    396                           *   LBNE     MEM_COPY_DATA_TO_CART
    397                           *MEM_COPY_DATA_TO_CART_S
    398                           *   LDS     #$0000    * Rechargement du p>>
    399                           *   RTS
    400                            
    401        63F1               MEM_COPY_DATA_TO_CART
    402  5+6   63F1 35   56          PULS       D,X,U
    403  5+1   63F3 ED   A8 C0       STD -64,Y
    404  5+1   63F6 AF   A8 C2       STX -62,Y
    405  5+1   63F9 EF   A8 C4       STU -60,Y
    406  5+6   63FC 35   56          PULS       D,X,U
    407  5+1   63FE ED   A8 C6       STD -58,Y
    408  5+1   6401 AF   A8 C8       STX -56,Y
    409  5+1   6404 EF   A8 CA       STU -54,Y
    410  5+6   6407 35   56          PULS       D,X,U
    411  5+1   6409 ED   A8 CC       STD -52,Y
    412  5+1   640C AF   A8 CE       STX -50,Y
    413  5+1   640F EF   A8 D0       STU -48,Y
    414  5+6   6412 35   56          PULS       D,X,U
    415  5+1   6414 ED   A8 D2       STD -46,Y
    416  5+1   6417 AF   A8 D4       STX -44,Y
    417  5+1   641A EF   A8 D6       STU -42,Y
    418  5+6   641D 35   56          PULS       D,X,U
    419  5+1   641F ED   A8 D8       STD -40,Y
    420  5+1   6422 AF   A8 DA       STX -38,Y
    421  5+1   6425 EF   A8 DC       STU -36,Y
    422  5+6   6428 35   56          PULS       D,X,U
    423  5+1   642A ED   A8 DE       STD -34,Y
    424  5+1   642D AF   A8 E0       STX -32,Y
    425  5+1   6430 EF   A8 E2       STU -30,Y
    426  5+6   6433 35   56          PULS       D,X,U
    427  5+1   6435 ED   A8 E4       STD -28,Y
    428  5+1   6438 AF   A8 E6       STX -26,Y
    429  5+1   643B EF   A8 E8       STU -24,Y
    430  5+6   643E 35   56          PULS       D,X,U
    431  5+1   6440 ED   A8 EA       STD -22,Y
    432  5+1   6443 AF   A8 EC       STX -20,Y
    433  5+1   6446 EF   A8 EE       STU -18,Y
    434  5+6   6449 35   56          PULS       D,X,U
    435  5+1   644B ED   30          STD -16,Y
    436  5+1   644D AF   32          STX -14,Y
    437  5+1   644F EF   34          STU -12,Y
    438  5+6   6451 35   56          PULS       D,X,U
    439  5+1   6453 ED   36          STD -10,Y
    440  5+1   6455 AF   38          STX -8,Y
    441  5+1   6457 EF   3A          STU -6,Y
    442  5+6   6459 35   56          PULS       D,X,U
    443  5+1   645B ED   3C          STD -4,Y
    444  5+1   645D AF   3E          STX -2,Y
    445  5+0   645F EF   A4          STU ,Y
    446  5+6   6461 35   56          PULS       D,X,U
    447  5+1   6463 ED   22          STD 2,Y
    448  5+1   6465 AF   24          STX 4,Y
    449  5+1   6467 EF   26          STU 6,Y
    450  5+6   6469 35   56          PULS       D,X,U
    451  5+1   646B ED   28          STD 8,Y
    452  5+1   646D AF   2A          STX 10,Y
    453  5+1   646F EF   2C          STU 12,Y
    454  5+6   6471 35   56          PULS       D,X,U
    455  5+1   6473 ED   2E          STD 14,Y
    456  5+1   6475 AF   A8 10       STX 16,Y
    457  5+1   6478 EF   A8 12       STU 18,Y
    458  5+6   647B 35   56          PULS       D,X,U
    459  5+1   647D ED   A8 14       STD 20,Y
    460  5+1   6480 AF   A8 16       STX 22,Y
    461  5+1   6483 EF   A8 18       STU 24,Y
    462  5+6   6486 35   56          PULS       D,X,U
    463  5+1   6488 ED   A8 1A       STD 26,Y
    464  5+1   648B AF   A8 1C       STX 28,Y
    465  5+1   648E EF   A8 1E       STU 30,Y
    466  5+6   6491 35   56          PULS       D,X,U
    467  5+1   6493 ED   A8 20       STD 32,Y
    468  5+1   6496 AF   A8 22       STX 34,Y
    469  5+1   6499 EF   A8 24       STU 36,Y
    470  5+6   649C 35   56          PULS       D,X,U
    471  5+1   649E ED   A8 26       STD 38,Y
    472  5+1   64A1 AF   A8 28       STX 40,Y
    473  5+1   64A4 EF   A8 2A       STU 42,Y
    474  5+6   64A7 35   56          PULS       D,X,U
    475  5+1   64A9 ED   A8 2C       STD 44,Y
    476  5+1   64AC AF   A8 2E       STX 46,Y
    477  5+1   64AF EF   A8 30       STU 48,Y
    478  5+6   64B2 35   56          PULS       D,X,U
    479  5+1   64B4 ED   A8 32       STD 50,Y
    480  5+1   64B7 AF   A8 34       STX 52,Y
    481  5+1   64BA EF   A8 36       STU 54,Y
    482  5+6   64BD 35   56          PULS       D,X,U
    483  5+1   64BF ED   A8 38       STD 56,Y
    484  5+1   64C2 AF   A8 3A       STX 58,Y
    485  5+1   64C5 EF   A8 3C       STU 60,Y
    486  5+0   64C8 EC   E4          LDD ,S
    487  5+1   64CA ED   A8 3E       STD 62,Y
    488  4+4   64CD 31   A9 0080     LEAY 128,Y
    489        64D1               MEM_COPY_DATA_TO_CART_E
    490  5     64D1 108C 00C0        CMPY    #$00C0
    491  6     64D5 1026 FF18        LBNE     MEM_COPY_DATA_TO_CART
    492        64D9               MEM_COPY_DATA_TO_CART_S
    493  4     64D9 10CE 0000        LDS     #$0000    * Rechargement du po>>
    494  5     64DD 39               RTS
    495
    496                           *MEM_COPY_DATA_TO_CART
    497                           *   PULS    D,X,U
    498                           *   STD     -16,Y
    499                           *   STX     -14,Y
    500                           *   STU     -12,Y
    501                           *   PULS    D,X,U
    502                           *   STD     -10,Y
    503                           *   STX     -8,Y
    504                           *   STU     -6,Y
    505                           *   PULS    D,X,U
    506                           *   STD     -4,Y
    507                           *   STX     -2,Y
    508                           *   STU     ,Y
    509                           *   PULS    D,X,U
    510                           *   STD     2,Y
    511                           *   STX     4,Y
    512                           *   STU     6,Y
    513                           *   PULS    D,X
    514                           *   STD     8,Y
    515                           *   STX     10,Y
    516                           *   PULS    D,X
    517                           *   STD     12,Y
    518                           *   STX     14,Y
    519                           *   LEAY    32,Y
    520                           *MEM_COPY_DATA_TO_CART_E
    521                           *   CMPY    #$0030
    522                           *   BNE     MEM_COPY_DATA_TO_CART
    523                           *MEM_COPY_DATA_TO_CART_S
    524                           *   LDS     #$0000    * Rechargement du p>>
    525                           *   RTS
    526                           *****************************************>>
    527                           * Effacement memoire Cartouche
    528                           *****************************************>>
    529        64DE               CLR_CART
    530  5+3   64DE 34   48           PSHS U,DP
    531  7     64E0 10FF 6515         STS CLR_CART_3+2
    532  4     64E4 10CE 4000         LDS #$4000
    533  3     64E8 CE   0000         LDU #$0000
    534  4     64EB 108E 0000         LDY #$0000
    535  3     64EF 8E   0000         LDX #$0000
    536  3     64F2 CC   0000         LDD #$0000
    537  6     64F5 1F   8B           TFR A,DP
    538        64F7               CLR_CART_2
    539  5+9   64F7 34   7E           PSHS U,Y,X,DP,B,A
    540  5+9   64F9 34   7E           PSHS U,Y,X,DP,B,A
    541  5+9   64FB 34   7E           PSHS U,Y,X,DP,B,A
    542  5+9   64FD 34   7E           PSHS U,Y,X,DP,B,A
    543  5+9   64FF 34   7E           PSHS U,Y,X,DP,B,A
    544  5+9   6501 34   7E           PSHS U,Y,X,DP,B,A
    545  5+9   6503 34   7E           PSHS U,Y,X,DP,B,A
    546  5+9   6505 34   7E           PSHS U,Y,X,DP,B,A
    547  5+9   6507 34   7E           PSHS U,Y,X,DP,B,A
    548  5+9   6509 34   7E           PSHS U,Y,X,DP,B,A
    549  5     650B 118C 0004         CMPS #$0004
    550  3     650F 26   E6           BNE CLR_CART_2
    551  5+4   6511 34   60           PSHS U,Y
    552        6513               CLR_CART_3
    553  4     6513 10CE 0000         LDS #$0000
    554  5+3   6517 35   48           PULS DP,U
    555  5     6519 39                RTS
    556
    557                           *****************************************>>
    558                           * Get joystick parameters
    559                           *****************************************>>
    560        651A               JOY_READ
    561  3     651A 8E   E7CF            ldx    #$e7cf
    562  4     651D 108E E7CD            ldy    #$e7cd
    563  3     6521 CC   400F            ldd    #$400f
    564  5     6524 F4   E7CC            andb   >$e7cc     * Read position
    565  5     6527 F7   6532            stb    JOY_DIR_STATUS
    566  4+0   652A A4   A4              anda   ,y         * Read button
    567  2     652C 88   40              eora   #$40
    568  5     652E B7   6533            sta    JOY_BTN_STATUS
    569  5     6531 39                   RTS
    570        6532               JOY_DIR_STATUS
    571        6532 00                   FCB $00 * Position Pad
    572        6533               JOY_BTN_STATUS
    573        6533 00                   FCB $00 * 40 Bouton A enfonce
    574
    575                           *****************************************>>
    576                           * Subroutine to      make HERO walk/run
    577                           *****************************************>>
    578        6534               Hero_Move
    579  5     6534 B6   6532            LDA JOY_DIR_STATUS
    580  2     6537 81   0B              CMPA #JOY_G
    581  3     6539 26   02              BNE Hero_NotLeft
    582  3     653B 20   69              BRA Hero_MoveLeft
    583
    584        653D               Hero_NotLeft                   * XREF: He>>
    585  2     653D 81   07              CMPA #JOY_D
    586  3     653F 26   03              BNE Hero_NotLeftOrRight
    587  5     6541 16   00A6            LBRA Hero_MoveRight
    588
    589        6544               Hero_NotLeftOrRight            * XREF: He>>
    590  6     6544 FC   67AA            LDD HERO_G_SPEED
    591  5     6547 1083 0000            CMPD #$0000
    592  3     654B 2D   2E              BLT Hero_NotLeftOrRight_00 * se de>>
    593  7     654D B3   67BC            SUBD HERO_FRICTION     * se deplac>>
    594  3     6550 24   12              BCC Hero_NotLeftOrRight_01 * si on>>
    595  3     6552 CC   0000            LDD #$0000
    596  6     6555 FD   67AA            STD HERO_G_SPEED
    597  6     6558 FD   67AE            STD HERO_X_SPS
    598  3     655B 8E   679E            LDX #HERO_IDLE_R        * Charge a>>
    599  6     655E BF   67BE            STX HERO_ANIMATION_ADR      * Sauv>>
    600  5     6561 16   00C4            LBRA Hero_MoveUpdatePos
    601        6564               Hero_NotLeftOrRight_01
    602  5     6564 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    603  3     6568 2C   0B              BGE Hero_NotLeftOrRight_02
    604  6     656A FD   67AA            STD HERO_G_SPEED
    605  3     656D 8E   679E            LDX #HERO_WALK_R        * Charge a>>
    606  6     6570 BF   67BE            STX HERO_ANIMATION_ADR      * Sauv>>
    607  3     6573 20   03              BRA Hero_NotLeftOrRight_03
    608        6575               Hero_NotLeftOrRight_02
    609  6     6575 FD   67AA            STD HERO_G_SPEED
    610        6578               Hero_NotLeftOrRight_03
    611  5     6578 16   00AD            LBRA Hero_MoveUpdatePos
    612        657B               Hero_NotLeftOrRight_00
    613  7     657B F3   67BC            ADDD HERO_FRICTION     * se deplac>>
    614  3     657E 24   0F              BCC Hero_NotLeftOrRight_11 * si on>>
    615  3     6580 CC   0000            LDD #$0000
    616  6     6583 FD   67AA            STD HERO_G_SPEED
    617  3     6586 8E   679E            LDX #HERO_IDLE_L        * Charge a>>
    618  6     6589 BF   67BE            STX HERO_ANIMATION_ADR      * Sauv>>
    619  5     658C 16   0099            LBRA Hero_MoveUpdatePos
    620        658F               Hero_NotLeftOrRight_11
    621  5     658F 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    622  3     6593 2F   0B              BLE Hero_NotLeftOrRight_12
    623  6     6595 FD   67AA            STD HERO_G_SPEED
    624  3     6598 8E   679E            LDX #HERO_WALK_L        * Charge a>>
    625  6     659B BF   67BE            STX HERO_ANIMATION_ADR      * Sauv>>
    626  3     659E 20   03              BRA Hero_NotLeftOrRight_13
    627        65A0               Hero_NotLeftOrRight_12
    628  6     65A0 FD   67AA            STD HERO_G_SPEED
    629        65A3               Hero_NotLeftOrRight_13
    630  5     65A3 16   0082            LBRA Hero_MoveUpdatePos
    631
    632        65A6               Hero_MoveLeft                      * XREF>>
    633  6     65A6 FC   67AA            LDD HERO_G_SPEED            * Char>>
    634  5     65A9 1083 0000            CMPD #$0000                 * Test>>
    635  3     65AD 2F   11              BLE Hero_MoveLeft_00        * BRAN>>
    636  7     65AF B3   67BA            SUBD HERO_DECELERATION      * orie>>
    637  3     65B2 24   06              BCC Hero_MoveLeft_03        * BRAN>>
    638  3     65B4 CC   0000            LDD #$0000
    639  7     65B7 B3   67BA            SUBD HERO_DECELERATION      * si l>>
    640        65BA               Hero_MoveLeft_03
    641  6     65BA FD   67AA            STD HERO_G_SPEED            * On s>>
    642  5     65BD 16   0068            LBRA Hero_MoveUpdatePos           >>
    643        65C0               Hero_MoveLeft_00                         >>
    644                           *      CMPD #$0000                       >>
    645                           *      BNE Hero_MoveLeft_02        * BRAN>>
    646                           *      LDD #$FEFF                        >>
    647                           *Hero_MoveLeft_02
    648  8     65C0 10B3 67B6            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    649  3     65C4 27   62              BEQ Hero_MoveUpdatePos      * vite>>
    650  7     65C6 B3   67B8            SUBD HERO_ACCELERATION      * acce>>
    651  8     65C9 10B3 67B6            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    652  3     65CD 2E   0F              BGT Hero_MoveLeft_01        * BRAN>>
    653  3     65CF 8E   679E            LDX #HERO_RUN_L        * Charge an>>
    654  6     65D2 BF   67BE            STX HERO_ANIMATION_ADR      * Sauv>>
    655  6     65D5 FC   67B6            LDD HERO_NEG_TOP_SPEED      * Limi>>
    656  6     65D8 FD   67AA            STD HERO_G_SPEED            * Enre>>
    657  5     65DB 16   004A            LBRA Hero_MoveUpdatePos     * Mise>>
    658        65DE               Hero_MoveLeft_01
    659  6     65DE FD   67AA            STD HERO_G_SPEED            * Enre>>
    660  3     65E1 8E   679E            LDX #HERO_WALK_L        * Charge a>>
    661  6     65E4 BF   67BE            STX HERO_ANIMATION_ADR      * Sauv>>
    662  5     65E7 16   003E            LBRA Hero_MoveUpdatePos
    663
    664        65EA               Hero_MoveRight                  * XREF: H>>
    665  6     65EA FC   67AA            LDD HERO_G_SPEED        * Chargeme>>
    666  5     65ED 1083 0000            CMPD #$0000                 * Test>>
    667  3     65F1 2C   0E              BGE Hero_MoveRight_00       * BRAN>>
    668  7     65F3 F3   67BA            ADDD HERO_DECELERATION      * orie>>
    669  3     65F6 24   03              BCC Hero_MoveRight_03       * BRAN>>
    670  6     65F8 FC   67BA            LDD HERO_DECELERATION   * si la vi>>
    671        65FB               Hero_MoveRight_03
    672  6     65FB FD   67AA            STD HERO_G_SPEED        * On stock>>
    673  5     65FE 16   0027            LBRA Hero_MoveUpdatePos           >>
    674        6601               Hero_MoveRight_00                  * Orie>>
    675                           *      CMPD #$0000                       >>
    676                           *      BNE Hero_MoveRight_02       * BRAN>>
    677                           *      LDD #$0100                        >>
    678                           *Hero_MoveRight_02
    679  8     6601 10B3 67B4            CMPD HERO_TOP_SPEED         * Comp>>
    680  3     6605 27   21              BEQ Hero_MoveUpdatePos      * vite>>
    681  7     6607 F3   67B8            ADDD HERO_ACCELERATION      * acce>>
    682  8     660A 10B3 67B4            CMPD HERO_TOP_SPEED         * Comp>>
    683  3     660E 2D   0F              BLT Hero_MoveRight_01       * BRAN>>
    684  3     6610 8E   679E            LDX #HERO_RUN_R                   >>
    685  6     6613 BF   67BE            STX HERO_ANIMATION_ADR      * Sauv>>
    686  6     6616 FC   67B4            LDD HERO_TOP_SPEED          * Limi>>
    687  6     6619 FD   67AA            STD HERO_G_SPEED            * Enre>>
    688  5     661C 16   0009            LBRA Hero_MoveUpdatePos           >>
    689        661F               Hero_MoveRight_01
    690  6     661F FD   67AA            STD HERO_G_SPEED            * Enre>>
    691  3     6622 8E   679E            LDX #HERO_WALK_R        * Charge a>>
    692  6     6625 BF   67BE            STX HERO_ANIMATION_ADR      * Sauv>>
    693
    694        6628               Hero_MoveUpdatePos
    695  6     6628 FC   67AA            LDD HERO_G_SPEED            * Char>>
    696  6     662B FD   67AC            STD HERO_X_SPEED        * Stockage>>
    697  5     662E 1083 0000            CMPD #$0000                 * Test>>
    698  3     6632 2D   0E              BLT Hero_MoveUpdatePos_00   * BRAN>>
    699  7     6634 F3   67AE            ADDD HERO_X_SPS         * Ajout du>>
    700  5     6637 F7   67AF            STB HERO_X_SPS+1            * sauv>>
    701  6     663A 1F   89              TFR A,B                     * Divi>>
    702  5     663C FB   67A8            ADDB HERO_X_POS                   >>
    703  3     663F 20   18              BRA Hero_MoveUpdatePos_01
    704        6641               Hero_MoveUpdatePos_V00
    705        6641 00                   FCB $00
    706        6642               Hero_MoveUpdatePos_00
    707  3     6642 CC   0000            LDD #$0000
    708  7     6645 B3   67AC            SUBD HERO_X_SPEED           * La v>>
    709  7     6648 F3   67AE            ADDD HERO_X_SPS         * Ajout du>>
    710  5     664B F7   67AF            STB HERO_X_SPS+1            * sauv>>
    711  6     664E 1F   89              TFR A,B                     * Divi>>
    712  5     6650 F7   6641            STB Hero_MoveUpdatePos_V00
    713  5     6653 F6   67A8            LDB HERO_X_POS
    714  5     6656 F0   6641            SUBB Hero_MoveUpdatePos_V00 * Ajou>>
    715        6659               Hero_MoveUpdatePos_01
    716                           *      CMPB #$50                         >>
    717                           *      BLE Hero_MoveUpdatePos_02   * Bute>>
    718                           *      LDB #$50                          >>
    719                           *Hero_MoveUpdatePos_02
    720                           *    CMPB #$0C                           >>
    721                           *      BGE Hero_MoveUpdatePos_03   * Bute>>
    722                           *      LDB #$0C                          >>
    723        6659               Hero_MoveUpdatePos_03
    724  5     6659 F7   67A8            STB HERO_X_POS
    725  2     665C C6   00              LDB #$00
    726  5     665E F7   67AE            STB HERO_X_SPS                    >>
    727  3     6661 CC   0000            LDD #$0000                  * TODO>>
    728  6     6664 FD   67B0            STD HERO_Y_SPEED
    729  6     6667 1F   89              TFR A,B                     * divi>>
    730  5     6669 FB   67A9            ADDB HERO_Y_POS
    731  5     666C F7   67A9            STB HERO_Y_POS
    732  5     666F 39                   RTS
    733
    734                           * TODO : Braking Animation
    735                           * Sonic enters his braking animation when>>
    736                           * In Sonic 1 and Sonic CD, he then stays >>
    737                           * In the other 3 games, Sonic returns to >>
    738
    739        6670               Compute_Position
    740  5     6670 B6   67A8            LDA HERO_X_POS
    741  2     6673 44                   LSRA
    742  3     6674 25   17              BCS Compute_Position_01
    743  5     6676 B7   66A8            STA Compute_Position_02+1
    744  2     6679 86   28              LDA #$28
    745  5     667B F6   67A9            LDB HERO_Y_POS
    746  2     667E 5A                   DECB
    747  11    667F 3D                   MUL
    748  7     6680 F3   66A7            ADDD Compute_Position_02
    749  6     6683 FD   9F02            STD HERO_POS
    750  4     6686 C3   2000            ADDD #$2000
    751  6     6689 FD   9F04            STD HERO_POS+2
    752  5     668C 39                   RTS
    753        668D               Compute_Position_01
    754  5     668D B7   66A8            STA Compute_Position_02+1
    755  2     6690 86   28              LDA #$28
    756  5     6692 F6   67A9            LDB HERO_Y_POS
    757  2     6695 5A                   DECB
    758  11    6696 3D                   MUL
    759  7     6697 F3   66A7            ADDD Compute_Position_02
    760  4     669A C3   2000            ADDD #$2000
    761  6     669D FD   9F02            STD HERO_POS
    762  4     66A0 83   1FFF            SUBD #$1FFF
    763  6     66A3 FD   9F04            STD HERO_POS+2
    764  5     66A6 39                   RTS
    765        66A7               Compute_Position_02
    766        66A7 0000                 FDB $0000
    767                            
    768                           *****************************************>>
    769                           * Affichage de l arriere plan xxx cycles
    770                           *****************************************>>
    771        66A9               DRAW_RAM_DATA_TO_CART_160x200
    772  5+3   66A9 34   48              PSHS U,DP            * sauvegarde >>
    773  7     66AB 10FF 9F00            STS >SSAVE
    774                            
    775  4     66AF 10CE 1F40            LDS #FINECRANA       * init pointe>>
    776  3     66B3 CE   A000            LDU #$A000
    777
    778        66B6               DRAW_RAM_DATA_TO_CART_160x200A
    779  5+7   66B6 37   3E              PULU A,B,DP,X,Y
    780  5+7   66B8 34   3E              PSHS Y,X,DP,B,A
    781  5+7   66BA 37   3E              PULU A,B,DP,X,Y
    782  5+7   66BC 34   3E              PSHS Y,X,DP,B,A
    783  5+7   66BE 37   3E              PULU A,B,DP,X,Y
    784  5+7   66C0 34   3E              PSHS Y,X,DP,B,A
    785  5+7   66C2 37   3E              PULU A,B,DP,X,Y
    786  5+7   66C4 34   3E              PSHS Y,X,DP,B,A
    787  5+7   66C6 37   3E              PULU A,B,DP,X,Y
    788  5+7   66C8 34   3E              PSHS Y,X,DP,B,A
    789  5+7   66CA 37   3E              PULU A,B,DP,X,Y
    790  5+7   66CC 34   3E              PSHS Y,X,DP,B,A
    791  5     66CE 118C 0014            CMPS #DEBUTECRANA
    792  3     66D2 26   E2              BNE DRAW_RAM_DATA_TO_CART_160x200A>>
    793  5+7   66D4 37   3E              PULU A,B,DP,X,Y
    794  5+7   66D6 34   3E              PSHS Y,X,DP,B,A
    795  5+7   66D8 37   3E              PULU A,B,DP,X,Y
    796  5+7   66DA 34   3E              PSHS Y,X,DP,B,A
    797  5+6   66DC 37   3C              PULU B,DP,X,Y
    798  5+6   66DE 34   3C              PSHS Y,X,DP,B
    799
    800  4     66E0 10CE 3F40            LDS #FINECRANB       * init pointe>>
    801  3     66E4 CE   C000            LDU #$C000
    802
    803        66E7               DRAW_RAM_DATA_TO_CART_160x200B
    804  5+7   66E7 37   3E              PULU A,B,DP,X,Y
    805  5+7   66E9 34   3E              PSHS Y,X,DP,B,A
    806  5+7   66EB 37   3E              PULU A,B,DP,X,Y
    807  5+7   66ED 34   3E              PSHS Y,X,DP,B,A
    808  5+7   66EF 37   3E              PULU A,B,DP,X,Y
    809  5+7   66F1 34   3E              PSHS Y,X,DP,B,A
    810  5+7   66F3 37   3E              PULU A,B,DP,X,Y
    811  5+7   66F5 34   3E              PSHS Y,X,DP,B,A
    812  5+7   66F7 37   3E              PULU A,B,DP,X,Y
    813  5+7   66F9 34   3E              PSHS Y,X,DP,B,A
    814  5+7   66FB 37   3E              PULU A,B,DP,X,Y
    815  5+7   66FD 34   3E              PSHS Y,X,DP,B,A
    816  5     66FF 118C 2014            CMPS #DEBUTECRANB
    817  3     6703 26   E2              BNE DRAW_RAM_DATA_TO_CART_160x200B>>
    818  5+7   6705 37   3E              PULU A,B,DP,X,Y
    819  5+7   6707 34   3E              PSHS Y,X,DP,B,A
    820  5+7   6709 37   3E              PULU A,B,DP,X,Y
    821  5+7   670B 34   3E              PSHS Y,X,DP,B,A
    822  5+6   670D 37   3C              PULU B,DP,X,Y
    823  5+6   670F 34   3C              PSHS Y,X,DP,B
    824
    825  7     6711 10FE 9F00            LDS  >SSAVE          * rechargemen>>
    826  5+3   6715 35   48              PULS U,DP
    827  5     6717 39                   RTS
    828                            
    829                           *****************************************>>
    830                           * Palette de 16 couleurs
    831                           *****************************************>>
    832        6718               TABPALETTE
    833        6718 0CCD                 FDB $0ccd     * index:0  R:244 V:2>>
    834        671A 0BA4                 FDB $0ba4     * index:1  R:164 V:2>>
    835        671C 035D                 FDB $035d     * index:2  R:244 V:1>>
    836        671E 0D81                 FDB $0d81     * index:3  R:108 V:2>>
    837        6720 013B                 FDB $013b     * index:4  R:228 V:1>>
    838        6722 0541                 FDB $0541     * index:5  R:100 V:1>>
    839        6724 0D30                 FDB $0d30     * index:6  R:43  V:1>>
    840        6726 0017                 FDB $0017     * index:7  R:196 V:1>>
    841        6728 000B                 FDB $000b     * index:8  R:228 V:2>>
    842        672A 0D10                 FDB $0d10     * index:9  R:4   V:1>>
    843        672C 0110                 FDB $0110     * index:10 R:28  V:9>>
    844        672E 0003                 FDB $0003     * index:11 R:148 V:2>>
    845        6730 0700                 FDB $0700     * index:12 R:4   V:5>>
    846        6732 0200                 FDB $0200     * index:13 R:4   V:2>>
    847        6734 0000                 FDB $0000     * index:14 R:68  V:2>>
    848        6736 0000                 FDB $0000     * index:15 R:4   V:2>>
    849        6738               FINTABPALETTE
    850
    851                           *****************************************>>
    852                           * HERO Animations
    853                           * ---------------
    854                           * Note: Speed abs +0, rel +8, rel cap +10>>
    855                           *
    856                           * Chargement nouvelle animation
    857                           *    nouvelle frame = 109 a 119
    858                           *
    859                           * Chargement frame suivante
    860                           *    frame identique = 15
    861                           * ou frame suivante  = 116 a 126
    862                           *
    863                           * Chargement frame suivante avec branchem>>
    864                           *    nouvelle frame = 165 a 175
    865                           * ou frame suivante = 172 a 182
    866                           *
    867                           * Chargement frame suivante avec retour s>>
    868                           *    nouvelle frame = 167 a 177
    869                           * ou frame suivante = 174 a 184
    870                           *****************************************>>
    871
    872        6738               HERO_ANIMATION_LOAD                      >>
    873  6     6738 BF   67BE            STX HERO_ANIMATION_ADR
    874  6     673B BF   67C0            STX HERO_ANIMATION_RTN_ADR
    875  7     673E 7F   67C7            CLR HERO_ANIMATION_IMC            >>
    876        6741               HERO_ANIMATION_LOAD_00
    877  5+1   6741 EC   1E              LDD -2,X                          >>
    878  2     6743 81   00              CMPA #$00                         >>
    879  3     6745 27   07              BEQ HERO_ANIMATION_LOAD_01
    880  5     6747 F0   67AA            SUBB HERO_G_SPEED                 >>
    881  3     674A 24   02              BCC HERO_ANIMATION_LOAD_01
    882  2     674C C6   01              LDB #$01                          >>
    883        674E               HERO_ANIMATION_LOAD_01
    884  5     674E F7   67C9            STB HERO_ANIMATION_FRR            >>
    885  5     6751 B6   67C7            LDA HERO_ANIMATION_IMC
    886  2     6754 C6   05              LDB #$05
    887  11    6756 3D                   MUL
    888  7     6757 F3   67BE            ADDD HERO_ANIMATION_ADR
    889  6     675A 1F   02              TFR D,Y
    890  4+0   675C E6   A4              LDB ,Y
    891  2     675E C1   1F              CMPB #$1F                         >>
    892  3     6760 22   0E              BHI HERO_ANIMATION_LOAD_NOPAGE
    893  5     6762 F7   67C2            STB HERO_ANIMATION_PAG            >>
    894  5+1   6765 AE   21              LDX 1,Y
    895  6     6767 BF   67C5            STX HERO_ANIMATION_DRW
    896  5+1   676A AE   23              LDX 3,Y
    897  6     676C BF   67C3            STX HERO_ANIMATION_DEL
    898  5     676F 39                   RTS
    899        6770               HERO_ANIMATION_LOAD_NOPAGE
    900  2     6770 C1   FF              CMPB #$FF
    901  3     6772 26   0C              BNE HERO_ANIMATION_LOAD_FE
    902  5+1   6774 AE   23              LDX 3,Y
    903  6     6776 BF   67C7            STX HERO_ANIMATION_IMC            >>
    904  5+1   6779 AE   21              LDX 1,Y
    905  6     677B BF   67BE            STX HERO_ANIMATION_ADR
    906  3     677E 20   C1              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    907        6780               HERO_ANIMATION_LOAD_FE
    908  6     6780 BE   67C0            LDX HERO_ANIMATION_RTN_ADR  * RETU>>
    909  6     6783 BF   67BE            STX HERO_ANIMATION_ADR
    910  5     6786 F6   67C8            LDB HERO_ANIMATION_RTN_IMC
    911  5     6789 F7   67C7            STB HERO_ANIMATION_IMC
    912  3     678C 20   B3              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    913
    914        678E               HERO_ANIMATION_NEXT
    915  7     678E 7A   67C9            DEC HERO_ANIMATION_FRR
    916  3     6791 27   01              BEQ HERO_ANIMATION_NEXT_00  * BRAN>>
    917  5     6793 39                   RTS
    918        6794               HERO_ANIMATION_NEXT_00
    919  7     6794 7C   67C7            INC HERO_ANIMATION_IMC
    920  6     6797 BE   67BE            LDX HERO_ANIMATION_ADR
    921  3     679A 20   A5              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    922                            
    923                           *   SAMPLE CODE ANIMATION
    924                           *      ---------------------
    925                           *      FDB $0018            * 00 Absolute>>
    926                           *HERO_IDLE_L
    927                           *      FCB $01                     * Page>>
    928                           *      FDB $A000            * Adresse drw>>
    929                           *      FDB $A000            * Adresse del>>
    930                           *
    931                           *      FCB $FF                     * FF S>>
    932                           *      FDB HERO_IDLE-C * adresse animatio>>
    933                           *      FDB $0301            * 03 image ci>>
    934                           *
    935                           *      FCB $FE                     * FE R>>
    936                           *
    937                           *      LDX #HERO_IDLE_R
    938                           *      JSR HERO_ANIMATION_LOAD
    939                           *
    940                           *      JSR HERO_ANIMATION_NEXT
    941
    942                           *<ANIMATION_TABLE>
    943                           * Limite a 128 images par animations
    944
    945        679C 0001                 FDB $0001
    946        679E               HERO_IDLE_L
    947        679E               HERO_IDLE_R
    948        679E               HERO_IDLE_L2
    949        679E               HERO_SUBIDLE_B
    950        679E               HERO_WALK_L
    951        679E               HERO_WALK_R
    952        679E               HERO_RUN_L
    953        679E               HERO_RUN_R
    954        679E 04                   FCB $04
    955        679F A000                 FDB $A000
    956        67A1 A000                 FDB $A000
    957        67A3 FF                   FCB $FF
    958        67A4 679E                 FDB HERO_RUN_R
    959        67A6 0000                 FDB $0000
    960                            
    961                           *****************************************>>
    962                           * HERO Variables
    963                           *****************************************>>
    964                  0400     HERO_WALK_SPD_LIMIT EQU $0400
    965                  0600     HERO_JOG_SPD_LIMIT  EQU $0600
    966        67A8               HERO_X_POS
    967        67A8 50                   FCB $50                     * Hori>>
    968        67A9               HERO_Y_POS
    969        67A9 C8                   FCB $C8                     * Vert>>
    970        67AA               HERO_G_SPEED         * Ground Speed
    971        67AA 0000                 FDB $0000            * First byte >>
    972        67AC               HERO_X_SPEED
    973        67AC 0000                 FDB $0000            * Horizontal >>
    974        67AE               HERO_X_SPS
    975        67AE 0000                 FDB $0000            * Subpixel X >>
    976        67B0               HERO_Y_SPEED
    977        67B0 0000                 FDB $0000            * Vertical Sp>>
    978        67B2               HERO_Y_SPS
    979        67B2 0000                 FDB $0000            * Subpixel Y >>
    980        67B4               HERO_TOP_SPEED
    981        67B4 0600                 FDB $0600        * vitesse maximum>>
    982        67B6               HERO_NEG_TOP_SPEED
    983        67B6 FA00                 FDB $FA00        * vitesse maximum>>
    984        67B8               HERO_ACCELERATION
    985        67B8 000C                 FDB $000C        * constante accel>>
    986        67BA               HERO_DECELERATION
    987        67BA 0080                 FDB $0080        * constante decel>>
    988        67BC               HERO_FRICTION
    989        67BC 000C                 FDB $000C        * constante de fr>>
    990        67BE               HERO_ANIMATION_ADR
    991        67BE 0000                 FDB $0000        * Animation coura>>
    992        67C0               HERO_ANIMATION_RTN_ADR
    993        67C0 0000                 FDB $0000        * Animation coura>>
    994        67C2               HERO_ANIMATION_PAG
    995        67C2 00                   FCB $00          * Animation coura>>
    996        67C3               HERO_ANIMATION_DEL
    997        67C3 0000                 FDB $0000        * Animation coura>>
    998        67C5               HERO_ANIMATION_DRW
    999        67C5 0000                 FDB $0000        * Animation coura>>
   1000        67C7               HERO_ANIMATION_IMC
   1001        67C7 00                   FCB $00          * Animation coura>>
   1002        67C8               HERO_ANIMATION_RTN_IMC
   1003        67C8 00                   FCB $00          * Animation coura>>
   1004        67C9               HERO_ANIMATION_FRR
   1005        67C9 00                   FCB $00          * Animation coura>>

000000 Total Errors

000106 Total Symbols
     0x          Label 6300 BEGIN
     3x          Label 64DE CLR_CART
     1x          Label 64F7 CLR_CART_2
     1x          Label 6513 CLR_CART_3
     1x          Label 6670 Compute_Position
     1x          Label 668D Compute_Position_01
     4x          Label 66A7 Compute_Position_02
     1x          Equ   0014 DEBUTECRANA
     1x          Equ   2014 DEBUTECRANB
     1x          Equ   622C DK_dernier_bloc_a_ecrire
     1x          Equ   6213 DK_destination
     1x          Equ   6205 DK_lecture
     1x          Equ   620A DK_piste
     1x          Equ   620F DK_secteur
     0x          Label 66A9 DRAW_RAM_DATA_TO_CART_160x200
     1x          Label 66B6 DRAW_RAM_DATA_TO_CART_160x200A
     1x          Label 66E7 DRAW_RAM_DATA_TO_CART_160x200B
     2x          Equ   1F40 FINECRANA
     2x          Equ   3F40 FINECRANB
     1x          Label 6738 FINTABPALETTE
     2x          Label 67B8 HERO_ACCELERATION
    13x          Label 67BE HERO_ANIMATION_ADR
     1x          Label 67C3 HERO_ANIMATION_DEL
     4x          Label 67C5 HERO_ANIMATION_DRW
     2x          Label 67C9 HERO_ANIMATION_FRR
     5x          Label 67C7 HERO_ANIMATION_IMC
     1x          Label 6738 HERO_ANIMATION_LOAD
     3x          Label 6741 HERO_ANIMATION_LOAD_00
     2x          Label 674E HERO_ANIMATION_LOAD_01
     1x          Label 6780 HERO_ANIMATION_LOAD_FE
     1x          Label 6770 HERO_ANIMATION_LOAD_NOPAGE
     1x          Label 678E HERO_ANIMATION_NEXT
     1x          Label 6794 HERO_ANIMATION_NEXT_00
     5x          Label 67C2 HERO_ANIMATION_PAG
     2x          Label 67C0 HERO_ANIMATION_RTN_ADR
     1x          Label 67C8 HERO_ANIMATION_RTN_IMC
     4x          Label 67BA HERO_DECELERATION
     2x          Label 67BC HERO_FRICTION
    17x          Label 67AA HERO_G_SPEED
     1x          Label 679E HERO_IDLE_L
     0x          Label 679E HERO_IDLE_L2
     2x          Label 679E HERO_IDLE_R
     2x          Equ   0600 HERO_JOG_SPD_LIMIT
     1x          Label 6534 Hero_Move
     1x          Label 65A6 Hero_MoveLeft
     1x          Label 65C0 Hero_MoveLeft_00
     1x          Label 65DE Hero_MoveLeft_01
     1x          Label 65BA Hero_MoveLeft_03
     1x          Label 65EA Hero_MoveRight
     1x          Label 6601 Hero_MoveRight_00
     1x          Label 661F Hero_MoveRight_01
     1x          Label 65FB Hero_MoveRight_03
    11x          Label 6628 Hero_MoveUpdatePos
     1x          Label 6642 Hero_MoveUpdatePos_00
     1x          Label 6659 Hero_MoveUpdatePos_01
     0x          Label 6659 Hero_MoveUpdatePos_03
     2x          Label 6641 Hero_MoveUpdatePos_V00
     3x          Label 67B6 HERO_NEG_TOP_SPEED
     1x          Label 653D Hero_NotLeft
     1x          Label 6544 Hero_NotLeftOrRight
     1x          Label 657B Hero_NotLeftOrRight_00
     1x          Label 6564 Hero_NotLeftOrRight_01
     1x          Label 6575 Hero_NotLeftOrRight_02
     1x          Label 6578 Hero_NotLeftOrRight_03
     1x          Label 658F Hero_NotLeftOrRight_11
     1x          Label 65A0 Hero_NotLeftOrRight_12
     1x          Label 65A3 Hero_NotLeftOrRight_13
     6x          Equ   9F02 HERO_POS
     1x          Label 679E HERO_RUN_L
     2x          Label 679E HERO_RUN_R
     0x          Label 679E HERO_SUBIDLE_B
     3x          Label 67B4 HERO_TOP_SPEED
     2x          Label 679E HERO_WALK_L
     2x          Label 679E HERO_WALK_R
     0x          Equ   0400 HERO_WALK_SPD_LIMIT
     4x          Label 67A8 HERO_X_POS
     2x          Label 67AC HERO_X_SPEED
     6x          Label 67AE HERO_X_SPS
     4x          Label 67A9 HERO_Y_POS
     1x          Label 67B0 HERO_Y_SPEED
     0x          Label 67B2 HERO_Y_SPS
     0x          Label 6357 INIT_VID
     0x          Equ   000D JOY_B
     0x          Equ   0005 JOY_BD
     0x          Equ   0009 JOY_BG
     1x          Label 6533 JOY_BTN_STATUS
     0x          Equ   000F JOY_C
     1x          Equ   0007 JOY_D
     2x          Label 6532 JOY_DIR_STATUS
     1x          Equ   000B JOY_G
     0x          Equ   000E JOY_H
     0x          Equ   0006 JOY_HD
     0x          Equ   000A JOY_HG
     1x          Label 651A JOY_READ
     1x          Label 63A6 MAIN
     2x          Label 63F1 MEM_COPY_DATA_TO_CART
     1x          Label 64D1 MEM_COPY_DATA_TO_CART_E
     1x          Label 64D9 MEM_COPY_DATA_TO_CART_S
     4x          Label 63C1 SCRC
     3x          Label 63DC SCRC0
     1x          Label 636A SETPALETTE
     3x          Equ   9F00 SSAVE
     1x          Label 6718 TABPALETTE
     1x          Label 63E6 VSYNC
     1x          Label 63E6 VSYNC_1
     1x          Label 63EB VSYNC_2

