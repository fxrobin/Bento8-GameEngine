/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : ./input/CODE/MAIN.ASS
 * Fichier destination : TMP.BIN
 * Contenu :
 *     Main     0:MAIN.ASM     14504
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
     12        6300                      ORG $6300
     13
     14                           *****************************************>>
     15                           * Constantes et variables
     16                           *****************************************>>
     17
     18                  6205     DK_lecture               EQU $6205 * rout>>
     19                  620A     DK_piste                 EQU $620A * 2B n>>
     20                  620F     DK_secteur               EQU $620F * 1B n>>
     21                  6213     DK_destination           EQU $6213 * 2B d>>
     22                  622C     DK_dernier_bloc_a_ecrire EQU $622C * 2B f>>
     23
     24                  0014     DEBUTECRANA EQU $0014 * test pour fin sta>>
     25                  1F40     FINECRANA   EQU $1F40 * fin de la RAM A v>>
     26                  2014     DEBUTECRANB EQU $2014 * test pour fin sta>>
     27                  3F40     FINECRANB   EQU $3F40 * fin de la RAM B v>>
     28
     29                  0005     JOY_BD EQU $05 * Bas Droite
     30                  0006     JOY_HD EQU $06 * Haut Droite
     31                  0007     JOY_D  EQU $07 * Droite
     32                  0009     JOY_BG EQU $09 * Bas Gauche
     33                  000A     JOY_HG EQU $0A * Haut Gauche
     34                  000B     JOY_G  EQU $0B * Gauche
     35                  000D     JOY_B  EQU $0D * Bas
     36                  000E     JOY_H  EQU $0E * Haut
     37                  000F     JOY_C  EQU $0F * Centre
     38
     39                  9F00     SSAVE    EQU $9F00 * BUFFER for S when us>>
     40                  9F02     HERO_POS EQU $9F02
     41
     42                           *****************************************>>
     43                           * Debut du programme
     44                           *****************************************>>
     45        6300               BEGIN
     46  2     6300 1A   50              ORCC #$50     * a documenter (inte>>
     47                            
     48  2     6302 86   7B              LDA #$7B      * passage en mode 16>>
     49  5     6304 B7   E7DC            STA $E7DC
     50                            
     51  3     6307 CC   0000            LDD #$0000     * Init variables gl>>
     52  6     630A FD   9F00            STD SSAVE
     53  3     630D CC   1F40            LDD #FINECRANA
     54  6     6310 FD   9F02            STD HERO_POS
     55  3     6313 CC   3F40            LDD #FINECRANB
     56  6     6316 FD   9F04            STD HERO_POS+2
     57
     58                           *****************************************>>
     59                           * Initialisation de la palette de couleur>>
     60                           *****************************************>>
     61  4     6319 108E 65E8            LDY #TABPALETTE
     62  2     631D 4F                   CLRA
     63        631E               SETPALETTE
     64  5+1   631E 34   02              PSHS A
     65  2     6320 48                   ASLA
     66  5     6321 B7   E7DB            STA $E7DB
     67  5+3   6324 EC   A1              LDD ,Y++
     68  5     6326 F7   E7DA            STB $E7DA
     69  5     6329 B7   E7DA            STA $E7DA
     70  5+1   632C 35   02              PULS A
     71  2     632E 4C                   INCA
     72  5     632F 108C 6608            CMPY #FINTABPALETTE
     73  3     6333 26   E9              BNE    SETPALETTE
     74
     75                           *****************************************>>
     76                           * Chargement des pages memoire
     77                           *****************************************>>
     78  2     6335 C6   04              LDB #$04                          >>
     79  5     6337 F7   E7E5            STB $E7E5                         >>
     80                            
     81  3     633A CC   0004            LDD #$0004
     82  6     633D FD   620A            STD DK_piste
     83  2     6340 86   01              LDA #$01
     84  5     6342 B7   620F            STA DK_secteur
     85  3     6345 CC   A000            LDD #$A000
     86  6     6348 FD   6213            STD DK_destination
     87  3     634B CC   DF00            LDD #$DF00
     88  6     634E FD   622C            STD DK_dernier_bloc_a_ecrire
     89  8     6351 BD   6205            JSR DK_lecture
     90                            
     91  2     6354 C6   04              LDB #$04                          >>
     92  5     6356 F7   E7E5            STB $E7E5                         >>
     93
     94  3     6359 8E   A000            LDX #$A000        * Copie page 4 e>>
     95        635C               MEM_CART_COPY
     96  5+0   635C EE   84              LDU ,X
     97  7     635E 7C   E7E5            INC $E7E5
     98  5+3   6361 EF   81              STU ,X++
     99  7     6363 7A   E7E5            DEC $E7E5
    100  4     6366 8C   E000            CMPX #$E000
    101  3     6369 26   F1              BNE MEM_CART_COPY
    102                            
    103                           *****************************************>>
    104                           * Initialisation de la routine de commuta>>
    105                           *****************************************>>
    106        636B               INIT_VID
    107  5     636B F6   6081            LDB $6081 * A documenter
    108  2     636E CA   10              ORB #$10  * mettre le bit d4 a 1
    109  5     6370 F7   6081            STB $6081
    110  5     6373 F7   E7E7            STB $E7E7
    111  8     6376 BD   63BA            JSR SCRC * page 2 en RAM Cartouche>>
    112
    113                           *****************************************>>
    114                           * Initialisation des deux pages videos av>>
    115                           *****************************************>>
    116  3     6379 8E   666E            LDX #HERO_IDLE_R
    117  8     637C BD   6608            JSR HERO_ANIMATION_LOAD
    118
    119  8     637F BD   6383         JSR INIT_SCREEN
    120        6382 02                   FCB $02
    121        6383               INIT_SCREEN
    122  3     6383 8E   0000            LDX #$0000
    123        6386               CLR_SCREEN
    124  6+2   6386 6F   80           CLR ,X+
    125  4     6388 8C   4000            CMPX #$4000
    126  3     638B 26   F9              BNE CLR_SCREEN
    127
    128  5     638D F6   6692            LDB HERO_ANIMATION_PAG            >>
    129  5     6390 F7   E7E5            STB $E7E5                         >>
    130  7+3   6393 AD   9F 6695         JSR [HERO_ANIMATION_DRW]          >>
    131                            
    132  8     6397 BD   63BA            JSR SCRC                          >>
    133                                                                    >>
    134  7     639A 7A   6382            DEC INIT_SCREEN-1
    135  3     639D 26   E4              BNE INIT_SCREEN
    136
    137                           *****************************************>>
    138                           * Boucle principale
    139                           *****************************************>>
    140        639F               MAIN
    141                                  * Effacement et affichage des spri>>
    142  5     639F F6   6692            LDB HERO_ANIMATION_PAG            >>
    143  5     63A2 F7   E7E5            STB $E7E5                         >>
    144                                  *JSR [HERO_ANIMATION_DEL]         >>
    145  7+3   63A5 AD   9F 6695         JSR [HERO_ANIMATION_DRW]          >>
    146
    147                                  * Gestion des deplacements
    148  8     63A9 BD   63EA            JSR JOY_READ
    149  8     63AC BD   6404            JSR Hero_Move
    150  8     63AF BD   6540            JSR Compute_Position
    151                            
    152  8     63B2 BD   665E            JSR HERO_ANIMATION_NEXT
    153
    154  8     63B5 BD   63BA            JSR SCRC                          >>
    155  3     63B8 20   E5              BRA MAIN
    156
    157                           *****************************************>>
    158                           * Changement de page ESPACE ECRAN (affich>>
    159                           *      $E7DD determine la page affichee d>>
    160                           *      D7=0 D6=0 D5=0 D4=0 (#$0_) : page >>
    161                           *      D7=0 D6=1 D5=0 D4=0 (#$4_) : page >>
    162                           *      D7=1 D6=0 D5=0 D4=0 (#$8_) : page >>
    163                           *      D7=1 D6=1 D5=0 D4=0 (#$C_) : page >>
    164                           *   D3 D2 D1 D0  (#$_0 a #$_F) : couleur >>
    165                           *   Remarque : D5 et D4 utilisable unique>>
    166                           *
    167                           * Changement de page ESPACE CARTOUCHE (ec>>
    168                           *      $E7E6 determine la page affichee d>>
    169                           *   D5 : 1 = espace cartouche recouvert p>>
    170                           *   D4 : 0 = CAS1N valide : banques 0-15 >>
    171                           *      D5=1 D4=0 D3=0 D2=0 D1=0 D0=0 (#$6>>
    172                           *   ...
    173                           *      D5=1 D4=0 D3=1 D2=1 D1=1 D0=1 (#$6>>
    174                           *      D5=1 D4=1 D3=0 D2=0 D1=0 D0=0 (#$7>>
    175                           *   ...
    176                           *      D5=1 D4=1 D3=1 D2=1 D1=1 D0=1 (#$7>>
    177                           *****************************************>>
    178        63BA               SCRC
    179  8     63BA BD   63DF            JSR VSYNC
    180
    181  5     63BD F6   63D6            LDB SCRC0+1
    182  2     63C0 C4   01              ANDB #$01
    183  5     63C2 FB   6692            ADDB HERO_ANIMATION_PAG
    184  5     63C5 F7   6692            STB HERO_ANIMATION_PAG
    185                            
    186  5     63C8 F6   63D6            LDB SCRC0+1   * charge la valeur d>>
    187  2     63CB C4   80              ANDB #$80     * permute #$00 ou #$>>
    188  2     63CD CA   0F              ORB #$0F      * recharger la coule>>
    189  5     63CF F7   E7DD            STB $E7DD     * changement page da>>
    190  7     63D2 73   63D6            COM SCRC0+1   * modification du co>>
    191        63D5               SCRC0
    192  2     63D5 C6   00              LDB #$00
    193  2     63D7 C4   02              ANDB #$02     * permute #$60 ou #$>>
    194  2     63D9 CA   60              ORB #$60      * espace cartouche r>>
    195  5     63DB F7   E7E6            STB $E7E6     * changement page da>>
    196  5     63DE 39                   RTS                  * E7E6 D5=1 p>>
    197                                                       * CAS1N : ban>>
    198
    199                           *****************************************>>
    200                           * Attente VBL
    201                           *****************************************>>
    202        63DF               VSYNC
    203        63DF               VSYNC_1
    204  7     63DF 7D   E7E7            TST    $E7E7
    205  3     63E2 2A   FB              BPL    VSYNC_1
    206        63E4               VSYNC_2
    207  7     63E4 7D   E7E7            TST    $E7E7
    208  3     63E7 2B   FB              BMI    VSYNC_2
    209  5     63E9 39                   RTS
    210
    211                           ****************************************
    212                           * Get joystick parameters
    213                           ****************************************
    214        63EA               JOY_READ
    215  3     63EA 8E   E7CF            ldx    #$e7cf
    216  4     63ED 108E E7CD            ldy    #$e7cd
    217  3     63F1 CC   400F            ldd    #$400f
    218  5     63F4 F4   E7CC            andb   >$e7cc     * Read position
    219  5     63F7 F7   6402            stb    JOY_DIR_STATUS
    220  4+0   63FA A4   A4              anda   ,y         * Read button
    221  2     63FC 88   40              eora   #$40
    222  5     63FE B7   6403            sta    JOY_BTN_STATUS
    223  5     6401 39                   RTS
    224        6402               JOY_DIR_STATUS
    225        6402 00                   FCB $00 * Position Pad
    226        6403               JOY_BTN_STATUS
    227        6403 00                   FCB $00 * 40 Bouton A enfonce
    228
    229                           *****************************************>>
    230                           * Subroutine to      make HERO walk/run
    231                           *****************************************>>
    232        6404               Hero_Move
    233  5     6404 B6   6402            LDA JOY_DIR_STATUS
    234  2     6407 81   0B              CMPA #JOY_G
    235  3     6409 26   02              BNE Hero_NotLeft
    236  3     640B 20   69              BRA Hero_MoveLeft
    237
    238        640D               Hero_NotLeft                   * XREF: He>>
    239  2     640D 81   07              CMPA #JOY_D
    240  3     640F 26   03              BNE Hero_NotLeftOrRight
    241  5     6411 16   00A6            LBRA Hero_MoveRight
    242
    243        6414               Hero_NotLeftOrRight            * XREF: He>>
    244  6     6414 FC   667A            LDD HERO_G_SPEED
    245  5     6417 1083 0000            CMPD #$0000
    246  3     641B 2D   2E              BLT Hero_NotLeftOrRight_00 * se de>>
    247  7     641D B3   668C            SUBD HERO_FRICTION     * se deplac>>
    248  3     6420 24   12              BCC Hero_NotLeftOrRight_01 * si on>>
    249  3     6422 CC   0000            LDD #$0000
    250  6     6425 FD   667A            STD HERO_G_SPEED
    251  6     6428 FD   667E            STD HERO_X_SPS
    252  3     642B 8E   666E            LDX #HERO_IDLE_R        * Charge a>>
    253  6     642E BF   668E            STX HERO_ANIMATION_ADR      * Sauv>>
    254  5     6431 16   00C4            LBRA Hero_MoveUpdatePos
    255        6434               Hero_NotLeftOrRight_01
    256  5     6434 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    257  3     6438 2C   0B              BGE Hero_NotLeftOrRight_02
    258  6     643A FD   667A            STD HERO_G_SPEED
    259  3     643D 8E   666E            LDX #HERO_WALK_R        * Charge a>>
    260  6     6440 BF   668E            STX HERO_ANIMATION_ADR      * Sauv>>
    261  3     6443 20   03              BRA Hero_NotLeftOrRight_03
    262        6445               Hero_NotLeftOrRight_02
    263  6     6445 FD   667A            STD HERO_G_SPEED
    264        6448               Hero_NotLeftOrRight_03
    265  5     6448 16   00AD            LBRA Hero_MoveUpdatePos
    266        644B               Hero_NotLeftOrRight_00
    267  7     644B F3   668C            ADDD HERO_FRICTION     * se deplac>>
    268  3     644E 24   0F              BCC Hero_NotLeftOrRight_11 * si on>>
    269  3     6450 CC   0000            LDD #$0000
    270  6     6453 FD   667A            STD HERO_G_SPEED
    271  3     6456 8E   666E            LDX #HERO_IDLE_L        * Charge a>>
    272  6     6459 BF   668E            STX HERO_ANIMATION_ADR      * Sauv>>
    273  5     645C 16   0099            LBRA Hero_MoveUpdatePos
    274        645F               Hero_NotLeftOrRight_11
    275  5     645F 1083 0600            CMPD #HERO_JOG_SPD_LIMIT
    276  3     6463 2F   0B              BLE Hero_NotLeftOrRight_12
    277  6     6465 FD   667A            STD HERO_G_SPEED
    278  3     6468 8E   666E            LDX #HERO_WALK_L        * Charge a>>
    279  6     646B BF   668E            STX HERO_ANIMATION_ADR      * Sauv>>
    280  3     646E 20   03              BRA Hero_NotLeftOrRight_13
    281        6470               Hero_NotLeftOrRight_12
    282  6     6470 FD   667A            STD HERO_G_SPEED
    283        6473               Hero_NotLeftOrRight_13
    284  5     6473 16   0082            LBRA Hero_MoveUpdatePos
    285
    286        6476               Hero_MoveLeft                      * XREF>>
    287  6     6476 FC   667A            LDD HERO_G_SPEED            * Char>>
    288  5     6479 1083 0000            CMPD #$0000                 * Test>>
    289  3     647D 2F   11              BLE Hero_MoveLeft_00        * BRAN>>
    290  7     647F B3   668A            SUBD HERO_DECELERATION      * orie>>
    291  3     6482 24   06              BCC Hero_MoveLeft_03        * BRAN>>
    292  3     6484 CC   0000            LDD #$0000
    293  7     6487 B3   668A            SUBD HERO_DECELERATION      * si l>>
    294        648A               Hero_MoveLeft_03
    295  6     648A FD   667A            STD HERO_G_SPEED            * On s>>
    296  5     648D 16   0068            LBRA Hero_MoveUpdatePos           >>
    297        6490               Hero_MoveLeft_00                         >>
    298                           *      CMPD #$0000                       >>
    299                           *      BNE Hero_MoveLeft_02        * BRAN>>
    300                           *      LDD #$FEFF                        >>
    301                           *Hero_MoveLeft_02
    302  8     6490 10B3 6686            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    303  3     6494 27   62              BEQ Hero_MoveUpdatePos      * vite>>
    304  7     6496 B3   6688            SUBD HERO_ACCELERATION      * acce>>
    305  8     6499 10B3 6686            CMPD HERO_NEG_TOP_SPEED     * Comp>>
    306  3     649D 2E   0F              BGT Hero_MoveLeft_01        * BRAN>>
    307  3     649F 8E   666E            LDX #HERO_RUN_L        * Charge an>>
    308  6     64A2 BF   668E            STX HERO_ANIMATION_ADR      * Sauv>>
    309  6     64A5 FC   6686            LDD HERO_NEG_TOP_SPEED      * Limi>>
    310  6     64A8 FD   667A            STD HERO_G_SPEED            * Enre>>
    311  5     64AB 16   004A            LBRA Hero_MoveUpdatePos     * Mise>>
    312        64AE               Hero_MoveLeft_01
    313  6     64AE FD   667A            STD HERO_G_SPEED            * Enre>>
    314  3     64B1 8E   666E            LDX #HERO_WALK_L        * Charge a>>
    315  6     64B4 BF   668E            STX HERO_ANIMATION_ADR      * Sauv>>
    316  5     64B7 16   003E            LBRA Hero_MoveUpdatePos
    317
    318        64BA               Hero_MoveRight                  * XREF: H>>
    319  6     64BA FC   667A            LDD HERO_G_SPEED        * Chargeme>>
    320  5     64BD 1083 0000            CMPD #$0000                 * Test>>
    321  3     64C1 2C   0E              BGE Hero_MoveRight_00       * BRAN>>
    322  7     64C3 F3   668A            ADDD HERO_DECELERATION      * orie>>
    323  3     64C6 24   03              BCC Hero_MoveRight_03       * BRAN>>
    324  6     64C8 FC   668A            LDD HERO_DECELERATION   * si la vi>>
    325        64CB               Hero_MoveRight_03
    326  6     64CB FD   667A            STD HERO_G_SPEED        * On stock>>
    327  5     64CE 16   0027            LBRA Hero_MoveUpdatePos           >>
    328        64D1               Hero_MoveRight_00                  * Orie>>
    329                           *      CMPD #$0000                       >>
    330                           *      BNE Hero_MoveRight_02       * BRAN>>
    331                           *      LDD #$0100                        >>
    332                           *Hero_MoveRight_02
    333  8     64D1 10B3 6684            CMPD HERO_TOP_SPEED         * Comp>>
    334  3     64D5 27   21              BEQ Hero_MoveUpdatePos      * vite>>
    335  7     64D7 F3   6688            ADDD HERO_ACCELERATION      * acce>>
    336  8     64DA 10B3 6684            CMPD HERO_TOP_SPEED         * Comp>>
    337  3     64DE 2D   0F              BLT Hero_MoveRight_01       * BRAN>>
    338  3     64E0 8E   666E            LDX #HERO_RUN_R                   >>
    339  6     64E3 BF   668E            STX HERO_ANIMATION_ADR      * Sauv>>
    340  6     64E6 FC   6684            LDD HERO_TOP_SPEED          * Limi>>
    341  6     64E9 FD   667A            STD HERO_G_SPEED            * Enre>>
    342  5     64EC 16   0009            LBRA Hero_MoveUpdatePos           >>
    343        64EF               Hero_MoveRight_01
    344  6     64EF FD   667A            STD HERO_G_SPEED            * Enre>>
    345  3     64F2 8E   666E            LDX #HERO_WALK_R        * Charge a>>
    346  6     64F5 BF   668E            STX HERO_ANIMATION_ADR      * Sauv>>
    347
    348        64F8               Hero_MoveUpdatePos
    349  6     64F8 FC   667A            LDD HERO_G_SPEED            * Char>>
    350  6     64FB FD   667C            STD HERO_X_SPEED        * Stockage>>
    351  5     64FE 1083 0000            CMPD #$0000                 * Test>>
    352  3     6502 2D   0E              BLT Hero_MoveUpdatePos_00   * BRAN>>
    353  7     6504 F3   667E            ADDD HERO_X_SPS         * Ajout du>>
    354  5     6507 F7   667F            STB HERO_X_SPS+1            * sauv>>
    355  6     650A 1F   89              TFR A,B                     * Divi>>
    356  5     650C FB   6678            ADDB HERO_X_POS                   >>
    357  3     650F 20   18              BRA Hero_MoveUpdatePos_01
    358        6511               Hero_MoveUpdatePos_V00
    359        6511 00                   FCB $00
    360        6512               Hero_MoveUpdatePos_00
    361  3     6512 CC   0000            LDD #$0000
    362  7     6515 B3   667C            SUBD HERO_X_SPEED           * La v>>
    363  7     6518 F3   667E            ADDD HERO_X_SPS         * Ajout du>>
    364  5     651B F7   667F            STB HERO_X_SPS+1            * sauv>>
    365  6     651E 1F   89              TFR A,B                     * Divi>>
    366  5     6520 F7   6511            STB Hero_MoveUpdatePos_V00
    367  5     6523 F6   6678            LDB HERO_X_POS
    368  5     6526 F0   6511            SUBB Hero_MoveUpdatePos_V00 * Ajou>>
    369        6529               Hero_MoveUpdatePos_01
    370                           *      CMPB #$50                         >>
    371                           *      BLE Hero_MoveUpdatePos_02   * Bute>>
    372                           *      LDB #$50                          >>
    373                           *Hero_MoveUpdatePos_02
    374                           *    CMPB #$0C                           >>
    375                           *      BGE Hero_MoveUpdatePos_03   * Bute>>
    376                           *      LDB #$0C                          >>
    377        6529               Hero_MoveUpdatePos_03
    378  5     6529 F7   6678            STB HERO_X_POS
    379  2     652C C6   00              LDB #$00
    380  5     652E F7   667E            STB HERO_X_SPS                    >>
    381  3     6531 CC   0000            LDD #$0000                  * TODO>>
    382  6     6534 FD   6680            STD HERO_Y_SPEED
    383  6     6537 1F   89              TFR A,B                     * divi>>
    384  5     6539 FB   6679            ADDB HERO_Y_POS
    385  5     653C F7   6679            STB HERO_Y_POS
    386  5     653F 39                   RTS
    387
    388                           * TODO : Braking Animation
    389                           * Sonic enters his braking animation when>>
    390                           * In Sonic 1 and Sonic CD, he then stays >>
    391                           * In the other 3 games, Sonic returns to >>
    392
    393        6540               Compute_Position
    394  5     6540 B6   6678            LDA HERO_X_POS
    395  2     6543 44                   LSRA
    396  3     6544 25   17              BCS Compute_Position_01
    397  5     6546 B7   6578            STA Compute_Position_02+1
    398  2     6549 86   28              LDA #$28
    399  5     654B F6   6679            LDB HERO_Y_POS
    400  2     654E 5A                   DECB
    401  11    654F 3D                   MUL
    402  7     6550 F3   6577            ADDD Compute_Position_02
    403  6     6553 FD   9F02            STD HERO_POS
    404  4     6556 C3   2000            ADDD #$2000
    405  6     6559 FD   9F04            STD HERO_POS+2
    406  5     655C 39                   RTS
    407        655D               Compute_Position_01
    408  5     655D B7   6578            STA Compute_Position_02+1
    409  2     6560 86   28              LDA #$28
    410  5     6562 F6   6679            LDB HERO_Y_POS
    411  2     6565 5A                   DECB
    412  11    6566 3D                   MUL
    413  7     6567 F3   6577            ADDD Compute_Position_02
    414  4     656A C3   2000            ADDD #$2000
    415  6     656D FD   9F02            STD HERO_POS
    416  4     6570 83   1FFF            SUBD #$1FFF
    417  6     6573 FD   9F04            STD HERO_POS+2
    418  5     6576 39                   RTS
    419        6577               Compute_Position_02
    420        6577 0000                 FDB $0000
    421                            
    422                           *****************************************>>
    423                           * Affichage de l arriere plan xxx cycles
    424                           *****************************************>>
    425        6579               DRAW_RAM_DATA_TO_CART_160x200
    426  5+3   6579 34   48              PSHS U,DP            * sauvegarde >>
    427  7     657B 10FF 9F00            STS >SSAVE
    428                            
    429  4     657F 10CE 1F40            LDS #FINECRANA       * init pointe>>
    430  3     6583 CE   A000            LDU #$A000
    431
    432        6586               DRAW_RAM_DATA_TO_CART_160x200A
    433  5+7   6586 37   3E              PULU A,B,DP,X,Y
    434  5+7   6588 34   3E              PSHS Y,X,DP,B,A
    435  5+7   658A 37   3E              PULU A,B,DP,X,Y
    436  5+7   658C 34   3E              PSHS Y,X,DP,B,A
    437  5+7   658E 37   3E              PULU A,B,DP,X,Y
    438  5+7   6590 34   3E              PSHS Y,X,DP,B,A
    439  5+7   6592 37   3E              PULU A,B,DP,X,Y
    440  5+7   6594 34   3E              PSHS Y,X,DP,B,A
    441  5+7   6596 37   3E              PULU A,B,DP,X,Y
    442  5+7   6598 34   3E              PSHS Y,X,DP,B,A
    443  5+7   659A 37   3E              PULU A,B,DP,X,Y
    444  5+7   659C 34   3E              PSHS Y,X,DP,B,A
    445  5     659E 118C 0014            CMPS #DEBUTECRANA
    446  3     65A2 26   E2              BNE DRAW_RAM_DATA_TO_CART_160x200A>>
    447  5+7   65A4 37   3E              PULU A,B,DP,X,Y
    448  5+7   65A6 34   3E              PSHS Y,X,DP,B,A
    449  5+7   65A8 37   3E              PULU A,B,DP,X,Y
    450  5+7   65AA 34   3E              PSHS Y,X,DP,B,A
    451  5+6   65AC 37   3C              PULU B,DP,X,Y
    452  5+6   65AE 34   3C              PSHS Y,X,DP,B
    453
    454  4     65B0 10CE 3F40            LDS #FINECRANB       * init pointe>>
    455  3     65B4 CE   C000            LDU #$C000
    456
    457        65B7               DRAW_RAM_DATA_TO_CART_160x200B
    458  5+7   65B7 37   3E              PULU A,B,DP,X,Y
    459  5+7   65B9 34   3E              PSHS Y,X,DP,B,A
    460  5+7   65BB 37   3E              PULU A,B,DP,X,Y
    461  5+7   65BD 34   3E              PSHS Y,X,DP,B,A
    462  5+7   65BF 37   3E              PULU A,B,DP,X,Y
    463  5+7   65C1 34   3E              PSHS Y,X,DP,B,A
    464  5+7   65C3 37   3E              PULU A,B,DP,X,Y
    465  5+7   65C5 34   3E              PSHS Y,X,DP,B,A
    466  5+7   65C7 37   3E              PULU A,B,DP,X,Y
    467  5+7   65C9 34   3E              PSHS Y,X,DP,B,A
    468  5+7   65CB 37   3E              PULU A,B,DP,X,Y
    469  5+7   65CD 34   3E              PSHS Y,X,DP,B,A
    470  5     65CF 118C 2014            CMPS #DEBUTECRANB
    471  3     65D3 26   E2              BNE DRAW_RAM_DATA_TO_CART_160x200B>>
    472  5+7   65D5 37   3E              PULU A,B,DP,X,Y
    473  5+7   65D7 34   3E              PSHS Y,X,DP,B,A
    474  5+7   65D9 37   3E              PULU A,B,DP,X,Y
    475  5+7   65DB 34   3E              PSHS Y,X,DP,B,A
    476  5+6   65DD 37   3C              PULU B,DP,X,Y
    477  5+6   65DF 34   3C              PSHS Y,X,DP,B
    478
    479  7     65E1 10FE 9F00            LDS  >SSAVE          * rechargemen>>
    480  5+3   65E5 35   48              PULS U,DP
    481  5     65E7 39                   RTS
    482                            
    483                           *****************************************>>
    484                           * Palette de 16 couleurs
    485                           *****************************************>>
    486        65E8               TABPALETTE
    487        65E8 0CCD                 FDB $0ccd     * index:0  R:244 V:2>>
    488        65EA 0BA4                 FDB $0ba4     * index:1  R:164 V:2>>
    489        65EC 035D                 FDB $035d     * index:2  R:244 V:1>>
    490        65EE 0D81                 FDB $0d81     * index:3  R:108 V:2>>
    491        65F0 013B                 FDB $013b     * index:4  R:228 V:1>>
    492        65F2 0541                 FDB $0541     * index:5  R:100 V:1>>
    493        65F4 0D30                 FDB $0d30     * index:6  R:43  V:1>>
    494        65F6 0017                 FDB $0017     * index:7  R:196 V:1>>
    495        65F8 000B                 FDB $000b     * index:8  R:228 V:2>>
    496        65FA 0D10                 FDB $0d10     * index:9  R:4   V:1>>
    497        65FC 0110                 FDB $0110     * index:10 R:28  V:9>>
    498        65FE 0003                 FDB $0003     * index:11 R:148 V:2>>
    499        6600 0700                 FDB $0700     * index:12 R:4   V:5>>
    500        6602 0200                 FDB $0200     * index:13 R:4   V:2>>
    501        6604 0000                 FDB $0000     * index:14 R:68  V:2>>
    502        6606 0000                 FDB $0000     * index:15 R:4   V:2>>
    503        6608               FINTABPALETTE
    504
    505                           *****************************************>>
    506                           * HERO Animations
    507                           * ---------------
    508                           * Note: Speed abs +0, rel +8, rel cap +10>>
    509                           *
    510                           * Chargement nouvelle animation
    511                           *    nouvelle frame = 109 a 119
    512                           *
    513                           * Chargement frame suivante
    514                           *    frame identique = 15
    515                           * ou frame suivante  = 116 a 126
    516                           *
    517                           * Chargement frame suivante avec branchem>>
    518                           *    nouvelle frame = 165 a 175
    519                           * ou frame suivante = 172 a 182
    520                           *
    521                           * Chargement frame suivante avec retour s>>
    522                           *    nouvelle frame = 167 a 177
    523                           * ou frame suivante = 174 a 184
    524                           *****************************************>>
    525
    526        6608               HERO_ANIMATION_LOAD                      >>
    527  6     6608 BF   668E            STX HERO_ANIMATION_ADR
    528  6     660B BF   6690            STX HERO_ANIMATION_RTN_ADR
    529  7     660E 7F   6697            CLR HERO_ANIMATION_IMC            >>
    530        6611               HERO_ANIMATION_LOAD_00
    531  5+1   6611 EC   1E              LDD -2,X                          >>
    532  2     6613 81   00              CMPA #$00                         >>
    533  3     6615 27   07              BEQ HERO_ANIMATION_LOAD_01
    534  5     6617 F0   667A            SUBB HERO_G_SPEED                 >>
    535  3     661A 24   02              BCC HERO_ANIMATION_LOAD_01
    536  2     661C C6   01              LDB #$01                          >>
    537        661E               HERO_ANIMATION_LOAD_01
    538  5     661E F7   6699            STB HERO_ANIMATION_FRR            >>
    539  5     6621 B6   6697            LDA HERO_ANIMATION_IMC
    540  2     6624 C6   05              LDB #$05
    541  11    6626 3D                   MUL
    542  7     6627 F3   668E            ADDD HERO_ANIMATION_ADR
    543  6     662A 1F   02              TFR D,Y
    544  4+0   662C E6   A4              LDB ,Y
    545  2     662E C1   1F              CMPB #$1F                         >>
    546  3     6630 22   0E              BHI HERO_ANIMATION_LOAD_NOPAGE
    547  5     6632 F7   6692            STB HERO_ANIMATION_PAG            >>
    548  5+1   6635 AE   21              LDX 1,Y
    549  6     6637 BF   6695            STX HERO_ANIMATION_DRW
    550  5+1   663A AE   23              LDX 3,Y
    551  6     663C BF   6693            STX HERO_ANIMATION_DEL
    552  5     663F 39                   RTS
    553        6640               HERO_ANIMATION_LOAD_NOPAGE
    554  2     6640 C1   FF              CMPB #$FF
    555  3     6642 26   0C              BNE HERO_ANIMATION_LOAD_FE
    556  5+1   6644 AE   23              LDX 3,Y
    557  6     6646 BF   6697            STX HERO_ANIMATION_IMC            >>
    558  5+1   6649 AE   21              LDX 1,Y
    559  6     664B BF   668E            STX HERO_ANIMATION_ADR
    560  3     664E 20   C1              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    561        6650               HERO_ANIMATION_LOAD_FE
    562  6     6650 BE   6690            LDX HERO_ANIMATION_RTN_ADR  * RETU>>
    563  6     6653 BF   668E            STX HERO_ANIMATION_ADR
    564  5     6656 F6   6698            LDB HERO_ANIMATION_RTN_IMC
    565  5     6659 F7   6697            STB HERO_ANIMATION_IMC
    566  3     665C 20   B3              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    567
    568        665E               HERO_ANIMATION_NEXT
    569  7     665E 7A   6699            DEC HERO_ANIMATION_FRR
    570  3     6661 27   01              BEQ HERO_ANIMATION_NEXT_00  * BRAN>>
    571  5     6663 39                   RTS
    572        6664               HERO_ANIMATION_NEXT_00
    573  7     6664 7C   6697            INC HERO_ANIMATION_IMC
    574  6     6667 BE   668E            LDX HERO_ANIMATION_ADR
    575  3     666A 20   A5              BRA HERO_ANIMATION_LOAD_00  * Outp>>
    576                            
    577                           *   SAMPLE CODE ANIMATION
    578                           *      ---------------------
    579                           *      FDB $0018            * 00 Absolute>>
    580                           *HERO_IDLE_L
    581                           *      FCB $01                     * Page>>
    582                           *      FDB $A000            * Adresse drw>>
    583                           *      FDB $A000            * Adresse del>>
    584                           *
    585                           *      FCB $FF                     * FF S>>
    586                           *      FDB HERO_IDLE-C * adresse animatio>>
    587                           *      FDB $0301            * 03 image ci>>
    588                           *
    589                           *      FCB $FE                     * FE R>>
    590                           *
    591                           *      LDX #HERO_IDLE_R
    592                           *      JSR HERO_ANIMATION_LOAD
    593                           *
    594                           *      JSR HERO_ANIMATION_NEXT
    595
    596                           *<ANIMATION_TABLE>
    597                           * Limite a 128 images par animations
    598
    599        666C 0001                 FDB $0001
    600        666E               HERO_IDLE_L
    601        666E               HERO_IDLE_R
    602        666E               HERO_IDLE_L2
    603        666E               HERO_SUBIDLE_B
    604        666E               HERO_WALK_L
    605        666E               HERO_WALK_R
    606        666E               HERO_RUN_L
    607        666E               HERO_RUN_R
    608        666E 04                   FCB $04
    609        666F A000                 FDB $A000
    610        6671 A000                 FDB $A000
    611        6673 FF                   FCB $FF
    612        6674 666E                 FDB HERO_RUN_R
    613        6676 0000                 FDB $0000
    614                            
    615                           *****************************************>>
    616                           * HERO Variables
    617                           *****************************************>>
    618                  0400     HERO_WALK_SPD_LIMIT EQU $0400
    619                  0600     HERO_JOG_SPD_LIMIT  EQU $0600
    620        6678               HERO_X_POS
    621        6678 50                   FCB $50                     * Hori>>
    622        6679               HERO_Y_POS
    623        6679 C8                   FCB $C8                     * Vert>>
    624        667A               HERO_G_SPEED         * Ground Speed
    625        667A 0000                 FDB $0000            * First byte >>
    626        667C               HERO_X_SPEED
    627        667C 0000                 FDB $0000            * Horizontal >>
    628        667E               HERO_X_SPS
    629        667E 0000                 FDB $0000            * Subpixel X >>
    630        6680               HERO_Y_SPEED
    631        6680 0000                 FDB $0000            * Vertical Sp>>
    632        6682               HERO_Y_SPS
    633        6682 0000                 FDB $0000            * Subpixel Y >>
    634        6684               HERO_TOP_SPEED
    635        6684 0600                 FDB $0600        * vitesse maximum>>
    636        6686               HERO_NEG_TOP_SPEED
    637        6686 FA00                 FDB $FA00        * vitesse maximum>>
    638        6688               HERO_ACCELERATION
    639        6688 000C                 FDB $000C        * constante accel>>
    640        668A               HERO_DECELERATION
    641        668A 0080                 FDB $0080        * constante decel>>
    642        668C               HERO_FRICTION
    643        668C 000C                 FDB $000C        * constante de fr>>
    644        668E               HERO_ANIMATION_ADR
    645        668E 0000                 FDB $0000        * Animation coura>>
    646        6690               HERO_ANIMATION_RTN_ADR
    647        6690 0000                 FDB $0000        * Animation coura>>
    648        6692               HERO_ANIMATION_PAG
    649        6692 00                   FCB $00          * Animation coura>>
    650        6693               HERO_ANIMATION_DEL
    651        6693 0000                 FDB $0000        * Animation coura>>
    652        6695               HERO_ANIMATION_DRW
    653        6695 0000                 FDB $0000        * Animation coura>>
    654        6697               HERO_ANIMATION_IMC
    655        6697 00                   FCB $00          * Animation coura>>
    656        6698               HERO_ANIMATION_RTN_IMC
    657        6698 00                   FCB $00          * Animation coura>>
    658        6699               HERO_ANIMATION_FRR
    659        6699 00                   FCB $00          * Animation coura>>

000000 Total Errors

000103 Total Symbols
     0x          Label 6300 BEGIN
     1x          Label 6386 CLR_SCREEN
     1x          Label 6540 Compute_Position
     1x          Label 655D Compute_Position_01
     4x          Label 6577 Compute_Position_02
     1x          Equ   0014 DEBUTECRANA
     1x          Equ   2014 DEBUTECRANB
     1x          Equ   622C DK_dernier_bloc_a_ecrire
     1x          Equ   6213 DK_destination
     1x          Equ   6205 DK_lecture
     1x          Equ   620A DK_piste
     1x          Equ   620F DK_secteur
     0x          Label 6579 DRAW_RAM_DATA_TO_CART_160x200
     1x          Label 6586 DRAW_RAM_DATA_TO_CART_160x200A
     1x          Label 65B7 DRAW_RAM_DATA_TO_CART_160x200B
     2x          Equ   1F40 FINECRANA
     2x          Equ   3F40 FINECRANB
     1x          Label 6608 FINTABPALETTE
     2x          Label 6688 HERO_ACCELERATION
    13x          Label 668E HERO_ANIMATION_ADR
     1x          Label 6693 HERO_ANIMATION_DEL
     3x          Label 6695 HERO_ANIMATION_DRW
     2x          Label 6699 HERO_ANIMATION_FRR
     5x          Label 6697 HERO_ANIMATION_IMC
     1x          Label 6608 HERO_ANIMATION_LOAD
     3x          Label 6611 HERO_ANIMATION_LOAD_00
     2x          Label 661E HERO_ANIMATION_LOAD_01
     1x          Label 6650 HERO_ANIMATION_LOAD_FE
     1x          Label 6640 HERO_ANIMATION_LOAD_NOPAGE
     1x          Label 665E HERO_ANIMATION_NEXT
     1x          Label 6664 HERO_ANIMATION_NEXT_00
     5x          Label 6692 HERO_ANIMATION_PAG
     2x          Label 6690 HERO_ANIMATION_RTN_ADR
     1x          Label 6698 HERO_ANIMATION_RTN_IMC
     4x          Label 668A HERO_DECELERATION
     2x          Label 668C HERO_FRICTION
    17x          Label 667A HERO_G_SPEED
     1x          Label 666E HERO_IDLE_L
     0x          Label 666E HERO_IDLE_L2
     2x          Label 666E HERO_IDLE_R
     2x          Equ   0600 HERO_JOG_SPD_LIMIT
     1x          Label 6404 Hero_Move
     1x          Label 6476 Hero_MoveLeft
     1x          Label 6490 Hero_MoveLeft_00
     1x          Label 64AE Hero_MoveLeft_01
     1x          Label 648A Hero_MoveLeft_03
     1x          Label 64BA Hero_MoveRight
     1x          Label 64D1 Hero_MoveRight_00
     1x          Label 64EF Hero_MoveRight_01
     1x          Label 64CB Hero_MoveRight_03
    11x          Label 64F8 Hero_MoveUpdatePos
     1x          Label 6512 Hero_MoveUpdatePos_00
     1x          Label 6529 Hero_MoveUpdatePos_01
     0x          Label 6529 Hero_MoveUpdatePos_03
     2x          Label 6511 Hero_MoveUpdatePos_V00
     3x          Label 6686 HERO_NEG_TOP_SPEED
     1x          Label 640D Hero_NotLeft
     1x          Label 6414 Hero_NotLeftOrRight
     1x          Label 644B Hero_NotLeftOrRight_00
     1x          Label 6434 Hero_NotLeftOrRight_01
     1x          Label 6445 Hero_NotLeftOrRight_02
     1x          Label 6448 Hero_NotLeftOrRight_03
     1x          Label 645F Hero_NotLeftOrRight_11
     1x          Label 6470 Hero_NotLeftOrRight_12
     1x          Label 6473 Hero_NotLeftOrRight_13
     6x          Equ   9F02 HERO_POS
     1x          Label 666E HERO_RUN_L
     2x          Label 666E HERO_RUN_R
     0x          Label 666E HERO_SUBIDLE_B
     3x          Label 6684 HERO_TOP_SPEED
     2x          Label 666E HERO_WALK_L
     2x          Label 666E HERO_WALK_R
     0x          Equ   0400 HERO_WALK_SPD_LIMIT
     4x          Label 6678 HERO_X_POS
     2x          Label 667C HERO_X_SPEED
     6x          Label 667E HERO_X_SPS
     4x          Label 6679 HERO_Y_POS
     1x          Label 6680 HERO_Y_SPEED
     0x          Label 6682 HERO_Y_SPS
     3x          Label 6383 INIT_SCREEN
     0x          Label 636B INIT_VID
     0x          Equ   000D JOY_B
     0x          Equ   0005 JOY_BD
     0x          Equ   0009 JOY_BG
     1x          Label 6403 JOY_BTN_STATUS
     0x          Equ   000F JOY_C
     1x          Equ   0007 JOY_D
     2x          Label 6402 JOY_DIR_STATUS
     1x          Equ   000B JOY_G
     0x          Equ   000E JOY_H
     0x          Equ   0006 JOY_HD
     0x          Equ   000A JOY_HG
     1x          Label 63EA JOY_READ
     1x          Label 639F MAIN
     1x          Label 635C MEM_CART_COPY
     3x          Label 63BA SCRC
     3x          Label 63D5 SCRC0
     1x          Label 631E SETPALETTE
     3x          Equ   9F00 SSAVE
     1x          Label 65E8 TABPALETTE
     1x          Label 63DF VSYNC
     1x          Label 63DF VSYNC_1
     1x          Label 63E4 VSYNC_2

