/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : TEST1X10.asm
 * Fichier destination : TEST1X10.BIN
 * Contenu :
 *     Main     0:TEST1X10.asm 7291
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
     12        8000                      ORG $8000
     13
     14                           *****************************************>>
     15                           * Constantes et variables
     16                           *****************************************>>
     17                  0014     DEBUTECRANA EQU $0014       * test pour f>>
     18                  1F40     FINECRANA EQU $1F40  * fin de la RAM A vi>>
     19                  2014     DEBUTECRANB EQU $2014       * test pour f>>
     20                  3F40     FINECRANB EQU $3F40  * fin de la RAM B vi>>
     21
     22        8000 0000          SSAVE FDB $0000
     23
     24                           *****************************************>>
     25                           * Debut du programme
     26                           *****************************************>>
     27  2     8002 1A   50              ORCC #$50     * a documenter (inte>>
     28                            
     29  2     8004 86   7B              LDA #$7B      * passage en mode 16>>
     30  5     8006 B7   E7DC            STA $E7DC
     31
     32                           *****************************************>>
     33                           * Initialisation de la palette de couleur>>
     34                           *****************************************>>
     35  4     8009 108E 8223            LDY #TABPALETTE
     36  2     800D 4F                   CLRA
     37        800E               SETPALETTE
     38  5+1   800E 34   02              PSHS A
     39  2     8010 48                   ASLA
     40  5     8011 B7   E7DB            STA $E7DB
     41  5+3   8014 EC   A1              LDD ,Y++
     42  5     8016 F7   E7DA            STB $E7DA
     43  5     8019 B7   E7DA            STA $E7DA
     44  5+1   801C 35   02              PULS A
     45  2     801E 4C                   INCA
     46  5     801F 108C 8243            CMPY #FINTABPALETTE
     47  3     8023 26   E9              BNE    SETPALETTE
     48                            
     49                           *****************************************>>
     50                           * Initialisation de la couleur de bordure>>
     51                           *****************************************>>
     52        8025               INITBORD
     53  2     8025 86   0F              LDA    #$0F   * couleur 15
     54  5     8027 B7   E7DD            STA    $E7DD
     55
     56                           *****************************************>>
     57                           * Initialisation de la routine de commuta>>
     58                           *****************************************>>
     59  5     802A F6   6081            LDB $6081
     60  2     802D CA   10              ORB #$10
     61  5     802F F7   6081            STB $6081
     62  5     8032 F7   E7E7            STB $E7E7
     63
     64                           *****************************************>>
     65                           * Effacement ecran (les deux pages)
     66                           *****************************************>>
     67  2     8035 C6   03              LDB #$03
     68  5     8037 F7   E7E5            STB $E7E5
     69  8     803A BD   80DA            JSR SCRC
     70  8     803D BD   80FC            JSR DRAWBCKGRN
     71  8     8040 BD   80DA            JSR SCRC
     72  8     8043 BD   80FC            JSR DRAWBCKGRN
     73  8     8046 BD   80DA            JSR SCRC        * changement de pa>>
     74                           *****************************************>>
     75                           * Boucle principale
     76                           *****************************************>>
     77  8     8049 BD   816B            JSR DRAW_TEST1X100000
     78                            
     79  6     804C BE   81B9            LDX POS_TEST1X100000 * save des po>>
     80  7     804F 10BE 81BD            LDY DRAW_EREF_TEST1X100000_1
     81  5+1   8053 AF   A8 2D           STX 45,Y
     82  6     8056 BE   81BB            LDX POS_TEST1X100000+2
     83  7     8059 10BE 81BD            LDY DRAW_EREF_TEST1X100000_1
     84  5+1   805D AF   A8 2F           STX 47,Y
     85                            
     86  6     8060 BE   81BD            LDX DRAW_EREF_TEST1X100000_1
     87  7     8063 10BE 81BF            LDY DRAW_EREF_TEST1X100000_1+2
     88  7     8067 10BF 81BD            STY DRAW_EREF_TEST1X100000_1
     89  6     806B BF   81BF            STX DRAW_EREF_TEST1X100000_1+2
     90  8     806E BD   80DA            JSR SCRC
     91                            
     92  8     8071 BD   816B            JSR DRAW_TEST1X100000
     93                            
     94  6     8074 BE   81B9            LDX POS_TEST1X100000 * save des po>>
     95  7     8077 10BE 81BD            LDY DRAW_EREF_TEST1X100000_1
     96  5+1   807B AF   A8 2D           STX 45,Y
     97  6     807E BE   81BB            LDX POS_TEST1X100000+2
     98  7     8081 10BE 81BD            LDY DRAW_EREF_TEST1X100000_1
     99  5+1   8085 AF   A8 2F           STX 47,Y
    100                            
    101  6     8088 BE   81BD            LDX DRAW_EREF_TEST1X100000_1
    102  7     808B 10BE 81BF            LDY DRAW_EREF_TEST1X100000_1+2
    103  7     808F 10BF 81BD            STY DRAW_EREF_TEST1X100000_1
    104  6     8093 BF   81BF            STX DRAW_EREF_TEST1X100000_1+2
    105  8     8096 BD   80DA            JSR SCRC
    106                            
    107        8099               MAIN
    108  7+3   8099 AD   9F 81BD         JSR [DRAW_EREF_TEST1X100000_1]
    109  8     809D BD   816B            JSR DRAW_TEST1X100000
    110                            
    111  6     80A0 BE   81B9            LDX POS_TEST1X100000 * save des po>>
    112  7     80A3 10BE 81BD            LDY DRAW_EREF_TEST1X100000_1
    113  5+1   80A7 AF   A8 2D           STX 45,Y
    114  6     80AA BE   81BB            LDX POS_TEST1X100000+2
    115  7     80AD 10BE 81BD            LDY DRAW_EREF_TEST1X100000_1
    116  5+1   80B1 AF   A8 2F           STX 47,Y
    117                            
    118  6     80B4 BE   81BD            LDX DRAW_EREF_TEST1X100000_1      >>
    119  7     80B7 10BE 81BF            LDY DRAW_EREF_TEST1X100000_1+2
    120  7     80BB 10BF 81BD            STY DRAW_EREF_TEST1X100000_1
    121  6     80BF BF   81BF            STX DRAW_EREF_TEST1X100000_1+2
    122
    123  6     80C2 BE   81B9            LDX POS_TEST1X100000 * avance de 2>>
    124  7     80C5 10BE 81BB            LDY POS_TEST1X100000+2
    125  6     80C9 BF   81BB            STX POS_TEST1X100000+2
    126  4+1   80CC 31   3F              LEAY -1,Y
    127  7     80CE 10BF 81B9            STY POS_TEST1X100000
    128
    129  8     80D2 BD   80F1            JSR VSYNC
    130  8     80D5 BD   80DA            JSR SCRC        * changement de pa>>
    131  3     80D8 20   BF              BRA MAIN
    132
    133                           *****************************************>>
    134                           * Changement de page ESPACE ECRAN (affich>>
    135                           *      $E7DD determine la page affichee d>>
    136                           *      D7=0 D6=0 D5=0 D4=0 (#$0_) : page >>
    137                           *      D7=0 D6=1 D5=0 D4=0 (#$4_) : page >>
    138                           *      D7=1 D6=0 D5=0 D4=0 (#$8_) : page >>
    139                           *      D7=1 D6=1 D5=0 D4=0 (#$C_) : page >>
    140                           *   D3 D2 D1 D0  (#$_0 a #$_F) : couleur >>
    141                           *   Remarque : D5 et D4 utilisable unique>>
    142                           *
    143                           * Changement de page ESPACE CARTOUCHE (ec>>
    144                           *      $E7E6 determine la page affichee d>>
    145                           *   D5 : 1 = espace cartouche recouvert p>>
    146                           *   D4 : 0 = CAS1N valide : banques 0-15 >>
    147                           *      D5=1 D4=0 D3=0 D2=0 D1=0 D0=0 (#$6>>
    148                           *   ...
    149                           *      D5=1 D4=0 D3=1 D2=1 D1=1 D0=1 (#$6>>
    150                           *      D5=1 D4=1 D3=0 D2=0 D1=0 D0=0 (#$7>>
    151                           *   ...
    152                           *      D5=1 D4=1 D3=1 D2=1 D1=1 D0=1 (#$7>>
    153                           *****************************************>>
    154        80DA               SCRC
    155  5     80DA F6   80E8            LDB SCRC0+1   * charge la valeur d>>
    156  2     80DD C4   80              ANDB #$80     * permute #$00 ou #$>>
    157  2     80DF CA   0F              ORB #$0F      * recharger la coule>>
    158  5     80E1 F7   E7DD            STB $E7DD     * changement page da>>
    159  7     80E4 73   80E8            COM SCRC0+1   * modification du co>>
    160        80E7               SCRC0
    161  2     80E7 C6   00              LDB #$00
    162  2     80E9 C4   02              ANDB #$02     * permute #$60 ou #$>>
    163  2     80EB CA   60              ORB #$60      * espace cartouche r>>
    164  5     80ED F7   E7E6            STB $E7E6     * changement page da>>
    165  5     80F0 39                   RTS                  * E7E6 D5=1 p>>
    166                                                       * CAS1N : ban>>
    167
    168                           *****************************************>>
    169                           * Attente VBL
    170                           *****************************************>>
    171        80F1               VSYNC
    172        80F1               VSYNC_1
    173  7     80F1 7D   E7E7            TST    $E7E7
    174  3     80F4 2A   FB              BPL    VSYNC_1
    175        80F6               VSYNC_2
    176  7     80F6 7D   E7E7            TST    $E7E7
    177  3     80F9 2B   FB              BMI    VSYNC_2
    178  5     80FB 39                   RTS
    179
    180                           *****************************************>>
    181                           * Affichage de l arriere plan xxx cycles
    182                           *****************************************>>
    183        80FC               DRAWBCKGRN
    184  5+3   80FC 34   48              PSHS U,DP            * sauvegarde >>
    185  7     80FE 10FF 8000            STS >SSAVE
    186                            
    187  4     8102 10CE 1F40            LDS #FINECRANA       * init pointe>>
    188  3     8106 CE   A000            LDU #$A000
    189
    190        8109               DRWBCKGRNDA
    191  5+7   8109 37   3E              PULU A,B,DP,X,Y
    192  5+7   810B 34   3E              PSHS Y,X,DP,B,A
    193  5+7   810D 37   3E              PULU A,B,DP,X,Y
    194  5+7   810F 34   3E              PSHS Y,X,DP,B,A
    195  5+7   8111 37   3E              PULU A,B,DP,X,Y
    196  5+7   8113 34   3E              PSHS Y,X,DP,B,A
    197  5+7   8115 37   3E              PULU A,B,DP,X,Y
    198  5+7   8117 34   3E              PSHS Y,X,DP,B,A
    199  5+7   8119 37   3E              PULU A,B,DP,X,Y
    200  5+7   811B 34   3E              PSHS Y,X,DP,B,A
    201  5+7   811D 37   3E              PULU A,B,DP,X,Y
    202  5+7   811F 34   3E              PSHS Y,X,DP,B,A
    203  5     8121 118C 0014            CMPS #DEBUTECRANA
    204  3     8125 26   E2              BNE DRWBCKGRNDA
    205  5+7   8127 37   3E              PULU A,B,DP,X,Y
    206  5+7   8129 34   3E              PSHS Y,X,DP,B,A
    207  5+7   812B 37   3E              PULU A,B,DP,X,Y
    208  5+7   812D 34   3E              PSHS Y,X,DP,B,A
    209  5+6   812F 37   3C              PULU B,DP,X,Y
    210  5+6   8131 34   3C              PSHS Y,X,DP,B
    211
    212  4     8133 10CE 3F40            LDS #FINECRANB       * init pointe>>
    213  3     8137 CE   C000            LDU #$C000
    214
    215        813A               DRWBCKGRNDB
    216  5+7   813A 37   3E              PULU A,B,DP,X,Y
    217  5+7   813C 34   3E              PSHS Y,X,DP,B,A
    218  5+7   813E 37   3E              PULU A,B,DP,X,Y
    219  5+7   8140 34   3E              PSHS Y,X,DP,B,A
    220  5+7   8142 37   3E              PULU A,B,DP,X,Y
    221  5+7   8144 34   3E              PSHS Y,X,DP,B,A
    222  5+7   8146 37   3E              PULU A,B,DP,X,Y
    223  5+7   8148 34   3E              PSHS Y,X,DP,B,A
    224  5+7   814A 37   3E              PULU A,B,DP,X,Y
    225  5+7   814C 34   3E              PSHS Y,X,DP,B,A
    226  5+7   814E 37   3E              PULU A,B,DP,X,Y
    227  5+7   8150 34   3E              PSHS Y,X,DP,B,A
    228  5     8152 118C 2014            CMPS #DEBUTECRANB
    229  3     8156 26   E2              BNE DRWBCKGRNDB
    230  5+7   8158 37   3E              PULU A,B,DP,X,Y
    231  5+7   815A 34   3E              PSHS Y,X,DP,B,A
    232  5+7   815C 37   3E              PULU A,B,DP,X,Y
    233  5+7   815E 34   3E              PSHS Y,X,DP,B,A
    234  5+6   8160 37   3C              PULU B,DP,X,Y
    235  5+6   8162 34   3C              PSHS Y,X,DP,B
    236
    237  7     8164 10FE 8000            LDS  >SSAVE          * rechargemen>>
    238  5+3   8168 35   48              PULS U,DP
    239  5     816A 39                   RTS
    240
    241                           *****************************************>>
    242                           * Affiche un computed sprite en xxx cycle>>
    243                           *****************************************>>
    244        816B               DRAW_TEST1X100000
    245  5+3   816B 34   48              PSHS U,DP
    246  7     816D 10FF 8000            STS >SSAVE
    247
    248  7     8171 10FE 81B9            LDS POS_TEST1X100000
    249  3     8175 CE   81B9            LDU #DATA_TEST1X100000_1
    250
    251  4+1   8178 A6   7F              LDA -1,S
    252  6     817A BE   81BD            LDX DRAW_EREF_TEST1X100000_1
    253  4+1   817D A7   0E              STA 14,X
    254  2     817F 86   98              LDA #$98
    255  4+1   8181 A7   7F              STA -1,S
    256  4+1   8183 A6   E8 D7           LDA -41,S
    257  6     8186 BE   81BD            LDX DRAW_EREF_TEST1X100000_1
    258  4+1   8189 A7   88 12           STA 18,X
    259  2     818C 86   89              LDA #$89
    260  4+1   818E A7   E8 D7           STA -41,S
    261
    262  7     8191 10FE 81BB            LDS POS_TEST1X100000+2
    263  3     8195 CE   81B9            LDU #DATA_TEST1X100000_2
    264
    265  4+1   8198 A6   7F              LDA -1,S
    266  6     819A BE   81BD            LDX DRAW_EREF_TEST1X100000_1
    267  4+1   819D A7   88 1E           STA 30,X
    268  2     81A0 86   89              LDA #$89
    269  4+1   81A2 A7   7F              STA -1,S
    270  4+1   81A4 A6   E8 D7           LDA -41,S
    271  6     81A7 BE   81BD            LDX DRAW_EREF_TEST1X100000_1
    272  4+1   81AA A7   88 22           STA 34,X
    273  2     81AD 86   98              LDA #$98
    274  4+1   81AF A7   E8 D7           STA -41,S
    275
    276  7     81B2 10FE 8000            LDS  >SSAVE
    277  5+3   81B6 35   48              PULS U,DP
    278  5     81B8 39                   RTS
    279
    280        81B9               DATA_TEST1X100000_1
    281        81B9               DATA_TEST1X100000_2
    282        81B9               POS_TEST1X100000
    283        81B9 1F40                 FDB $1F40
    284        81BB 3F40                 FDB $3F40
    285        81BD               DRAW_EREF_TEST1X100000_1
    286        81BD 81C1                 FDB E1DRAW_TEST1X100000
    287        81BF 81F2                 FDB E2DRAW_TEST1X100000
    288
    289        81C1               E1DRAW_TEST1X100000
    290  5+3   81C1 34   48              PSHS U,DP
    291  7     81C3 10FF 8000            STS >SSAVE
    292
    293  7     81C7 10FE 81EE            LDS E1POS_TEST1X100000
    294  3     81CB CE   81EE            LDU #E1DATA_TEST1X100000_1
    295
    296  2     81CE 86   98              LDA #$98
    297  4+1   81D0 A7   7F              STA -1,S
    298  2     81D2 86   89              LDA #$89
    299  4+1   81D4 A7   E8 D7           STA -41,S
    300
    301  7     81D7 10FE 81F0            LDS E1POS_TEST1X100000+2
    302  3     81DB CE   81EE            LDU #E1DATA_TEST1X100000_2
    303
    304  2     81DE 86   89              LDA #$89
    305  4+1   81E0 A7   7F              STA -1,S
    306  2     81E2 86   98              LDA #$98
    307  4+1   81E4 A7   E8 D7           STA -41,S
    308
    309  7     81E7 10FE 8000            LDS  >SSAVE
    310  5+3   81EB 35   48              PULS U,DP
    311  5     81ED 39                   RTS
    312
    313        81EE               E1DATA_TEST1X100000_1
    314        81EE               E1DATA_TEST1X100000_2
    315        81EE               E1POS_TEST1X100000
    316        81EE 1F40                 FDB $1F40
    317        81F0 3F40                 FDB $3F40
    318
    319        81F2               E2DRAW_TEST1X100000
    320  5+3   81F2 34   48              PSHS U,DP
    321  7     81F4 10FF 8000            STS >SSAVE
    322
    323  7     81F8 10FE 821F            LDS E2POS_TEST1X100000
    324  3     81FC CE   821F            LDU #E2DATA_TEST1X100000_1
    325
    326  2     81FF 86   98              LDA #$98
    327  4+1   8201 A7   7F              STA -1,S
    328  2     8203 86   89              LDA #$89
    329  4+1   8205 A7   E8 D7           STA -41,S
    330
    331  7     8208 10FE 8221            LDS E2POS_TEST1X100000+2
    332  3     820C CE   821F            LDU #E2DATA_TEST1X100000_2
    333
    334  2     820F 86   89              LDA #$89
    335  4+1   8211 A7   7F              STA -1,S
    336  2     8213 86   98              LDA #$98
    337  4+1   8215 A7   E8 D7           STA -41,S
    338
    339  7     8218 10FE 8000            LDS  >SSAVE
    340  5+3   821C 35   48              PULS U,DP
    341  5     821E 39                   RTS
    342
    343        821F               E2DATA_TEST1X100000_1
    344        821F               E2DATA_TEST1X100000_2
    345        821F               E2POS_TEST1X100000
    346        821F 1F40                 FDB $1F40
    347        8221 3F40                 FDB $3F40
    348
    349        8223               TABPALETTE
    350        8223 0111                 FDB $0111     * index:0  R:51  V:5>>
    351        8225 0143                 FDB $0143     * index:1  R:108 V:1>>
    352        8227 0113                 FDB $0113     * index:2  R:107 V:5>>
    353        8229 0484                 FDB $0484     * index:3  R:132 V:1>>
    354        822B 0112                 FDB $0112     * index:4  R:92  V:6>>
    355        822D 0247                 FDB $0247     * index:5  R:180 V:1>>
    356        822F 0233                 FDB $0233     * index:6  R:116 V:1>>
    357        8231 0177                 FDB $0177     * index:7  R:172 V:1>>
    358        8233 0111                 FDB $0111     * index:8  R:60  V:5>>
    359        8235 0016                 FDB $0016     * index:9  R:164 V:6>>
    360        8237 0698                 FDB $0698     * index:10 R:187 V:1>>
    361        8239 0344                 FDB $0344     * index:11 R:132 V:1>>
    362        823B 0221                 FDB $0221     * index:12 R:68  V:9>>
    363        823D 0452                 FDB $0452     * index:13 R:92  V:1>>
    364        823F 0356                 FDB $0356     * index:14 R:164 V:1>>
    365        8241 0125                 FDB $0125     * index:15 R:140 V:1>>
    366        8243               FINTABPALETTE

000000 Total Errors

000031 Total Symbols
     1x          Label 81B9 DATA_TEST1X100000_1
     1x          Label 81B9 DATA_TEST1X100000_2
     1x          Equ   0014 DEBUTECRANA
     1x          Equ   2014 DEBUTECRANB
     2x          Label 80FC DRAWBCKGRN
    23x          Label 81BD DRAW_EREF_TEST1X100000_1
     3x          Label 816B DRAW_TEST1X100000
     1x          Label 8109 DRWBCKGRNDA
     1x          Label 813A DRWBCKGRNDB
     1x          Label 81EE E1DATA_TEST1X100000_1
     1x          Label 81EE E1DATA_TEST1X100000_2
     1x          Label 81C1 E1DRAW_TEST1X100000
     2x          Label 81EE E1POS_TEST1X100000
     1x          Label 821F E2DATA_TEST1X100000_1
     1x          Label 821F E2DATA_TEST1X100000_2
     1x          Label 81F2 E2DRAW_TEST1X100000
     2x          Label 821F E2POS_TEST1X100000
     1x          Equ   1F40 FINECRANA
     1x          Equ   3F40 FINECRANB
     1x          Label 8243 FINTABPALETTE
     0x          Label 8025 INITBORD
     1x          Label 8099 MAIN
    12x          Label 81B9 POS_TEST1X100000
     6x          Label 80DA SCRC
     2x          Label 80E7 SCRC0
     1x          Label 800E SETPALETTE
     8x          Label 8000 SSAVE
     1x          Label 8223 TABPALETTE
     1x          Label 80F1 VSYNC
     1x          Label 80F1 VSYNC_1
     1x          Label 80F6 VSYNC_2

