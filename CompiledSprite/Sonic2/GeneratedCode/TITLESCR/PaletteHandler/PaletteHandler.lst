/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : .\Sonic2\GeneratedCode\TITLESCR\PaletteHandler\PaletteHandler.asm
 * Fichier destination : .\Sonic2\GeneratedCode\TMP.BIN
 * Contenu :
 *     Main     0:MAIN.ASM     1913
 *     Include  0:GLOBALS.ASM  4639
 *     Include  0:CONSTANT.ASM 5657
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
    169                                   INCLUD GLOBALS
    170                           * Generated Code
    171
    172                  414F     GameModeLoader equ $414F
    173                  41C7     current_game_mode_data equ $41C7
    174                  0001     ObjID_SEGA equ 1
    175                  0002     ObjID_PaletteHandler equ 2
    176                  0003     ObjID_TitleScreen equ 3
    177                  6730     Object_RAM equ $6730
    178                  7289     screen_border_color equ $7289
    179                  72A6     Vint_runcount equ $72A6
    180                  0001     c1_button_up_mask equ $0001
    181                  0002     c1_button_down_mask equ $0002
    182                  0004     c1_button_left_mask equ $0004
    183                  0008     c1_button_right_mask equ $0008
    184                  0010     c2_button_up_mask equ $0010
    185                  0020     c2_button_down_mask equ $0020
    186                  0040     c2_button_left_mask equ $0040
    187                  0080     c2_button_right_mask equ $0080
    188                  0040     c1_button_A_mask equ $0040
    189                  0080     c2_button_A_mask equ $0080
    190                  72AA     Joypads_Held equ $72AA
    191                  72AA     Dpad_Held equ $72AA
    192                  72AB     Fire_Held equ $72AB
    193                  72AC     Joypads_Press equ $72AC
    194                  72AC     Dpad_Press equ $72AC
    195                  72AD     Fire_Press equ $72AD
    196                  7317     MarkObjGone equ $7317
    197                  7319     DisplaySprite_x equ $7319
    198                  731F     DisplaySprite equ $731F
    199                  7398     AnimateSprite equ $7398
    200                  745D     DeleteObject_x equ $745D
    201                  7463     DeleteObject equ $7463
    202                  7525     ClearObj equ $7525
    203                  7D60     PlayPCM equ $7D60
    204                  7DB2     PSGInit equ $7DB2
    205                  7DC4     PSGPlayNoRepeat equ $7DC4
    206                  7DF2     PSGStop equ $7DF2
    207                  7E1B     PSGResume equ $7E1B
    208                  7E66     PSGCancelLoop equ $7E66
    209                  7E6A     PSGGetStatus equ $7E6A
    210                  7E6E     PSGSetMusicVolumeAttenuation equ $7E6E
    211                  7ECD     PSGSilenceChannels equ $7ECD
    212                  7EE2     PSGRestoreVolumes equ $7EE2
    213                  7F56     PSGSFXPlayLoop equ $7F56
    214                  7FA2     PSGSFXStop equ $7FA2
    215                  8018     PSGSFXCancelLoop equ $8018
    216                  801C     PSGSFXGetStatus equ $801C
    217                  8021     PSGFrame equ $8021
    218                  80DA     _sendVolume2PSG equ $80DA
    219                  812D     PSGSFXFrame equ $812D
    220                  818A     _SFXsetLoopPoint equ $818A
    221                  81D6     Img_star_4 equ $81D6
    222                  81E9     Img_star_3 equ $81E9
    223                  81FC     Img_sonicHand equ $81FC
    224                  8212     Img_star_2 equ $8212
    225                  822C     Img_star_1 equ $822C
    226                  8246     Img_emblemBack08 equ $8246
    227                  8255     Img_emblemBack07 equ $8255
    228                  8264     Img_emblemBack09 equ $8264
    229                  8273     Img_emblemBack04 equ $8273
    230                  8282     Img_emblemBack03 equ $8282
    231                  8291     Img_emblemBack06 equ $8291
    232                  82A0     Img_emblemBack05 equ $82A0
    233                  82AF     Img_tails_5 equ $82AF
    234                  82C5     Img_tails_4 equ $82C5
    235                  82D8     Img_tails_3 equ $82D8
    236                  82EB     Img_tails_2 equ $82EB
    237                  82FE     Img_tails_1 equ $82FE
    238                  8311     Img_tailsHand equ $8311
    239                  8327     Img_sonic_1 equ $8327
    240                  833A     Img_sonic_2 equ $833A
    241                  834D     Img_emblemBack02 equ $834D
    242                  835C     Img_emblemBack01 equ $835C
    243                  836B     Img_sonic_5 equ $836B
    244                  8381     Img_sonic_3 equ $8381
    245                  8394     Img_sonic_4 equ $8394
    246                  83A7     Img_emblemFront07 equ $83A7
    247                  83B6     Img_emblemFront08 equ $83B6
    248                  83C5     Img_emblemFront05 equ $83C5
    249                  83D4     Img_emblemFront06 equ $83D4
    250                  83E3     Img_emblemFront03 equ $83E3
    251                  83F2     Img_emblemFront04 equ $83F2
    252                  8401     Img_emblemFront01 equ $8401
    253                  8410     Img_emblemFront02 equ $8410
    254                  8420     Ani_smallStar equ $8420
    255                  8426     Ani_largeStar equ $8426
    256                  8432     Ani_tails equ $8432
    257                  843E     Ani_sonic equ $843E
    258                  6730     Object_RAM equ $6730
    259                  7289     screen_border_color equ $7289
    260                  72A6     Vint_runcount equ $72A6
    261                  0001     c1_button_up_mask equ $0001
    262                  0002     c1_button_down_mask equ $0002
    263                  0004     c1_button_left_mask equ $0004
    264                  0008     c1_button_right_mask equ $0008
    265                  0010     c2_button_up_mask equ $0010
    266                  0020     c2_button_down_mask equ $0020
    267                  0040     c2_button_left_mask equ $0040
    268                  0080     c2_button_right_mask equ $0080
    269                  0040     c1_button_A_mask equ $0040
    270                  0080     c2_button_A_mask equ $0080
    271                  72AA     Joypads_Held equ $72AA
    272                  72AA     Dpad_Held equ $72AA
    273                  72AB     Fire_Held equ $72AB
    274                  72AC     Joypads_Press equ $72AC
    275                  72AC     Dpad_Press equ $72AC
    276                  72AD     Fire_Press equ $72AD
    277                  7317     MarkObjGone equ $7317
    278                  7319     DisplaySprite_x equ $7319
    279                  731F     DisplaySprite equ $731F
    280                  7398     AnimateSprite equ $7398
    281                  745D     DeleteObject_x equ $745D
    282                  7463     DeleteObject equ $7463
    283                  7525     ClearObj equ $7525
    284                  7D60     PlayPCM equ $7D60
    285                  7DB2     PSGInit equ $7DB2
    286                  7DC4     PSGPlayNoRepeat equ $7DC4
    287                  7DF2     PSGStop equ $7DF2
    288                  7E1B     PSGResume equ $7E1B
    289                  7E66     PSGCancelLoop equ $7E66
    290                  7E6A     PSGGetStatus equ $7E6A
    291                  7E6E     PSGSetMusicVolumeAttenuation equ $7E6E
    292                  7ECD     PSGSilenceChannels equ $7ECD
    293                  7EE2     PSGRestoreVolumes equ $7EE2
    294                  7F56     PSGSFXPlayLoop equ $7F56
    295                  7FA2     PSGSFXStop equ $7FA2
    296                  8018     PSGSFXCancelLoop equ $8018
    297                  801C     PSGSFXGetStatus equ $801C
    298                  8021     PSGFrame equ $8021
    299                  80DA     _sendVolume2PSG equ $80DA
    300                  812D     PSGSFXFrame equ $812D
    301                  818A     _SFXsetLoopPoint equ $818A
    302                  81D6     Img_star_4 equ $81D6
    303                  81E9     Img_star_3 equ $81E9
    304                  81FC     Img_sonicHand equ $81FC
    305                  8212     Img_star_2 equ $8212
    306                  822C     Img_star_1 equ $822C
    307                  8246     Img_emblemBack08 equ $8246
    308                  8255     Img_emblemBack07 equ $8255
    309                  8264     Img_emblemBack09 equ $8264
    310                  8273     Img_emblemBack04 equ $8273
    311                  8282     Img_emblemBack03 equ $8282
    312                  8291     Img_emblemBack06 equ $8291
    313                  82A0     Img_emblemBack05 equ $82A0
    314                  82AF     Img_tails_5 equ $82AF
    315                  82C5     Img_tails_4 equ $82C5
    316                  82D8     Img_tails_3 equ $82D8
    317                  82EB     Img_tails_2 equ $82EB
    318                  82FE     Img_tails_1 equ $82FE
    319                  8311     Img_tailsHand equ $8311
    320                  8327     Img_sonic_1 equ $8327
    321                  833A     Img_sonic_2 equ $833A
    322                  834D     Img_emblemBack02 equ $834D
    323                  835C     Img_emblemBack01 equ $835C
    324                  836B     Img_sonic_5 equ $836B
    325                  8381     Img_sonic_3 equ $8381
    326                  8394     Img_sonic_4 equ $8394
    327                  83A7     Img_emblemFront07 equ $83A7
    328                  83B6     Img_emblemFront08 equ $83B6
    329                  83C5     Img_emblemFront05 equ $83C5
    330                  83D4     Img_emblemFront06 equ $83D4
    331                  83E3     Img_emblemFront03 equ $83E3
    332                  83F2     Img_emblemFront04 equ $83F2
    333                  8401     Img_emblemFront01 equ $8401
    334                  8410     Img_emblemFront02 equ $8410
    335                  8420     Ani_smallStar equ $8420
    336                  8426     Ani_largeStar equ $8426
    337                  8432     Ani_tails equ $8432
    338                  843E     Ani_sonic equ $843E
    339                  8747     Pcm_SEGA equ $8747
    340                  8752     Psg_TitleScreen equ $8752
    341                  87C9     Pal_TitleScreen equ $87C9
    342                  87EA     Ptr_palette equ $87EA
    343                  87EC     Black_palette equ $87EC
    344                  880C     White_palette equ $880C
    345
    346                                   INCLUD CONSTANT
    347                           * --------------------------------------->>
    348                           * Constants
    349                           *
    350                           * Naming convention
    351                           * -----------------
    352                           * - lower case
    353                           * - underscore-separated names
    354                           *
    355                           * --------------------------------------->>
    356
    357                           * =======================================>>
    358                           * TO8 Registers
    359                           * =======================================>>
    360
    361                  6049     dk_lecteur                    equ $6049
    362                  604A     dk_piste                      equ $604A
    363                  604B     dk_pisteL                     equ $604B
    364                  604C     dk_secteur                    equ $604C
    365                  604F     dk_destination                equ $604F
    366
    367                           * =======================================>>
    368                           * Display Constants
    369                           * =======================================>>
    370
    371                  00A0     screen_width                  equ 160 ; s>>
    372                  001C     screen_top                    equ 28 ; in>>
    373                  00E4     screen_bottom                 equ 200+28 >>
    374                  0008     nb_priority_levels            equ 8   ; n>>
    375
    376                           * =======================================>>
    377                           * Physics Constants
    378                           * =======================================>>
    379
    380                  0038     gravity                       equ $38 ; G>>
    381
    382                           * =======================================>>
    383                           * Animation Constants
    384                           * =======================================>>
    385
    386                  00FF     _resetAnim                    equ $FF
    387                  00FE     _goBackNFrames                equ $FE
    388                  00FD     _goToAnimation                equ $FD
    389                  00FC     _nextRoutine                  equ $FC
    390                  00FB     _resetAnimAndSubRoutine       equ $FB
    391                  00FA     _nextSubRoutine               equ $FA
    392
    393                           * =======================================>>
    394                           * Images Constants
    395                           * =======================================>>
    396
    397                  0004     image_x_size                  equ 4
    398                  0005     image_y_size                  equ 5
    399
    400                  0004     image_subset_x1_offset        equ 4
    401                  0005     image_subset_y1_offset        equ 5
    402
    403                  0000     page_draw_routine             equ 0
    404                  0001     draw_routine                  equ 1
    405                  0003     page_erase_routine            equ 3
    406                  0004     erase_routine                 equ 4
    407                  0006     erase_nb_cell                 equ 6
    408
    409                           * =======================================>>
    410                           * Sound Constants
    411                           * =======================================>>
    412
    413                  0000     pcm_page        equ 0
    414                  0001     pcm_start_addr  equ 1
    415                  0003     pcm_end_addr    equ 3
    416                  0005     pcm_meta_size   equ 5
    417
    418                           * =======================================>>
    419                           * Object Constants
    420                           * =======================================>>
    421
    422                  0002     nb_reserved_objects           equ 2
    423                  001B     nb_dynamic_objects            equ 27
    424                  0003     nb_level_objects              equ 3
    425                  0040     nb_objects                    equ 64 * ma>>
    426
    427                           * --------------------------------------->>
    428                           * Object Status Table offsets
    429                           * --------------------------------------->>
    430
    431                  005A     object_size                   equ 90 ; th>>
    432                  005A     next_object                   equ object_>>
    433
    434                  0000     id                            equ 0      >>
    435                  0001     subtype                       equ 1      >>
    436                  0002     render_flags                  equ 2
    437
    438                           * --- render_flags bitfield variables --->>
    439                  0001     render_xmirror_mask           equ $01 ; (>>
    440                  0002     render_ymirror_mask           equ $02 ; (>>
    441                  0004     render_overlay_mask           equ $04 ; (>>
    442                  0008     render_motionless_mask        equ $08 ; (>>
    443                  0010     render_playfieldcoord_mask    equ $10 ; (>>
    444                  0020     render_hide_mask              equ $20 ; (>>
    445                  0040     render_todelete_mask          equ $40 ; (>>
    446                  0080     render_free3_mask             equ $80 ; (>>
    447                            
    448                  0003     priority                      equ 3      >>
    449                  0004     anim                          equ 4  ; an>>
    450                  0006     prev_anim                     equ 6  ; an>>
    451                  0008     anim_frame                    equ 8      >>
    452                  0009     anim_frame_duration           equ 9      >>
    453                  000A     image_set                     equ 10 ; an>>
    454                  000C     x_pos                         equ 12 ; an>>
    455                  000E     x_sub                         equ 14     >>
    456                  000F     y_pos                         equ 15 ; an>>
    457                  0011     y_sub                         equ 17     >>
    458                  0012     xy_pixel                      equ 18     >>
    459                  0012     x_pixel                       equ 18     >>
    460                  0013     y_pixel                       equ 19     >>
    461                  0014     x_vel                         equ 20 ; an>>
    462                  0016     y_vel                         equ 22 ; an>>
    463                  0018     routine                       equ 24     >>
    464                  0019     routine_secondary             equ 25     >>
    465                  001A     status                        equ 26
    466
    467                           * --- status bitfield variables for objec>>
    468                  0001     status_x_orientation          equ   $01 ;>>
    469                  0002     status_y_orientation          equ   $02 ;>>
    470                  0004     status_bit2                   equ   $04 ;>>
    471                  0008     status_mainchar_standing      equ   $08 ;>>
    472                  0010     status_sidekick_standing      equ   $10 ;>>
    473                  0020     status_mainchar_pushing       equ   $20 ;>>
    474                  0040     status_sidekick_pushing       equ   $40 ;>>
    475                  0080     status_bit7                   equ   $80 ;>>
    476
    477                           * --- status bitfield variables for Main >>
    478                  0002     status_inair                  equ   $02 ;>>
    479                  0004     status_jumporroll             equ   $04 ;>>
    480                  0008     status_norgroundnorfall       equ   $08 ;>>
    481                  0010     status_jumpingafterrolling    equ   $10 ;>>
    482                  0020     status_pushing                equ   $20 ;>>
    483                  0040     status_underwater             equ   $40 ;>>
    484
    485                  001B     ext_variables                 equ 27 ; to>>
    486
    487                           * --------------------------------------->>
    488                           * reserved variables (engine)
    489
    490                  0029     rsv_render_flags              equ 41
    491
    492                           * --- rsv_render_flags bitfield variables>>
    493                  0001     rsv_render_checkrefresh_mask  equ $01 ; (>>
    494                  0002     rsv_render_erasesprite_mask   equ $02 ; (>>
    495                  0004     rsv_render_displaysprite_mask equ $04 ; (>>
    496                  0008     rsv_render_outofrange_mask    equ $08 ; (>>
    497
    498                  002A     rsv_prev_anim                 equ 42 ; an>>
    499                           *rsv_image_set                equ 44 ; an>>
    500                  002E     rsv_image_subset              equ 46 ; an>>
    501                  0030     rsv_mapping_frame             equ 48 ; an>>
    502                  0032     rsv_xy1_pixel                 equ 50     >>
    503                  0032     rsv_x1_pixel                  equ 50     >>
    504                  0033     rsv_y1_pixel                  equ 51     >>
    505                  0034     rsv_xy2_pixel                 equ 52     >>
    506                  0034     rsv_x2_pixel                  equ 52     >>
    507                  0035     rsv_y2_pixel                  equ 53     >>
    508
    509                           * --------------------------------------->>
    510                           * reserved variables (engine) - buffer sp>>
    511
    512                  0036     rsv_buffer_0                  equ 54 ; St>>
    513                  0036     rsv_priority_0                equ 54 ; in>>
    514                  0037     rsv_priority_prev_obj_0       equ 55 ; an>>
    515                  0039     rsv_priority_next_obj_0       equ 57 ; an>>
    516                           *rsv_prev_image_subset_0       equ 59 ; a>>
    517                  003D     rsv_prev_mapping_frame_0      equ 61 ; an>>
    518                  003F     rsv_bgdata_0                  equ 63 ; an>>
    519                  0041     rsv_prev_xy_pixel_0           equ 65 ;
    520                  0041     rsv_prev_x_pixel_0            equ 65 ; pr>>
    521                  0042     rsv_prev_y_pixel_0            equ 66 ; pr>>
    522                  0043     rsv_prev_xy1_pixel_0          equ 67 ;
    523                  0043     rsv_prev_x1_pixel_0           equ 67 ; pr>>
    524                  0044     rsv_prev_y1_pixel_0           equ 68 ; pr>>
    525                  0045     rsv_prev_xy2_pixel_0          equ 69 ;
    526                  0045     rsv_prev_x2_pixel_0           equ 69 ; pr>>
    527                  0046     rsv_prev_y2_pixel_0           equ 70 ; pr>>
    528                  0047     rsv_prev_render_flags_0       equ 71 ;
    529                           * --- rsv_prev_render_flags_0 bitfield va>>
    530                  0001     rsv_prev_render_overlay_mask  equ $01 ; (>>
    531                  0080     rsv_prev_render_onscreen_mask equ $80 ; (>>
    532
    533                  0048     rsv_buffer_1                  equ 72 ; St>>
    534                  0048     rsv_priority_1                equ 72 ; in>>
    535                  0049     rsv_priority_prev_obj_1       equ 73 ; an>>
    536                  004B     rsv_priority_next_obj_1       equ 75 ; an>>
    537                           *rsv_prev_image_subset_1       equ 77 ; a>>
    538                  004F     rsv_prev_mapping_frame_1      equ 79 ; an>>
    539                  0051     rsv_bgdata_1                  equ 81 ; an>>
    540                  0053     rsv_prev_xy_pixel_1           equ 83 ;
    541                  0053     rsv_prev_x_pixel_1            equ 83 ; pr>>
    542                  0054     rsv_prev_y_pixel_1            equ 84 ; pr>>
    543                  0055     rsv_prev_xy1_pixel_1          equ 85 ;
    544                  0055     rsv_prev_x1_pixel_1           equ 85 ; pr>>
    545                  0056     rsv_prev_y1_pixel_1           equ 86 ; pr>>
    546                  0057     rsv_prev_xy2_pixel_1          equ 87 ;
    547                  0057     rsv_prev_x2_pixel_1           equ 87 ; pr>>
    548                  0058     rsv_prev_y2_pixel_1           equ 88 ; pr>>
    549                  0059     rsv_prev_render_flags_1       equ 89 ;
    550
    551                  0000     buf_priority                  equ 0  ; of>>
    552                  0001     buf_priority_prev_obj         equ 1  ;
    553                  0003     buf_priority_next_obj         equ 3  ;
    554                           *buf_prev_image_subset         equ 5  ;
    555                  0007     buf_prev_mapping_frame        equ 7  ;
    556                  0009     buf_bgdata                    equ 9  ;
    557                  000B     buf_prev_xy_pixel             equ 11 ;
    558                  000B     buf_prev_x_pixel              equ 11 ;
    559                  000C     buf_prev_y_pixel              equ 12 ;
    560                  000D     buf_prev_xy1_pixel            equ 13 ;
    561                  000D     buf_prev_x1_pixel             equ 13 ;
    562                  000E     buf_prev_y1_pixel             equ 14 ;
    563                  000F     buf_prev_xy2_pixel            equ 15 ;
    564                  000F     buf_prev_x2_pixel             equ 15 ;
    565                  0010     buf_prev_y2_pixel             equ 16 ;
    566                  0011     buf_prev_render_flags         equ 17 ;
     63        A000                       org   $A000
     64
     65                           * --------------------------------------->>
     66                           * Object Status Table offsets
     67                           * --------------------------------------->>
     68                  001B     pal_src      equ ext_variables         * >>
     69                  001D     pal_dst      equ ext_variables+2       * >>
     70
     71        A000               PaletteHandler
     72
     73  4+1   A000 A6   C8 18            lda   routine,u
     74  4+1   A003 A7   8C 01            sta   *+4,pcr
     75  3     A006 20   00               bra   PaletteHandler_Routines
     76                            
     77        A008               PaletteHandler_Routines
     78  5     A008 16   0003             lbra  PaletteHandler_Init
     79  5     A00B 16   008F             lbra  PaletteHandler_Main
     80                            
     81        A00E               PaletteHandler_Init
     82  6+5   A00E 10EF 8D 0087          sts   PHI_Rts+1,pcr            * >>
     83  4+1   A013 A6   C8 18            lda   routine,u
     84  2     A016 8B   03               adda  #$03
     85  4+1   A018 A7   C8 18            sta   routine,u
     86  2     A01B 86   10               lda   #$10
     87  4+5   A01D A7   8D 00BC          sta   pal_cycles,pcr
     88  5+1   A021 AE   C8 1D            ldx   pal_dst,u
     89  6+1   A024 10AE C8 1B            ldy   pal_src,u
     90  4+5   A028 32   8D 0090          leas  pal_cur,pcr
     91  6+5   A02C 6F   8D 00B0          clr   pal_idx,pcr
     92        A030               PHI_Loop
     93  4+0   A030 A6   A4               lda   ,y                        *>>
     94  4+5   A032 A4   8D 00A6          anda  pal_mask,pcr             * >>
     95  4+0   A036 E6   84               ldb   ,x                       * >>
     96  4+5   A038 E4   8D 00A0          andb  pal_mask,pcr             * >>
     97  4+5   A03C E7   8D 009E          stb   pal_buffer,pcr           * >>
     98  2     A040 C6   11               ldb   #$11                     * >>
     99  4+5   A042 E4   8D 0096          andb  pal_mask,pcr             * >>
    100  4+5   A046 E7   8D 0095          stb   pal_buffer+1,pcr         * >>
    101  4+5   A04A A1   8D 0090          cmpa  pal_buffer,pcr           * >>
    102  3     A04E 27   12               beq   PHI_VRSuivante           * >>
    103  3     A050 22   08               bhi   PHI_VRDec                * >>
    104  4+0   A052 A6   A4               lda   ,y                       * >>
    105  4+5   A054 AB   8D 0087          adda  pal_buffer+1,pcr         * >>
    106  3     A058 20   06               bra   PHI_VRSave               * >>
    107        A05A               PHI_VRDec
    108  4+0   A05A A6   A4               lda   ,y                       * >>
    109  4+5   A05C A0   8D 007F          suba  pal_buffer+1,pcr         * >>
    110        A060               PHI_VRSave
    111  4+0   A060 A7   E4               sta   ,s                       * >>
    112        A062               PHI_VRSuivante
    113  6+5   A062 63   8D 0076          com   pal_mask,pcr             * >>
    114  3     A066 2B   C8               bmi   PHI_Loop                 * >>
    115                            
    116        A068               PHI_SetPalBleu
    117  4+1   A068 E6   21               ldb   1,y                      * >>
    118  4+1   A06A E1   01               cmpb  1,x                      * >>
    119  3     A06C 27   08               beq   PHI_SetPalNext           * >>
    120  3     A06E 22   03               bhi   PHI_SetPalBleudec        * >>
    121  2     A070 5C                    incb                           * >>
    122  3     A071 20   01               bra   PHI_SetPalSaveBleu       * >>
    123        A073               PHI_SetPalBleudec
    124  2     A073 5A                    decb                           * >>
    125        A074               PHI_SetPalSaveBleu
    126  4+1   A074 E7   61               stb   1,s                      * >>
    127                            
    128        A076               PHI_SetPalNext
    129  4+5   A076 A6   8D 0066          lda   pal_idx,pcr              * >>
    130  2     A07A 48                    asla
    131  5     A07B B7   E7DB             sta   $E7DB                    * >>
    132  4+0   A07E A6   E4               lda   ,s                       * >>
    133  5     A080 B7   E7DA             sta   $E7DA                    * >>
    134  5     A083 F7   E7DA             stb   $E7DA                    * >>
    135  4+1   A086 31   22               leay  2,y                      * >>
    136  4+1   A088 30   02               leax  2,x                      * >>
    137  4+1   A08A 32   62               leas  2,s                      * >>
    138  6+5   A08C 6C   8D 0050          inc   pal_idx,pcr
    139  4+5   A090 A6   8D 004C          lda   pal_idx,pcr
    140  2     A094 81   10               cmpa  #$10
    141  3     A096 26   98               bne   PHI_Loop                 * >>
    142
    143        A098               PHI_Rts
    144  4     A098 10CE 0000             lds   #$0000
    145  5     A09C 39                    rts
    146                            
    147        A09D               PaletteHandler_Main
    148  6+1   A09D 10EF 8C F9            sts   PHI_Rts+1,pcr            * >>
    149  5+1   A0A1 AE   C8 1D            ldx   pal_dst,u
    150  4+5   A0A4 31   8D 0014          leay  pal_cur,pcr
    151  4+5   A0A8 32   8D 0010          leas  pal_cur,pcr
    152  6+5   A0AC 6F   8D 0030          clr   pal_idx,pcr
    153  6+5   A0B0 6A   8D 0029          dec   pal_cycles,pcr           * >>
    154  6     A0B4 1026 FF78             lbne  PHI_Loop                 * >>
    155  6+0   A0B8 6F   C4               clr   ,u                       * >>
    156  3     A0BA 20   DC               bra   PHI_Rts
    157
    158                           * --------------------------------------->>
    159                           * Local data
    160                           * --------------------------------------->>
    161                            
    162        A0BC               pal_cur      rmb 32,0
    163        A0DC 0F            pal_mask     fcb $0F                   * >>
    164        A0DD 00            pal_cycles   fcb $00
    165        A0DE 0000          pal_buffer   fdb $00                   * >>
    166        A0E0 00            pal_idx      fcb $00                   * >>
    167
    168

000000 Total Errors

000254 Total Symbols
     0x          Equ   0004 anim
     0x          Equ   7398 AnimateSprite
     0x          Equ   0008 anim_frame
     0x          Equ   0009 anim_frame_duration
     0x          Equ   8426 Ani_largeStar
     0x          Equ   8420 Ani_smallStar
     0x          Equ   843E Ani_sonic
     0x          Equ   8432 Ani_tails
     0x          Equ   87EC Black_palette
     0x          Equ   0009 buf_bgdata
     0x          Equ   0007 buf_prev_mapping_frame
     0x          Equ   0011 buf_prev_render_flags
     0x          Equ   000D buf_prev_x1_pixel
     0x          Equ   000F buf_prev_x2_pixel
     0x          Equ   000D buf_prev_xy1_pixel
     0x          Equ   000F buf_prev_xy2_pixel
     0x          Equ   000B buf_prev_xy_pixel
     0x          Equ   000B buf_prev_x_pixel
     0x          Equ   000E buf_prev_y1_pixel
     0x          Equ   0010 buf_prev_y2_pixel
     0x          Equ   000C buf_prev_y_pixel
     0x          Equ   0000 buf_priority
     0x          Equ   0003 buf_priority_next_obj
     0x          Equ   0001 buf_priority_prev_obj
     0x          Equ   0040 c1_button_A_mask
     0x          Equ   0002 c1_button_down_mask
     0x          Equ   0004 c1_button_left_mask
     0x          Equ   0008 c1_button_right_mask
     0x          Equ   0001 c1_button_up_mask
     0x          Equ   0080 c2_button_A_mask
     0x          Equ   0020 c2_button_down_mask
     0x          Equ   0040 c2_button_left_mask
     0x          Equ   0080 c2_button_right_mask
     0x          Equ   0010 c2_button_up_mask
     0x          Equ   7525 ClearObj
     0x          Equ   41C7 current_game_mode_data
     0x          Equ   7463 DeleteObject
     0x          Equ   745D DeleteObject_x
     0x          Equ   731F DisplaySprite
     0x          Equ   7319 DisplaySprite_x
     0x          Equ   604F dk_destination
     0x          Equ   6049 dk_lecteur
     0x          Equ   604A dk_piste
     0x          Equ   604B dk_pisteL
     0x          Equ   604C dk_secteur
     0x          Equ   72AA Dpad_Held
     0x          Equ   72AC Dpad_Press
     0x          Equ   0001 draw_routine
     0x          Equ   0006 erase_nb_cell
     0x          Equ   0004 erase_routine
     2x          Equ   001B ext_variables
     0x          Equ   72AB Fire_Held
     0x          Equ   72AD Fire_Press
     0x          Equ   414F GameModeLoader
     0x          Equ   0038 gravity
     0x          Equ   0000 id
     0x          Equ   000A image_set
     0x          Equ   0004 image_subset_x1_offset
     0x          Equ   0005 image_subset_y1_offset
     0x          Equ   0004 image_x_size
     0x          Equ   0005 image_y_size
     0x          Equ   835C Img_emblemBack01
     0x          Equ   834D Img_emblemBack02
     0x          Equ   8282 Img_emblemBack03
     0x          Equ   8273 Img_emblemBack04
     0x          Equ   82A0 Img_emblemBack05
     0x          Equ   8291 Img_emblemBack06
     0x          Equ   8255 Img_emblemBack07
     0x          Equ   8246 Img_emblemBack08
     0x          Equ   8264 Img_emblemBack09
     0x          Equ   8401 Img_emblemFront01
     0x          Equ   8410 Img_emblemFront02
     0x          Equ   83E3 Img_emblemFront03
     0x          Equ   83F2 Img_emblemFront04
     0x          Equ   83C5 Img_emblemFront05
     0x          Equ   83D4 Img_emblemFront06
     0x          Equ   83A7 Img_emblemFront07
     0x          Equ   83B6 Img_emblemFront08
     0x          Equ   81FC Img_sonicHand
     0x          Equ   8327 Img_sonic_1
     0x          Equ   833A Img_sonic_2
     0x          Equ   8381 Img_sonic_3
     0x          Equ   8394 Img_sonic_4
     0x          Equ   836B Img_sonic_5
     0x          Equ   822C Img_star_1
     0x          Equ   8212 Img_star_2
     0x          Equ   81E9 Img_star_3
     0x          Equ   81D6 Img_star_4
     0x          Equ   8311 Img_tailsHand
     0x          Equ   82FE Img_tails_1
     0x          Equ   82EB Img_tails_2
     0x          Equ   82D8 Img_tails_3
     0x          Equ   82C5 Img_tails_4
     0x          Equ   82AF Img_tails_5
     0x          Equ   72AA Joypads_Held
     0x          Equ   72AC Joypads_Press
     0x          Equ   7317 MarkObjGone
     0x          Equ   001B nb_dynamic_objects
     0x          Equ   0003 nb_level_objects
     0x          Equ   0040 nb_objects
     0x          Equ   0008 nb_priority_levels
     0x          Equ   0002 nb_reserved_objects
     0x          Equ   005A next_object
     0x          Equ   6730 Object_RAM
     1x          Equ   005A object_size
     0x          Equ   0002 ObjID_PaletteHandler
     0x          Equ   0001 ObjID_SEGA
     0x          Equ   0003 ObjID_TitleScreen
     0x          Equ   0000 page_draw_routine
     0x          Equ   0003 page_erase_routine
     0x          Label A000 PaletteHandler
     1x          Label A00E PaletteHandler_Init
     1x          Label A09D PaletteHandler_Main
     1x          Label A008 PaletteHandler_Routines
     5x          Label A0DE pal_buffer
     3x          Label A0BC pal_cur
     2x          Label A0DD pal_cycles
     2x          Equ   001D pal_dst
     5x          Label A0E0 pal_idx
     4x          Label A0DC pal_mask
     1x          Equ   001B pal_src
     0x          Equ   87C9 Pal_TitleScreen
     0x          Equ   0003 pcm_end_addr
     0x          Equ   0005 pcm_meta_size
     0x          Equ   0000 pcm_page
     0x          Equ   8747 Pcm_SEGA
     0x          Equ   0001 pcm_start_addr
     3x          Label A030 PHI_Loop
     3x          Label A098 PHI_Rts
     0x          Label A068 PHI_SetPalBleu
     1x          Label A073 PHI_SetPalBleudec
     1x          Label A076 PHI_SetPalNext
     1x          Label A074 PHI_SetPalSaveBleu
     1x          Label A05A PHI_VRDec
     1x          Label A060 PHI_VRSave
     1x          Label A062 PHI_VRSuivante
     0x          Equ   7D60 PlayPCM
     0x          Equ   0006 prev_anim
     0x          Equ   0003 priority
     0x          Equ   7E66 PSGCancelLoop
     0x          Equ   8021 PSGFrame
     0x          Equ   7E6A PSGGetStatus
     0x          Equ   7DB2 PSGInit
     0x          Equ   7DC4 PSGPlayNoRepeat
     0x          Equ   7EE2 PSGRestoreVolumes
     0x          Equ   7E1B PSGResume
     0x          Equ   7E6E PSGSetMusicVolumeAttenuation
     0x          Equ   8018 PSGSFXCancelLoop
     0x          Equ   812D PSGSFXFrame
     0x          Equ   801C PSGSFXGetStatus
     0x          Equ   7F56 PSGSFXPlayLoop
     0x          Equ   7FA2 PSGSFXStop
     0x          Equ   7ECD PSGSilenceChannels
     0x          Equ   7DF2 PSGStop
     0x          Equ   8752 Psg_TitleScreen
     0x          Equ   87EA Ptr_palette
     0x          Equ   0002 render_flags
     0x          Equ   0080 render_free3_mask
     0x          Equ   0020 render_hide_mask
     0x          Equ   0008 render_motionless_mask
     0x          Equ   0004 render_overlay_mask
     0x          Equ   0010 render_playfieldcoord_mask
     0x          Equ   0040 render_todelete_mask
     0x          Equ   0001 render_xmirror_mask
     0x          Equ   0002 render_ymirror_mask
     3x          Equ   0018 routine
     0x          Equ   0019 routine_secondary
     0x          Equ   003F rsv_bgdata_0
     0x          Equ   0051 rsv_bgdata_1
     0x          Equ   0036 rsv_buffer_0
     0x          Equ   0048 rsv_buffer_1
     0x          Equ   002E rsv_image_subset
     0x          Equ   0030 rsv_mapping_frame
     0x          Equ   002A rsv_prev_anim
     0x          Equ   003D rsv_prev_mapping_frame_0
     0x          Equ   004F rsv_prev_mapping_frame_1
     0x          Equ   0047 rsv_prev_render_flags_0
     0x          Equ   0059 rsv_prev_render_flags_1
     0x          Equ   0080 rsv_prev_render_onscreen_mask
     0x          Equ   0001 rsv_prev_render_overlay_mask
     0x          Equ   0043 rsv_prev_x1_pixel_0
     0x          Equ   0055 rsv_prev_x1_pixel_1
     0x          Equ   0045 rsv_prev_x2_pixel_0
     0x          Equ   0057 rsv_prev_x2_pixel_1
     0x          Equ   0043 rsv_prev_xy1_pixel_0
     0x          Equ   0055 rsv_prev_xy1_pixel_1
     0x          Equ   0045 rsv_prev_xy2_pixel_0
     0x          Equ   0057 rsv_prev_xy2_pixel_1
     0x          Equ   0041 rsv_prev_xy_pixel_0
     0x          Equ   0053 rsv_prev_xy_pixel_1
     0x          Equ   0041 rsv_prev_x_pixel_0
     0x          Equ   0053 rsv_prev_x_pixel_1
     0x          Equ   0044 rsv_prev_y1_pixel_0
     0x          Equ   0056 rsv_prev_y1_pixel_1
     0x          Equ   0046 rsv_prev_y2_pixel_0
     0x          Equ   0058 rsv_prev_y2_pixel_1
     0x          Equ   0042 rsv_prev_y_pixel_0
     0x          Equ   0054 rsv_prev_y_pixel_1
     0x          Equ   0036 rsv_priority_0
     0x          Equ   0048 rsv_priority_1
     0x          Equ   0039 rsv_priority_next_obj_0
     0x          Equ   004B rsv_priority_next_obj_1
     0x          Equ   0037 rsv_priority_prev_obj_0
     0x          Equ   0049 rsv_priority_prev_obj_1
     0x          Equ   0001 rsv_render_checkrefresh_mask
     0x          Equ   0004 rsv_render_displaysprite_mask
     0x          Equ   0002 rsv_render_erasesprite_mask
     0x          Equ   0029 rsv_render_flags
     0x          Equ   0008 rsv_render_outofrange_mask
     0x          Equ   0032 rsv_x1_pixel
     0x          Equ   0034 rsv_x2_pixel
     0x          Equ   0032 rsv_xy1_pixel
     0x          Equ   0034 rsv_xy2_pixel
     0x          Equ   0033 rsv_y1_pixel
     0x          Equ   0035 rsv_y2_pixel
     0x          Equ   7289 screen_border_color
     0x          Equ   00E4 screen_bottom
     0x          Equ   001C screen_top
     0x          Equ   00A0 screen_width
     0x          Equ   001A status
     0x          Equ   0004 status_bit2
     0x          Equ   0080 status_bit7
     0x          Equ   0002 status_inair
     0x          Equ   0010 status_jumpingafterrolling
     0x          Equ   0004 status_jumporroll
     0x          Equ   0020 status_mainchar_pushing
     0x          Equ   0008 status_mainchar_standing
     0x          Equ   0008 status_norgroundnorfall
     0x          Equ   0020 status_pushing
     0x          Equ   0040 status_sidekick_pushing
     0x          Equ   0010 status_sidekick_standing
     0x          Equ   0040 status_underwater
     0x          Equ   0001 status_x_orientation
     0x          Equ   0002 status_y_orientation
     0x          Equ   0001 subtype
     0x          Equ   72A6 Vint_runcount
     0x          Equ   880C White_palette
     0x          Equ   0012 xy_pixel
     0x          Equ   0012 x_pixel
     0x          Equ   000C x_pos
     0x          Equ   000E x_sub
     0x          Equ   0014 x_vel
     0x          Equ   0013 y_pixel
     0x          Equ   000F y_pos
     0x          Equ   0011 y_sub
     0x          Equ   0016 y_vel
     0x          Equ   00FE _goBackNFrames
     0x          Equ   00FD _goToAnimation
     0x          Equ   00FC _nextRoutine
     0x          Equ   00FA _nextSubRoutine
     0x          Equ   00FF _resetAnim
     0x          Equ   00FB _resetAnimAndSubRoutine
     0x          Equ   80DA _sendVolume2PSG
     0x          Equ   818A _SFXsetLoopPoint

