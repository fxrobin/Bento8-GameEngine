/*--------------------------------------------------------------*
 * Compilé avec C6809 v0.83                                     *
 *--------------------------------------------------------------*
 * Fichier source      : .\Sonic2\GeneratedCode\Boot.ASM
 * Fichier destination : .\Sonic2\GeneratedCode\TMP.BIN
 * Contenu :
 *     Main     0:BOOT.ASM     3432
 *--------------------------------------------------------------*/

Macro Pass
Pass1
Pass2
     14
     15                  A000     boot_dernier_bloc equ $A000
     16
     17        6200                       org   $6200
     18
     19                           *****************************************>>
     20                           * Animation de la palette: fondu vers une>>
     21                           *****************************************>>
     22                           * Ecriture en $E7DB de l'adresse ou sera >>
     23                           *
     24                           * les adresses vont de deux en deux car i>>
     25                           * couleur: 0, adresse: 00
     26                           * couleur: 1, adresse: 02
     27                           * couleur: 2, adresse: 04
     28                           * ...
     29                           *
     30                           * Deux ecritures en $E7DA (auto-increment>>
     31                           *                          positionnee en>>
     32                           *
     33                           *                             V V V V    >>
     34                           * Premiere adresse        fondamentale V >>
     35                           *
     36                           * Deuxieme adresse            X X X M    >>
     37                           * auto-incrementee        bit de marquage>>
     38                           *                       (incrustation vid>>
     39                           *
     40                           * Attention: les instructions suivantes e>>
     41                           * ASL, ASR, CLR, COM, DEL, INC, LSL, LSR,>>
     42                           * un seul appel sur $E7DA va lire $E7DA p>>
     43                           * Sur $E7DA il faut donc utiliser l'instr>>
     44                           *****************************************>>
     45
     46        6200               PalInit
     47  3     6200 8E   62DA             ldx   #pal_len                 * >>
     48  4     6203 108E 62CE             ldy   #pal_from                * >>
     49        6207               PalRun
     50  4+0   6207 A6   A4               lda   ,y                         >>
     51  5     6209 B4   62E1             anda  pal_mask                 * >>
     52  2     620C C6   FF               ldb   #$FF                     * >>
     53  5     620E F4   62E1             andb  pal_mask                 * >>
     54  5     6211 F7   6278             stb   pal_buffer               * >>
     55  2     6214 C6   11               ldb   #$11                     * >>
     56  5     6216 F4   62E1             andb  pal_mask                 * >>
     57  5     6219 F7   6279             stb   pal_buffer+1             * >>
     58  5     621C B1   6278             cmpa  pal_buffer               * >>
     59  3     621F 27   10               beq   PalVRSuivante            * >>
     60  3     6221 22   07               bhi   PalVRDec                 * >>
     61  4+0   6223 A6   A4               lda   ,y                       * >>
     62  5     6225 BB   6279             adda  pal_buffer+1             * >>
     63  3     6228 20   05               bra   PalVRSave                * >>
     64        622A               PalVRDec
     65  4+0   622A A6   A4               lda   ,y                       * >>
     66  5     622C B0   6279             suba  pal_buffer+1             * >>
     67        622F               PalVRSave
     68  4+0   622F A7   A4               sta   ,y                       * >>
     69        6231               PalVRSuivante
     70  7     6231 73   62E1             com   pal_mask                 * >>
     71  3     6234 2B   D1               bmi   PalRun                   * >>
     72                            
     73        6236               SetPalBleu
     74  4+1   6236 E6   21               ldb   1,y                        >>
     75  2     6238 C1   0F               cmpb  #$0F                     * >>
     76  3     623A 27   08               beq   SetPalNext               * >>
     77  3     623C 22   03               bhi   SetPalBleudec            * >>
     78  2     623E 5C                    incb                           * >>
     79  3     623F 20   01               bra   SetPalSaveBleu           * >>
     80        6241               SetPalBleudec
     81  2     6241 5A                    decb                           * >>
     82        6242               SetPalSaveBleu
     83  4+1   6242 E7   21               stb   1,y                      * >>
     84                            
     85        6244               SetPalNext
     86  5     6244 B6   627E             lda   pal_idx                  * >>
     87  5     6247 B7   E7DB             sta   $E7DB                    * >>
     88  2     624A 8B   02               adda  #$02                     * >>
     89  5     624C B7   627E             sta   pal_idx                  * >>
     90  4+0   624F A6   A4               lda   ,y                       * >>
     91  5     6251 B7   E7DA             sta   $E7DA                    * >>
     92  5     6254 F7   E7DA             stb   $E7DA                    * >>
     93  5     6257 B6   627E             lda   pal_idx                  * >>
     94  4+0   625A A1   84               cmpa  ,x                       * >>
     95  3     625C 26   E6               bne   SetPalNext               * >>
     96  4+1   625E 31   22               leay  2,y                      * >>
     97  4+1   6260 30   01               leax  1,x                      * >>
     98  4     6262 8C   62E0             cmpx  #end_pal_len             * >>
     99  3     6265 26   A0               bne   PalRun                   * >>
    100                            
    101        6267               Vsync_1
    102  7     6267 7D   E7E7             tst   $E7E7                    * >>
    103  3     626A 2A   FB               bpl   Vsync_1                  * >>
    104        626C               Vsync_2
    105  7     626C 7D   E7E7             tst   $E7E7                    * >>
    106  3     626F 2B   FB               bmi   Vsync_2                  * >>
    107                            
    108  7     6271 7A   62E0             dec   pal_cycles               * >>
    109  3     6274 26   8A               bne   PalInit                  * >>
    110  3     6276 20   08               bra   InitVideo                * >>
    111                            
    112        6278               pal_buffer
    113        6278 42                    fcb   $42                      * >>
    114        6279 41                    fcb   $41                      * >>
    115        627A 53                    fcb   $53                      * >>
    116        627B 49                    fcb   $49                      * >>
    117        627C 43                    fcb   $43                      * >>
    118        627D 32                    fcb   $32                      * >>
    119                            
    120        627E               pal_idx
    121        627E 00                    fcb   $00                      * >>
    122        627F 00                    fcb   $00                      * >>
    123                            
    124                           *---------------------------------------->>
    125                           * A partir de ce point le code doit comme>>
    126                           *---------------------------------------->>
    127
    128                           *****************************************>>
    129                           * Initialisation du mode video
    130                           *****************************************>>
    131        6280               InitVideo
    132  2     6280 1A   50               orcc  #$50                     * >>
    133  4     6282 10CE 9FFF             lds   #$9FFF                   * >>
    134  2     6286 86   7B               lda   #$7B                     * >>
    135  5     6288 B7   E7DC             sta   $E7DC
----------------
217 cycle(s)
139 byte(s)
----------------
    137                           *****************************************>>
    138                           * Initialisation de la commutation de pag>>
    139                           *****************************************>>
    140  5     628B F6   6081             ldb   $6081                    * >>
    141  2     628E CA   10               orb   #$10                     * >>
    142  5     6290 F7   6081             stb   $6081                    * >>
    143  5     6293 F7   E7E7             stb   $E7E7                    * >>
    144  2     6296 86   04               lda   #$04
    145  5     6298 B7   E7E5             sta   $E7E5                    * >>
----------------
24 cycle(s)
16 byte(s)
----------------
    147                           *****************************************>>
    148                           * Lecture des donnees depuis la disquette>>
    149                           *****************************************>>
    150        629B               DKLecture
    151                  60               setdp $60
    152  2     629B 86   60               lda   #$60
    153  6     629D 1F   8B               tfr   a,dp                     * >>
    154                            
    155  3     629F CC   0000             ldd   #$0000
    156  4     62A2 97   49               sta   <$6049                   * >>
    157  5     62A4 DD   4A               std   <$604A                   * >>
    158  2     62A6 86   02               lda   #$02
    159  4     62A8 97   4C               sta   <$604C                   * >>
    160  4     62AA 97   48               sta   <$6048                   * >>
    161  2     62AC 86   A0               lda   #$A0                     * >>
    162  5     62AE DD   4F               std   <$604F
    163        62B0               DKCO
    164  8     62B0 BD   E82A             jsr   $E82A                    * >>
    165  6     62B3 0C   4C               inc   <$604C                   * >>
    166  4     62B5 96   4C               lda   <$604C                   * >>
    167  2     62B7 81   10               cmpa  #$10                     * >>
    168  3     62B9 23   06               bls   DKContinue               * >>
    169  2     62BB 86   01               lda   #$01                     * >>
    170  4     62BD 97   4C               sta   <$604C                   * >>
    171  6     62BF 0C   4B               inc   <$604B                   * >>
    172        62C1               DKContinue
    173  6     62C1 0C   4F               inc   <$604F                   * >>
    174  5     62C3 DC   4F               ldd   <$604F                   * >>
    175        62C5               dk_dernier_bloc
    176  5     62C5 1083 A000             cmpd  #boot_dernier_bloc       * >>
    177  3     62C9 23   E5               bls   DKCO                     * >>
    178  4     62CB 7E   A000             jmp   $A000
----------------
95 cycle(s)
51 byte(s)
----------------
    180                           * donnees pour le fondu de palette
    181                           *****************************************>>
    182
    183        62CE               pal_from
    184        62CE 0000                  fdb   $0000                    * >>
    185        62D0 F00F                  fdb   $F00F                    * >>
    186        62D2 FF0F                  fdb   $FF0F                    * >>
    187        62D4 7707                  fdb   $7707                    * >>
    188        62D6 AA03                  fdb   $AA03                    * >>
    189        62D8 330A                  fdb   $330A                    * >>
    190                            
    191        62DA               pal_len
    192        62DA 0C                    fcb   $0C                      * >>
    193        62DB 0E                    fcb   $0E                      * >>
    194        62DC 10                    fcb   $10                      * >>
    195        62DD 16                    fcb   $16                      * >>
    196        62DE 18                    fcb   $18                      * >>
    197        62DF 20                    fcb   $20                      * >>
    198        62E0               end_pal_len
    199                            
    200        62E0               pal_cycles
    201        62E0 0F                    fcb   $0F                      * >>
    202                            
    203        62E1               pal_mask
    204        62E1 0F                    fcb   $0F                      * >>

000000 Total Errors

000024 Total Symbols
     1x          Equ   A000 boot_dernier_bloc
     1x          Label 62B0 DKCO
     1x          Label 62C1 DKContinue
     0x          Label 629B DKLecture
     0x          Label 62C5 dk_dernier_bloc
     1x          Label 62E0 end_pal_len
     1x          Label 6280 InitVideo
     1x          Label 6200 PalInit
     2x          Label 6207 PalRun
     1x          Label 622A PalVRDec
     1x          Label 622F PalVRSave
     1x          Label 6231 PalVRSuivante
     5x          Label 6278 pal_buffer
     1x          Label 62E0 pal_cycles
     1x          Label 62CE pal_from
     3x          Label 627E pal_idx
     1x          Label 62DA pal_len
     4x          Label 62E1 pal_mask
     0x          Label 6236 SetPalBleu
     1x          Label 6241 SetPalBleudec
     2x          Label 6244 SetPalNext
     1x          Label 6242 SetPalSaveBleu
     1x          Label 6267 Vsync_1
     1x          Label 626C Vsync_2

